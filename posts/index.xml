<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Posts on Dev Log</title><link>https://joeytat.github.io/posts/</link><description>Recent content in Posts on Dev Log</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Fri, 02 Jun 2023 00:00:00 +0000</lastBuildDate><atom:link href="https://joeytat.github.io/posts/index.xml" rel="self" type="application/rss+xml"/><item><title>æ„å»ºæ˜“ç»´æŠ¤çš„ Design System: ä¸ºä»€ä¹ˆ SwiftUI ä¼šæ˜¯æ›´å¥½çš„é€‰æ‹©</title><link>https://joeytat.github.io/posts/why-swiftui-is-better-at-building-a-design-system/</link><pubDate>Fri, 02 Jun 2023 00:00:00 +0000</pubDate><guid>https://joeytat.github.io/posts/why-swiftui-is-better-at-building-a-design-system/</guid><description>
&lt;p>&lt;code>SwiftUI&lt;/code> è‡ª iOS 13 å‘å¸ƒä»¥æ¥ï¼Œè™½ç„¶å·²ç»é¢å‘å…¬ä¼—è¿‘ 4 å¹´ï¼Œä½†ç”±äºåœ¨å®ç°å¤æ‚å¸ƒå±€æ—¶çš„æ€§èƒ½ä¸ä½³ï¼Œä»¥åŠå› å…¶å†…ç½®ç»„ä»¶çš„åº•å±‚å®ç°å˜æ›´ï¼ˆiOS 16 ä¸Š &lt;code>List&lt;/code> çš„åº•å±‚å®ç°ä» &lt;code>UITableView&lt;/code> æ”¹æˆäº† &lt;code>UICollectionView&lt;/code> ï¼‰ï¼Œå¯¼è‡´å¼€å‘è€…ä»¬åŸæœ¬è‰¯å¥½è¿è¡Œä»£ç éšç³»ç»Ÿå‡çº§è¢«ç ´åäº†ã€‚iOS 14 ä¹‹å‰ SwiftUI çš„å¼€å‘è€…ä½“éªŒä¹Ÿè®©äººä¸€è¨€éš¾å°½ã€‚å°½ç®¡æœ‰å¾ˆå¤šçš„æ§½ç‚¹ï¼Œä½†æˆ‘ä»¬è¿˜æ˜¯èƒ½å‘ç°ç¤¾åŒºæ•´ä½“ä¸Šè¿˜æ˜¯æ¯”è¾ƒæ¥çº³ SwiftUIã€‚æ‰€ä»¥å¦‚æœä½ å¯¹ SwiftUI è¿˜æœ‰æ‰€çŠ¹è±«ï¼Œä¸æ¸…æ¥šä¸ºä½•è¦ä½¿ç”¨å®ƒï¼Œè¿™ç¯‡æ–‡ç« æˆ–è®¸èƒ½å¤Ÿå¸¦æ¥ä¸€äº›æ–°çš„æƒ³æ³•ã€‚&lt;/p>
&lt;p>æœ¬ç¯‡æ–‡ç« ä¸»è¦æ˜¯æƒ³è¦é€šè¿‡ Design System ä¸ºåˆ‡å…¥ç‚¹ï¼ŒåŒå¤§å®¶è®¨è®ºç›¸æ¯”èµ· UIKitï¼Œä¸ºä»€ä¹ˆæ›´æ¨èä½¿ç”¨ SwiftUI æ¥å®ç°å¤§å¤šæ•°ä¸šåŠ¡åœºæ™¯ä¸‹çš„ UI ç»„ä»¶ã€‚&lt;/p>
&lt;p>é¦–å…ˆç®€å•æ¦‚æ‹¬ä¸€ä¸‹ Design System æ˜¯ä»€ä¹ˆï¼ŒDesign System æ˜¯ä¸€ä¸ªåŒ…å«äº†è®¾è®¡åŸåˆ™ã€ç»„ä»¶åº“å’Œä»£ç èµ„æºç­‰ç³»ç»ŸåŒ–çš„æŒ‡å¯¼ï¼Œæ—¨åœ¨ä¿ƒè¿›å›¢é˜Ÿé—´çš„åä½œå’Œæé«˜é¡¹ç›®çš„ä¸€è‡´æ€§ã€‚å®ƒå¯ä»¥å¸®åŠ©å›¢é˜Ÿæ›´å¿«é€Ÿã€é«˜æ•ˆåœ°æ„å»ºåº”ç”¨ç¨‹åºï¼ŒåŒæ—¶ç¡®ä¿åº”ç”¨ç¨‹åºçš„å¤–è§‚å’Œäº¤äº’ä¿æŒä¸€è‡´ã€‚&lt;/p>
&lt;p>æ¥ä¸‹æ¥å°±è¿›å…¥æ­£é¢˜ï¼Œä»ä»¥ä¸‹å‡ ç‚¹æ¥æ¢è®¨ä¸€ä¸‹é€šè¿‡ SwiftUI æ„å»º Design System æœ‰å“ªäº›ä¼˜åŠ¿ã€‚&lt;/p>
&lt;ul>
&lt;li>å£°æ˜å¼è¯­æ³•ä¼šæ›´å…·æœ‰å¯è¯»æ€§å’Œæ˜“äºå®ç°&lt;/li>
&lt;li>å†…å»ºçš„ä¸€è‡´æ€§å’Œç»Ÿä¸€æ€§è¡¨è¾¾&lt;/li>
&lt;li>å•å‘æ•°æ®æµå¸¦æ¥çš„å¯é¢„æµ‹æ€§&lt;/li>
&lt;li>ä¸ Design System æœ‰æ›´ç›¸ä¼¼çš„å“²å­¦æ€æƒ³&lt;/li>
&lt;/ul>
&lt;h2 id="å£°æ˜å¼è¯­æ³•ä¼šæ›´å…·æœ‰å¯è¯»æ€§å’Œæ˜“äºå®ç°">
å£°æ˜å¼è¯­æ³•ä¼šæ›´å…·æœ‰å¯è¯»æ€§å’Œæ˜“äºå®ç°
&lt;a href="#%e5%a3%b0%e6%98%8e%e5%bc%8f%e8%af%ad%e6%b3%95%e4%bc%9a%e6%9b%b4%e5%85%b7%e6%9c%89%e5%8f%af%e8%af%bb%e6%80%a7%e5%92%8c%e6%98%93%e4%ba%8e%e5%ae%9e%e7%8e%b0" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h2>
&lt;p>é¦–å…ˆä»å®ç°å’Œç»´æŠ¤æˆæœ¬ä¸Šæ¥è¯´ï¼ŒSwiftUI ä¸ Apple ç°æœ‰çš„ UIKit å’Œ AppKit ä¸åŒï¼ŒSwiftUI é‡‡ç”¨äº†å£°æ˜å¼è¯­æ³•æ„å»º UIã€‚ç”±äºå£°æ˜å¼è¯­æ³•æ›´å…³æ³¨äºæè¿° UI çš„æœ€ç»ˆæ•ˆæœï¼Œè€Œä¸æ˜¯å…·ä½“å®ç°æ–¹å¼ã€‚è¿™ä½¿å¾—é€šè¿‡å£°æ˜å¼è¯­æ³•ç¼–å†™çš„ UI ç»„ä»¶æ›´å…·å¯è¯»æ€§ï¼Œæœ‰åŠ©äºå›¢é˜Ÿæ›´å¥½åœ°åä½œå®ç° Design Systemã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// SwiftUI&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>VStack(spacing: &lt;span style="color:#ae81ff">20&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Text(&lt;span style="color:#e6db74">&amp;#34;Hello&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .font(.largeTitle)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Text(&lt;span style="color:#e6db74">&amp;#34;World&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .font(.largeTitle)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>.foregroundColor(.blue)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// UIKit&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">let&lt;/span> stackView = UIStackView()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>stackView.axis = .vertical
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>stackView.spacing = &lt;span style="color:#ae81ff">20&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">let&lt;/span> helloLabel = UILabel()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>helloLabel.text = &lt;span style="color:#e6db74">&amp;#34;Hello&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>helloLabel.font = UIFont.systemFont(ofSize: &lt;span style="color:#ae81ff">34&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>stackView.addArrangedSubview(helloLabel)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">let&lt;/span> worldLabel = UILabel()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>worldLabel.text = &lt;span style="color:#e6db74">&amp;#34;World&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>worldLabel.font = UIFont.systemFont(ofSize: &lt;span style="color:#ae81ff">34&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>stackView.addArrangedSubview(worldLabel)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>stackView.backgroundColor = .blue
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>é™¤äº†ä»£ç æ•°é‡ä¸Šçš„å·®è·ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åœ¨ SwiftUI ç¤ºä¾‹ä¸­é€šè¿‡ä»£ç ç»“æ„å°±ç›´è§‚åœ°æ„Ÿå—åˆ° UI ç»„ä»¶æ˜¯å¦‚ä½•è¢«æ’åˆ—çš„ã€‚&lt;/p>
&lt;h2 id="å†…å»ºçš„ä¸€è‡´æ€§å’Œç»Ÿä¸€æ€§è¡¨è¾¾">
å†…å»ºçš„ä¸€è‡´æ€§å’Œç»Ÿä¸€æ€§è¡¨è¾¾
&lt;a href="#%e5%86%85%e5%bb%ba%e7%9a%84%e4%b8%80%e8%87%b4%e6%80%a7%e5%92%8c%e7%bb%9f%e4%b8%80%e6%80%a7%e8%a1%a8%e8%be%be" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h2>
&lt;p>åœ¨ SwiftUI ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ &lt;code>View Modifier&lt;/code> æ¥å®ç°å¯¹ UI ç»„ä»¶çš„ç»Ÿä¸€æ€§è¡¨è¾¾ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// SwiftUI&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Button(&lt;span style="color:#e6db74">&amp;#34;Primary&amp;#34;&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// action&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>.buttonStyle(PrimaryButtonStyle())
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Button(&lt;span style="color:#e6db74">&amp;#34;Secondary&amp;#34;&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// action&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>.buttonStyle(SecondaryButtonStyle()) &lt;span style="color:#75715e">// å½“ Primaryï¼Œ æˆ– Secondary style å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ‰€æœ‰ä½¿ç”¨äº†è¿™ä¸¤ä¸ª style çš„æŒ‰é’®éƒ½ä¼šè¢«è‡ªåŠ¨æ›´æ–°&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// UIKit&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">let&lt;/span> primaryButton = UIButton()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>primaryButton.setTitle(&lt;span style="color:#e6db74">&amp;#34;Primary&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">ï¼Œ&lt;/span> &lt;span style="color:#66d9ef">for&lt;/span>: .normal)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>primaryButton.titleLabel?.font = UIFont.systemFont(ofSize: &lt;span style="color:#ae81ff">16&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>primaryButton.backgroundColor = UIColor.blue
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>primaryButton.layer.cornerRadius = &lt;span style="color:#ae81ff">5&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">let&lt;/span> secondaryButton = UIButton()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>secondaryButton.setTitle(&lt;span style="color:#e6db74">&amp;#34;Secondary&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">ï¼Œ&lt;/span> &lt;span style="color:#66d9ef">for&lt;/span>: .normal)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>secondaryButton.titleLabel?.font = UIFont.systemFont(ofSize: &lt;span style="color:#ae81ff">16&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>secondaryButton.backgroundColor = UIColor.gray
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>secondaryButton.layer.cornerRadius = &lt;span style="color:#ae81ff">5&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>é€šè¿‡ä»£ç æˆ‘ä»¬å¯ä»¥çœ‹åˆ° SwiftUI é¢„å®šä¹‰çš„è®¾è®¡è§„èŒƒï¼Œä½¿å¼€å‘è€…æ›´æ˜“äºè¡¨è¾¾å’Œä¿è¯ Design System çš„ç»Ÿä¸€æ€§ã€‚&lt;/p>
&lt;p>è™½ç„¶å¼€å‘è€…ä¹Ÿå¯ä»¥å¯¹ UIKit çš„ UI ç»„ä»¶è¿›è¡Œå°è£…ï¼Œå®ç°ç±»ä¼¼ SwiftUI View Modifier çš„æ•ˆæœã€‚ä½†æ˜¯ SwiftUI çš„ View Modifier æ˜¯å†…åœ¨è€¦åˆçš„ï¼Œä¼šå¤©ç„¶å…·æœ‰æ›´å¥½çš„ä¸€è‡´æ€§ã€‚è€Œå¯¹ UIKit è¿›è¡ŒäºŒæ¬¡å°è£…ï¼Œä»éœ€ä¾èµ–äºå¼€å‘è€…è‡ªè§‰éµå¾ªè®¾è®¡è§„èŒƒï¼Œéš¾å…ä¼šäº§ç”Ÿç–å¿½çš„æƒ…å†µï¼Œå½±å“æœ€ç»ˆ UI çš„ä¸€è‡´æ€§ã€‚&lt;/p>
&lt;h2 id="å•å‘æ•°æ®æµå¸¦æ¥çš„å¯é¢„æµ‹æ€§">
å•å‘æ•°æ®æµå¸¦æ¥çš„å¯é¢„æµ‹æ€§
&lt;a href="#%e5%8d%95%e5%90%91%e6%95%b0%e6%8d%ae%e6%b5%81%e5%b8%a6%e6%9d%a5%e7%9a%84%e5%8f%af%e9%a2%84%e6%b5%8b%e6%80%a7" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h2>
&lt;p>SwiftUI æ‰€ç¼–å†™çš„ UI ç»„ä»¶æ›´å…·æœ‰å¯é¢„æµ‹æ€§ã€‚ä½“ç°åœ¨å…¶éµå¾ªå•å‘æ•°æ®æµåŸåˆ™ï¼Œè¿™æ ·å¯ä»¥å‡å°‘å› ä¸ºçŠ¶æ€ç®¡ç†å¤æ‚æ€§å¯¼è‡´çš„ UI é”™è¯¯ã€‚åŒæ—¶ UI ç»„ä»¶çš„æ ·å¼æ˜¯é€šè¿‡é«˜é˜¶å‡½æ•°æˆ–ç»„åˆæ¥åˆ›å»ºçš„ï¼Œè€Œä¸æ˜¯é€šè¿‡å‰¯ä½œç”¨æˆ–éšå¼è§„åˆ™åˆ›å»ºï¼Œè¿™ä½¿å¾—å¼€å‘è€…æ›´å®¹æ˜“è¯†åˆ«ç»„ä»¶ä¼šå…·å¤‡å“ªäº›æ ·å¼åŠå…¶æ¥æºã€‚&lt;/p>
&lt;p>ç›¸æ¯”ä¹‹ä¸‹ UIKit ä½œä¸ºå‘½ä»¤å¼ UI æ¡†æ¶ï¼Œå…¶ UI æ¸²æŸ“è¿‡ç¨‹åˆ™ç›¸å¯¹å¤æ‚å’Œéš¾ä»¥é¢„æµ‹ã€‚&lt;/p>
&lt;ul>
&lt;li>çŠ¶æ€å˜åŒ–ä¼šå¯¼è‡´éš¾ä»¥è·Ÿè¸ªçš„å‰¯ä½œç”¨ï¼Œè¿™ä½¿ UI æ›´æ˜“å‡ºé”™ä¸”éš¾ä»¥è°ƒè¯•ã€‚&lt;/li>
&lt;li>æ ·å¼è§„åˆ™ç”±å¼€å‘è€…è‡ªè¡Œå®šä¹‰å¹¶åº”ç”¨ï¼Œå­˜åœ¨è¾ƒå¤§éšæ„æ€§ï¼Œé˜…è¯»å’Œç†è§£èµ·æ¥ä¹Ÿæ›´åŠ å›°éš¾ã€‚&lt;/li>
&lt;li>æ ·å¼çš„æ¥æºå’Œåº”ç”¨ä¸åƒ SwiftUI é‚£æ ·æ¸…æ™°ï¼Œéœ€è¦å¼€å‘è€…è‡ªè¡Œç†æ¸…å„ä¸ªæ ·å¼è§„åˆ™ä¹‹é—´çš„å…³ç³»ï¼Œä»¥ç¡®ä¿ UI çš„æ­£ç¡®æ€§ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="æ›´ç›¸ä¼¼çš„å“²å­¦æ€æƒ³">
æ›´ç›¸ä¼¼çš„å“²å­¦æ€æƒ³
&lt;a href="#%e6%9b%b4%e7%9b%b8%e4%bc%bc%e7%9a%84%e5%93%b2%e5%ad%a6%e6%80%9d%e6%83%b3" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h2>
&lt;p>SwiftUI ä¸­ç»„åˆå’Œå‡½æ•°å¼çš„æ€æƒ³ä¸ Design System ä¸­åŸå­ç»„ä»¶å’Œç»„åˆçš„åŸåˆ™ç›¸å»åˆã€‚&lt;/p>
&lt;ul>
&lt;li>ä¸¤è€…éƒ½å€¾å‘äºæ„å»ºå‡ºå°çš„ã€è‡ªæ´½çš„å•ä½ï¼Œç„¶åé€šè¿‡ç»„åˆæ¥åˆ›å»ºæ›´ä¸ºå¤æ‚çš„ç»“æ„ï¼ŒSwiftUI ä¸­çš„è§†å›¾å’Œ Modifier å°±æ˜¯è¿™ç§å•ä½å’Œç»„åˆçš„ä½“ç°ã€‚&lt;/li>
&lt;li>ç»„ä»¶å’Œå‡½æ•°éƒ½æ˜¯å¯ä»¥æ˜¯é€šç”¨çš„æˆ–å®šåˆ¶çš„ï¼ŒåŒæ—¶å¯ä»¥å°†å…¶é‡å¤ä½¿ç”¨æˆ–ç»„åˆã€‚åœ¨ SwiftUI ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºå‡ºé€šç”¨çš„ Modifier å’Œè§†å›¾ï¼Œä¹Ÿå¯ä»¥ä¸ºæŸä¸€å…·ä½“è§†å›¾å®šåˆ¶ç‰¹æœ‰çš„ Modifierã€‚&lt;/li>
&lt;li>å½“æ”¹å˜åŸºç¡€å•ä½(å¦‚å­—å·ï¼Œé—´è·ç­‰åŸºç¡€å•ä½)ä¼šä»¥å¯æ§æ–¹å¼å½±å“æ‰€æœ‰ç»„åˆã€‚å¦‚æœæˆ‘ä»¬æ”¹å˜ä¸€ä¸ª Modifier çš„è¡Œä¸ºæˆ–å±æ€§ï¼Œæ‰€æœ‰åº”ç”¨è¯¥ Modifier çš„è§†å›¾å°†ä¼šç›¸åº”æ”¹å˜ã€‚è¿™ä½¿å¾—åœ¨è®¾è®¡ç³»ç»Ÿä¸­è°ƒæ•´ç»†èŠ‚æ—¶ï¼Œæ›´æ˜“é¢„æµ‹å’Œæ§åˆ¶å…¶å½±å“èŒƒå›´ã€‚&lt;/li>
&lt;/ul>
&lt;p>è€Œç›¸æ¯”ä¹‹ä¸‹ï¼ŒUIKit ä½œä¸ºå‘½ä»¤å¼æ¡†æ¶ï¼Œå…¶ UI æ„å»ºæ–¹å¼åˆ™ç›¸å¯¹é›¶æ•£å’Œéšæ„:&lt;/p>
&lt;ul>
&lt;li>æ„å»º UI æ—¶ï¼Œå¼€å‘è€…è‡ªè¡Œå†³å®šç»„è£…å“ªäº›æ§ä»¶å’Œè®¾ç½®ä½•ç§å±æ€§ï¼Œéš¾ä»¥éµå¾ªç»Ÿä¸€çš„ç»„åˆè§„åˆ™ã€‚&lt;/li>
&lt;li>æ²¡æœ‰ç±»ä¼¼ Modifier çš„æœºåˆ¶ï¼Œæ¯ä¸ªè§†å›¾çš„æ ·å¼éƒ½éœ€è¦å•ç‹¬è®¾ç½®ï¼Œæ— æ³•åœ¨å¤šå¤„é‡å¤ä½¿ç”¨ã€‚è¿™ä½¿å¾—è°ƒæ•´æ ·å¼æ—¶ï¼Œéœ€è¦é€ä¸ªä¿®æ”¹æ¯ä¸ªè§†å›¾ï¼Œéš¾ä»¥é«˜æ•ˆåœ°åº”ç”¨è®¾è®¡å˜åŒ–ã€‚&lt;/li>
&lt;li>å±æ€§çš„å˜åŒ–å¹¶ä¸ä¸€å®šä¼šå½±å“æ‰€æœ‰ç›¸å…³è§†å›¾ï¼Œéœ€è¦å¼€å‘è€…è‡ªå·±å†é€ä¸ªå¯¹åº”ç”¨çš„è§†å›¾åšå‡ºä¿®æ”¹ã€‚è¿™åŠ å¤§äº†è®¾è®¡ç³»ç»Ÿç»´æŠ¤çš„éš¾åº¦ã€‚&lt;/li>
&lt;/ul>
&lt;h2 id="æœ€å">
æœ€å
&lt;a href="#%e6%9c%80%e5%90%8e" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h2>
&lt;p>è¿˜éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œæœ¬æ–‡åªæ˜¯æƒ³æ¢è®¨åœ¨å®ç°ç§»åŠ¨å¹³å°çš„ Design System æ—¶ç›¸æ¯”èµ· UIKitï¼ŒSwiftUI æ‰€å…·æœ‰çš„ä¸€å®šä¼˜åŠ¿ã€‚&lt;/p>
&lt;p>åœ¨æŸäº›å¤æ‚çš„åœºæ™¯ä¸‹ï¼ŒUIKit è¿™æ ·å‘½ä»¤å¼çš„ UI æ¡†æ¶çš„çµæ´»æ€§å’Œæ€§èƒ½å¯èƒ½ä¼šæ›´å¼ºã€‚æ‰€ä»¥éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒSwiftUI çš„ç»„ä»¶çŠ¶æ€å’Œè¡Œä¸ºéƒ½æ˜¯ç”±æ•°æ®é©±åŠ¨ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ï¼Œå¦‚å¤§é‡çš„æ•°æ®ç»‘å®šå’Œæ›´æ–°å¯èƒ½ä¼šå¼•èµ· UI ç•Œé¢çš„å¡é¡¿å’Œå»¶è¿Ÿã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒUIKit æ¥è¿‘åº•å±‚æ¸²æŸ“æœºåˆ¶ï¼Œæ€§èƒ½è¡¨ç°å¯èƒ½æ›´ä½³ã€‚ä½† SwiftUI ä¹Ÿæœ‰å®ç°è·¨å¹³å°éœ€æ±‚çš„ä¼˜åŠ¿ã€‚&lt;/p>
&lt;p>åœ¨é€‰æ‹©å…·ä½“å“ªä¸ªæ¡†æ¶å®ç° Design System æ—¶ï¼Œå¼€å‘è€…è¿˜æ˜¯å¾—æ ¹æ®å…·ä½“éœ€æ±‚ï¼Œæƒè¡¡ä¸¤è€…ä¹‹é—´çš„ä¼˜ç¼ºç‚¹ã€‚åœ¨è¿½æ±‚æ€§èƒ½æˆ–éœ€è¦é«˜åº¦å®šåˆ¶åŒ–çš„åœºæ™¯ä¸‹ï¼ŒUIKit çš„çµæ´»æ€§å’Œæ€§èƒ½è¡¨ç°å¯èƒ½æ›´å ä¼˜ã€‚ä½†åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒSwiftUI çš„å£°æ˜å¼è¯­æ³•å’Œç»„åˆç‰¹æ€§ï¼Œä½¿å…¶å¤©ç„¶æ›´é€‚åˆæ„å»ºç»Ÿä¸€ä¸”æ˜“ç»´æŠ¤çš„ Design Systemã€‚&lt;/p></description></item><item><title>ç§»åŠ¨å¼€å‘ä¸­å®ç° Deep Linking çš„ URL Scheme å’Œ Universal Links çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</title><link>https://joeytat.github.io/posts/differences_between_scheme_and_universal_links/</link><pubDate>Wed, 27 Jul 2022 00:00:00 +0000</pubDate><guid>https://joeytat.github.io/posts/differences_between_scheme_and_universal_links/</guid><description>
&lt;p>ç»å†è¿‡çš„ Mobile é¡¹ç›®åŸºæœ¬ä¸Šéƒ½æœ‰æ”¯æŒ Deep Linking çš„éœ€æ±‚ï¼Œæ¯æ¬¡æ–°é¡¹ç›®éƒ½ä¼šç»å†å‘å…¶ä»–ç«¯åŒäº‹å’Œ BA è§£é‡Šå®ç° Deep Linking ä¸¤ç§æ–¹æ¡ˆçš„åŒºåˆ«ï¼Œäºæ˜¯å°±æœ‰äº†è¿™ä¸€ç¯‡çŸ­æ–‡ã€‚ä¸»è¦æ˜¯ä»‹ç»ä¸¤ç§æ–¹æ¡ˆçš„ä¼˜ç¼ºç‚¹å’Œå®ç°æˆæœ¬å·®å¼‚ï¼Œå¹¶ä¸æ¶‰åŠå¦‚ä½•å®ç°çš„ä»£ç æ­¥éª¤ã€‚&lt;/p>
&lt;p>é¦–å…ˆä»€ä¹ˆæ˜¯ Deep Linkingï¼Œç®€å•æ¥è¯´å°±æ˜¯è®©ä¸€ä¸ª App å¯ä»¥é€šè¿‡ URL æ‰“å¼€å…¶ä»–çš„ Appï¼Œä»¥æä¾›æ›´ä¾¿æ·é«˜æ•ˆçš„ç”¨æˆ·ä½“éªŒã€‚&lt;/p>
&lt;h2 id="å¦‚æœæƒ³è·³åˆ°åˆ«äººé‚£å»">
å¦‚æœæƒ³è·³åˆ°åˆ«äººé‚£å»
&lt;a href="#%e5%a6%82%e6%9e%9c%e6%83%b3%e8%b7%b3%e5%88%b0%e5%88%ab%e4%ba%ba%e9%82%a3%e5%8e%bb" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h2>
&lt;p>BA è€åˆ˜ï¼šã€Œå¦‚æœæƒ³åœ¨ App é‡Œæ‰“å¼€äººå®¶çš„ App åº”è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿã€&lt;br>
å¼€å‘å°æ›¾ï¼šã€Œç›®å‰æœ‰ä¸¤ç§é€‰é¡¹ï¼ŒURL Scheme å’Œ Universal Linksã€‚ã€&lt;br>
BA è€åˆ˜ï¼šã€ŒåŒºåˆ«æ˜¯å•¥ï¼Ÿã€&lt;br>
å¼€å‘å°æ›¾ï¼šã€Œä¸»è¦çœ‹ä½ æƒ³ä¸æƒ³å¤„ç†ç”¨æˆ·æ²¡æœ‰å®‰è£…å¯¹æ–¹ App çš„æƒ…å†µã€‚ã€&lt;/p>
&lt;p>&lt;em>ps: Android ä¸­è¿™ä¸¤ç§é€‰é¡¹æ˜¯ Deep Links å’Œ App Linksï¼Œè¿ä½œåŸç†å¤§ä½“ç›¸åŒï¼Œå®ç°æ–¹å¼ iOS å’Œ Android æœ‰äº›è®¸å·®å¼‚ã€‚ä¸ºå°‘æ‰“å­—ï¼Œä¸‹æ–‡å°†ç»Ÿä¸€ä½¿ç”¨ URL Scheme å’Œ Universal Linksã€‚&lt;/em>&lt;/p>
&lt;h3 id="url-scheme">
URL Scheme
&lt;a href="#url-scheme" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h3>
&lt;p>é€šå¸¸é•¿è¿™æ ·ï¼š &lt;code>example://destination?param1=hello&lt;/code>ã€‚&lt;/p>
&lt;p>æƒ³é€šè¿‡ URL Scheme è·³è½¬åˆ°æŸä¸ª Appï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“å¯¹æ–¹ App å®šä¹‰çš„ Scheme æ˜¯ä»€ä¹ˆï¼ˆè¿™ä¸ç®—æ˜¯åºŸè¯ï¼‰ã€‚&lt;/p>
&lt;p>ä»¥ Twitter ä¸ºä¾‹ï¼Œå¦‚æœå½“å‰è®¾å¤‡&lt;strong>å®‰è£…äº† Twitter&lt;/strong>ï¼š&lt;br>
é€šè¿‡ &lt;code>twitter://user?screen_name=elonmusk&lt;/code> è¿™æ ·ä¸€ä¸ª URL Schemeï¼Œå°±å¯ä»¥æ‰“å¼€ Twitter å¹¶ä¸”è·³è½¬åˆ° Elon Musk çš„ä¸»é¡µï¼ˆscheme å¯ä»¥è¾“å…¥ Safari åœ°å€æ è¿›è¡Œæµ‹è¯•ï¼‰ã€‚&lt;/p>
&lt;p>å¦‚æœå½“å‰è®¾å¤‡&lt;strong>æ²¡æœ‰å®‰è£… Twitter&lt;/strong>ï¼š&lt;br>
å¯ä»¥é€šè¿‡ä»£ç å¾—åˆ°æ— æ³•è§£æ URL çš„é”™è¯¯ï¼Œæ¥ä¸‹æ¥è¦å¦‚ä½•å¤„ç†ï¼Œå°±éœ€è¦å·¥ç¨‹å¸ˆè‡ªå·±å»å®ç°äº†ã€‚
æ¯”å¦‚å¯ä»¥åŠ ä¸Šåˆ¤æ–­ï¼Œå¦‚æœæ‰“ä¸å¼€ Twitter çš„ Schemeï¼Œå°±å»æ‰“å¼€ App Store çš„ Scheme å¼•å¯¼ç”¨æˆ·ä¸‹è½½ Twitterï¼Œæˆ–è€…å»æ‰“å¼€å¾®åšã€‚&lt;/p>
&lt;h3 id="universal-links">
Universal Links
&lt;a href="#universal-links" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h3>
&lt;p>Universal Links åˆ™æ˜¯ä½¿ç”¨äº† HTTP æˆ– HTTPSï¼ˆiOS åªæ”¯æŒ HTTPSï¼‰Scheme çš„ URLã€‚&lt;/p>
&lt;p>ä¾ç„¶ç”¨ Twitter ä¸¾ä¾‹ï¼š&lt;/p>
&lt;p>å¦‚æœå½“å‰è®¾å¤‡&lt;strong>å®‰è£…äº† Twitter&lt;/strong>ï¼š&lt;br>
é€šè¿‡æ‰“å¼€ URL &lt;code>https://twitter.com/elonmusk&lt;/code> å¯ä»¥è·³è½¬åˆ° Twitter App ä¸­ Elon Musk çš„ä¸»é¡µã€‚&lt;/p>
&lt;p>å¦‚æœç”¨æˆ·&lt;strong>æ²¡æœ‰å®‰è£… Twitter&lt;/strong>ï¼š&lt;br>
ä¼šæ‰“å¼€ç½‘é¡µç‰ˆ Elon Musk çš„ä¸»é¡µã€‚&lt;/p>
&lt;h3 id="æ–¹æ¡ˆå¯¹æ¯”">
æ–¹æ¡ˆå¯¹æ¯”
&lt;a href="#%e6%96%b9%e6%a1%88%e5%af%b9%e6%af%94" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h3>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>&lt;/th>
&lt;th>æœ‰å®‰è£…å¯¹åº” App&lt;/th>
&lt;th>æ²¡æœ‰å®‰è£…å¯¹åº” App&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>URL Scheme&lt;/td>
&lt;td>ç›´æ¥æ‰“å¼€å¯¹åº” App&lt;/td>
&lt;td>éœ€è¦è‡ªè¡Œå¤„ç†è®¾å¤‡æ²¡æœ‰å®‰è£…å¯¹åº” App çš„æƒ…å†µï¼Œä½†å¤„ç†æ–¹æ¡ˆå¯ä»¥éå¸¸çµæ´»å¤šå˜&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Universal Links&lt;/td>
&lt;td>ç›´æ¥æ‰“å¼€å¯¹åº” App&lt;/td>
&lt;td>æ— éœ€é¢å¤–å¤„ç†ï¼Œé€šå¸¸ Universal Link å°±å¯¹åº”äº†ä¸€ä¸ªç½‘é¡µï¼Œåœ¨å½“å‰è®¾å¤‡æ²¡æœ‰å®‰è£… App çš„æƒ…å†µä¸‹ï¼Œä¼šè·³è½¬åˆ°å¯¹åº”ç½‘é¡µ&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="å¦‚æœæƒ³è®©åˆ«äººè·³è¿‡æ¥">
å¦‚æœæƒ³è®©åˆ«äººè·³è¿‡æ¥
&lt;a href="#%e5%a6%82%e6%9e%9c%e6%83%b3%e8%ae%a9%e5%88%ab%e4%ba%ba%e8%b7%b3%e8%bf%87%e6%9d%a5" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h2>
&lt;p>BA è€åˆ˜ï¼šã€Œé‚£å¦‚æœæƒ³è®©æˆ‘ä»¬çš„ App æ”¯æŒè·³è½¬å‘¢ï¼Ÿã€ã€‚&lt;br>
å¼€å‘å°æ›¾ï¼šã€Œè¿˜æ˜¯é‚£ä¸¤ç§é€‰é¡¹ï¼ŒURL Scheme å’Œ Universal Linksã€‚ã€&lt;br>
BA è€åˆ˜ï¼šã€ŒåŒºåˆ«æ˜¯å•¥ï¼Ÿã€&lt;br>
å¼€å‘å°æ›¾ï¼šã€Œä¸»è¦æ˜¯å®ç°æˆæœ¬å’Œæƒ³æ”¯æŒè·³è½¬çš„èŒƒå›´ã€‚ã€&lt;/p>
&lt;h3 id="url-scheme-1">
URL Scheme
&lt;a href="#url-scheme-1" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h3>
&lt;p>åœ¨ App ä¸­è®¾ç½®ä¸€ä¸ªè‡ªå®šä¹‰ Scheme å³å¯ã€‚å½“ä¸‰æ–¹ App é€šè¿‡ä»£ç è°ƒç”¨å°è¯•è·³è½¬æŸä¸ª Schemeï¼Œç³»ç»Ÿä¼šæ£€æµ‹å½“å‰è®¾å¤‡æ˜¯å¦å®‰è£…äº†æœ‰å®šä¹‰è¯¥ Scheme çš„ Appã€‚&lt;/p>
&lt;p>å¦‚æœæƒ³è¦æ”¯æŒå¯¹æ–¹è·³è½¬åˆ°æŸä¸ªç‰¹å®šç•Œé¢ï¼Œåªéœ€è¦åœ¨ App ä¸­å¢åŠ è§£æ URL çš„æ–¹æ³•å³å¯ã€‚
å…·ä½“å®ç°ç»†èŠ‚å¯ä»¥å‚è€ƒï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://developer.apple.com/documentation/xcode/defining-a-custom-url-scheme-for-your-app">iOS - Defining a custom URL scheme for your app&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developer.android.com/training/app-links#deep-links">Android - Hanling Android App Link - Deep Links&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="universal-links-1">
Universal Links
&lt;a href="#universal-links-1" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h3>
&lt;p>ç›¸æ¯”èµ· URL Scheme åªéœ€è¦å‰ç«¯å®ç°ï¼ŒUniversal Links çš„æ”¯æŒè¦å¤æ‚ä¸€äº›ï¼ŒåŸå› æ˜¯åœ¨äºå…¶ä½¿ç”¨åœºæ™¯æ‰©å¤§äº†ã€‚&lt;br>
URL Scheme çš„è·³è½¬ï¼Œéœ€è¦è®©ä¸‰æ–¹ App çŸ¥é“æˆ‘ä»¬çš„ Scheme å®šä¹‰å³å¯ï¼Œç”±&lt;strong>ç¬¬ä¸‰æ–¹ App æ¥å‘èµ·è·³è½¬&lt;/strong>ã€‚å¦‚æœå½“å‰è®¾å¤‡å¹¶æ²¡æœ‰å®‰è£… Appï¼Œå¦‚ä½•æä¾›å¤‡é€‰æ–¹æ¡ˆï¼Œå°±å®Œå…¨ä¾èµ–äºä¸‰æ–¹å®ç°äº†ã€‚&lt;/p>
&lt;p>Universal Links çš„è·³è½¬ï¼Œæ˜¯ä¸‰æ–¹ App æ‰“å¼€ä¸€ä¸ªé“¾æ¥æ—¶ï¼Œç”±ç³»ç»Ÿå†³å®šåº”è¯¥è·³è½¬åˆ° Appï¼ˆå°†å…¶å½“ä½œ Universal Linkï¼‰ è¿˜æ˜¯è·³è½¬åˆ°ç½‘é¡µï¼ˆå°†å…¶å½“ä½œæ™®é€šçš„ HTTP Linkï¼‰ã€‚åŒæ—¶ç³»ç»Ÿæ¥æ§åˆ¶è·³è½¬ï¼Œåˆ™æ„å‘³ç€ç”¨æˆ·ä»ç³»ç»Ÿä¸­å‡ ä¹ä»»ä½•åœ°æ–¹ï¼ˆæ¯”å¦‚é‚®ä»¶ã€çŸ­ä¿¡ã€å¤‡å¿˜å½•ã€æ—¥å†ï¼‰ç‚¹å‡» Universal Link éƒ½èƒ½è·³è½¬åˆ° App ä¸­ã€‚è¿™æ ·å³ä½¿åœ¨å½“å‰è®¾å¤‡æ²¡æœ‰å®‰è£… App çš„æƒ…å†µä¸‹ï¼Œä¾ç„¶ä¿è¯ç”¨æˆ·å¯ä»¥é€šè¿‡ç½‘é¡µè®¿é—®åˆ°éœ€è¦çš„èµ„æºã€‚&lt;/p>
&lt;p>æ‰€ä»¥å®ç°çš„åŒºåˆ«åœ¨äºï¼Œéœ€è¦è®©ç³»ç»ŸçŸ¥é“ï¼Œå“ªäº›åŸŸåçš„ URL æ˜¯åº”è¯¥è·³è½¬åˆ°æˆ‘ä»¬çš„ Appã€‚&lt;/p>
&lt;p>ä¾ç„¶ç”¨ Twitter ä¸¾ä¾‹ï¼Œå½“æˆ‘ä»¬éœ€è¦è®©ç³»ç»Ÿæ”¯æŒåœ¨ç‚¹å‡»ä»»ä½•å¸¦æœ‰ &lt;code>twitter.com&lt;/code> ä¸º Host çš„é“¾æ¥æ—¶ï¼Œéƒ½å°è¯•ç€å”¤èµ· Twitter å°±éœ€è¦ï¼š&lt;/p>
&lt;ol>
&lt;li>å¼€å‘äººå‘˜éœ€è¦åœ¨ Twitter App çš„é…ç½®ä¸­ï¼Œæ·»åŠ  associated domain çš„è®°å½•ï¼Œæ¯”å¦‚ &lt;code>twitter.com&lt;/code>ã€‚&lt;/li>
&lt;li>å½“ Twitter App è¢«å®‰è£…åˆ°ç”¨æˆ·çš„æ‰‹æœºæˆ–è€…åº”ç”¨æ›´æ–°æ—¶ï¼Œç³»ç»Ÿä¼šå» Twitter App åŒ…ä¸­æŸ¥æ‰¾ associated domain è®°å½•ã€‚&lt;/li>
&lt;li>å¦‚æœå­˜åœ¨è¿™æ ·ä¸€ä»½è®°å½•ï¼Œç³»ç»Ÿä¼šå»è®¿é—®è¯¥ domain ä¸‹çš„ä¸€ä¸ª JSON æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ä¸­éœ€è¦åŒ…å« Twitter App çš„ App IDï¼Œä»¥å»ºç«‹è¯¥ç«™ç‚¹ä¸ App çš„è”ç³»ã€‚æ¯”å¦‚ Twitter å°±å°†è¿™ä»½ JSON æ–‡ä»¶æ”¾åœ¨äº† &lt;code>https://twitter.com/.well-known/apple-app-site-association&lt;/code>ã€‚&lt;/li>
&lt;li>ç”±æ­¤å½“ç³»ç»Ÿåœ¨å¤„ç†é“¾æ¥çš„ç‚¹å‡»æ—¶ï¼Œä¼šå»åˆ¤æ–­ &lt;code>https://twitter.com&lt;/code> æ˜¯å¦å’Œå½“å‰è®¾å¤‡ä¸­å®‰è£…çš„æŸä¸ª App ä¹‹é—´å­˜åœ¨è”ç³»ï¼Œå¦‚æœå·²å®‰è£…çš„æŸä¸ª App çš„ app id å­˜åœ¨äºè¯¥ domain ä¸‹çš„ site association JSON æ–‡ä»¶ä¸­ï¼Œåˆ™å°† URL ä½œä¸ºå‚æ•°ä»£å…¥ï¼Œè·³è½¬åˆ° App ä¸­ã€‚&lt;/li>
&lt;/ol>
&lt;p>ç”¨å›¾ç‰‡æ¥è¡¨ç¤ºçš„è¯ï¼Œå¤§æ¦‚æ˜¯è¿™æ ·ï¼Œé¦–å…ˆè®© OS å»ºç«‹åŸŸåå’Œ App çš„è”ç³»ï¼š&lt;/p>
&lt;p>&lt;img src="https://joeytat.github.io/deeplinking_connection.png" alt="make connection between domain and the app">&lt;/p>
&lt;p>å½“å­˜åœ¨è”ç³»ä¹‹åï¼Œç‚¹å‡»é“¾æ¥æ—¶ï¼ŒOS ä¼šå»å”¤èµ· Appï¼š&lt;/p>
&lt;p>&lt;img src="https://joeytat.github.io/deeplinking_connection1.png" alt="tapping on the link will navigate to the app">&lt;/p>
&lt;p>å…·ä½“å®ç°ç»†èŠ‚å¯ä»¥å‚è€ƒï¼š&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://developer.apple.com/documentation/xcode/allowing-apps-and-websites-to-link-to-your-content">iOS - Allowing Apps and Websites to Link to Your Content&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developer.android.com/training/app-links#android-app-links">Android - Hanling Android App Link&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="å¯¹æ¯”">
å¯¹æ¯”
&lt;a href="#%e5%af%b9%e6%af%94" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h3>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>&lt;/th>
&lt;th>å®ç°æˆæœ¬&lt;/th>
&lt;th>æ”¯æŒè·³è½¬çš„èŒƒå›´&lt;/th>
&lt;th>æ²¡æœ‰å®‰è£… App&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>URL Scheme&lt;/td>
&lt;td>éœ€è¦åœ¨ App ä¸­ç»´æŠ¤ä¸€ä¸ªæ”¯æŒè¢«è·³è½¬çš„ Scheme åˆ—è¡¨&lt;/td>
&lt;td>åªèƒ½ç”±çŸ¥é“ Scheme çš„ App æ¥ä¸»åŠ¨è¿›è¡Œè·³è½¬&lt;/td>
&lt;td>éœ€è¦è®©ä¸‰æ–¹ App æ¥å¤„ç†æ²¡æœ‰å®‰è£… App çš„æƒ…å†µ&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Universal Links&lt;/td>
&lt;td>App ä¸­è¦ç»´æŠ¤ä¸€ä¸ªæ”¯æŒè¢«è·³è½¬çš„ domain åˆ—è¡¨ï¼ŒåŒæ—¶éœ€è¦åœ¨ domain å¯¹åº”æœåŠ¡å™¨ä¸­æ”¾ä¸€ä¸ª JSON æ–‡ä»¶ï¼Œè®©ç³»ç»ŸçŸ¥é“è¯¥ domain åŒ App ä¹‹é—´çš„è”ç³»&lt;/td>
&lt;td>ç³»ç»Ÿä¸­å‡ ä¹æ‰€æœ‰å¯ç‚¹å‡»é“¾æ¥åŒºåŸŸéƒ½å¯ä»¥è¢«ç³»ç»Ÿè§¦å‘è·³è½¬ï¼Œæ¯”å¦‚ç‚¹å‡»é‚®ä»¶ã€çŸ­ä¿¡ã€ç½‘é¡µã€ä¸‰æ–¹ App ä¸­çš„ Universal Link æ—¶&lt;/td>
&lt;td>ç”¨æˆ·ä¼šè·³è½¬åˆ° Universal Link å¯¹åº”çš„ç½‘é¡µï¼Œåœ¨ç½‘é¡µä¸­æˆ‘ä»¬å¯ä»¥å®ç°ä¸€å¥— Web ç‰ˆæœ¬ï¼Œæˆ–è€…ç›´æ¥åœ¨ç½‘é¡µä¸­æ‰“å¼€åº”ç”¨å•†åº—ï¼Œå¼•å¯¼ç”¨æˆ·ä¸‹è½½ App&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="ç®€å•æ€»ç»“">
ç®€å•æ€»ç»“
&lt;a href="#%e7%ae%80%e5%8d%95%e6%80%bb%e7%bb%93" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h2>
&lt;p>è·³åˆ°åˆ«äººé‚£å»ï¼Œä¸€èˆ¬æ¥è¯´åœ¨éœ€è¦çµæ´»å¤„ç†å½“å‰è®¾å¤‡&lt;strong>æ²¡æœ‰å®‰è£…&lt;/strong>å¯¹æ–¹ App çš„æƒ…å†µä¸‹ï¼Œé€šå¸¸ä¼šé€‰æ‹© URL Schemeï¼Œå¦åˆ™é€‰æ‹© Universal Linksã€‚&lt;/p>
&lt;p>æ”¯æŒåˆ«äººè·³è¿‡æ¥ï¼Œä¸¤ä¸ªæ–¹æ¡ˆå¯ä»¥å…±å­˜ã€‚&lt;/p>
&lt;ul>
&lt;li>URL Scheme ç›¸å¯¹æ¥è¯´å®ç°æˆæœ¬éå¸¸ä½å»‰ï¼Œä»…éœ€è¦å‰ç«¯ç»´æŠ¤ Scheme åˆ—è¡¨å¹¶ä¸”è´Ÿè´£è§£æå³å¯ã€‚ä½†éœ€è¦è®©å¯¹æ–¹æ¥å¤„ç†ï¼Œå¦‚æœå½“å‰è®¾å¤‡æ²¡æœ‰å®‰è£… App åº”è¯¥æ€ä¹ˆåŠã€‚&lt;/li>
&lt;li>Universal Links çš„å®ç°åˆ™ç›¸å¯¹å¤æ‚ï¼Œå¿…é¡»è¦æŠŠ domain å’Œ app ä¹‹é—´å»ºç«‹è”ç³»çš„ json æ–‡ä»¶æ”¾åœ¨æœåŠ¡å™¨ï¼Œè®©ç³»ç»Ÿåœ¨å®‰è£… App çš„æ—¶å€™å»è®¿é—®ã€‚ä½†å¥½å¤„æ˜¯ï¼Œå¦‚æœæœ¬æ¥å°±æœ‰ Web ç‰ˆçš„ä¸šåŠ¡ï¼Œé‚£ä¹ˆè‡ªåŠ¨å°±å¯ä»¥åœ¨ç”¨æˆ·æœªå®‰è£… App æ—¶å¾—åˆ°ç›¸åº”çš„æœåŠ¡ã€‚&lt;/li>
&lt;/ul></description></item><item><title>å‚åŠ  Apple å¼€å‘è€…çº¿ä¸Šæ´»åŠ¨æ˜¯ä»€ä¹ˆæ ·çš„ä½“éªŒï¼Ÿ</title><link>https://joeytat.github.io/posts/apple_swiftui_workshop/</link><pubDate>Mon, 28 Mar 2022 00:00:35 +0000</pubDate><guid>https://joeytat.github.io/posts/apple_swiftui_workshop/</guid><description>
&lt;p>ä»æœ‹å‹åœˆçœ‹åˆ°æ€ç¦å‘äº†ä¸€ä¸ªã€Šä½¿ç”¨ SwiftUI æ‰“é€ å“è¶Šä½“éªŒã€‹çš„ Apple å¼€å‘è€…çº¿ä¸Šæ´»åŠ¨çš„æŠ¥åé“¾æ¥ï¼Œåˆšå¥½æœ€è¿‘å‚ä¸çš„é¡¹ç›®ä¹Ÿåœ¨å¤§è§„æ¨¡ä½¿ç”¨ SwiftUI å°±æŠ¥åäº†ï¼Œå³ä½¿æ—¶é—´å¾ˆä¸å‡‘å·§æ˜¯å·¥ä½œæ—¥ï¼ˆå¦ä¸€æŠ¥åè¦æ±‚æ˜¯å¿…é¡»è¦æœ‰ä¸­å›½åŒºçš„å¼€å‘è€…è´¦å·ï¼‰ã€‚&lt;/p>
&lt;p>æ´»åŠ¨åˆ†ä¸¤å¤©ç¬¬ä¸€å¤©ä¸»è¦æ˜¯ä¸€äº› SwiftUI çš„ä»‹ç»ï¼ŒSwiftUI å¯¹æ•°æ®çš„å¤„ç†å’Œå¸ƒå±€çš„ä¸€äº›è¦ç‚¹ã€‚ç¬¬äºŒå¤©æ˜¯ç¤¾åŒºå¼€å‘è€…äº¤æµã€‚&lt;/p>
&lt;p>æŠ€æœ¯ç»†èŠ‚åé¢å¯ä»¥åˆ†å¥½å‡ ç¯‡åšå®¢æ¥æè¿°ï¼Œä½†æ€»çš„æ¥è¯´æŠ€æœ¯ç›¸å…³çš„æ”¶è·å…¶å®å’Œè‡ªå·±å»çœ‹ WWDC å·®ä¸å¤šã€‚å¹¶ä¸”ç”±äºé•¿æœŸä»¥ 2x é€Ÿåº¦è§‚çœ‹è¿™ç±»è§†é¢‘ï¼Œåˆšå¼€å§‹è¿˜å‡ºç°äº†ä¸€äº›ä¸é€‚åº”ã€‚ä½†æƒ³ç€è¿™æ˜¯æ¥è‡ªè‹¹æœçš„å¼€å‘è€…çš„åˆ†äº«ï¼Œè¿˜æ˜¯ç®¡ä½äº†æƒ³æ‹¿èµ·æ‰‹æœºçš„æ‰‹ï¼Œæ¯•ç«Ÿæœºä¼šéš¾å¾—ã€‚&lt;/p>
&lt;p>äº‹å®è¯æ˜ç¡®å®è®¤çœŸè§‚çœ‹è¿˜æ˜¯æœ‰æ”¶è·ï¼Œä¸»è¦æ˜¯ä»¥ä¸‹å‡ ç‚¹ï¼š&lt;/p>
&lt;ul>
&lt;li>çŸ¥é“äº†ä¸€äº› SwiftUI ç›¸å…³çš„ Xcode å¿«æ·æ“ä½œï¼Œæ¯”å¦‚ Preview å’Œä»£ç å…¶å®æ˜¯å¯ä»¥ç›¸äº’å½±å“çš„ã€‚Library ä¸­å¯ä»¥æœç´¢ &lt;code>ViewModifier&lt;/code> ç­‰ç­‰ã€‚&lt;/li>
&lt;li>æ¥è‡ªè‹¹æœçš„å·¥ç¨‹å¸ˆå¯¹ SwiftUI è¿™æ ·å“åº”å¼ UI ç¼–å†™æ–¹å¼çš„æ•°æ®æµæ€è€ƒçš„å»ºè®®ã€‚&lt;/li>
&lt;li>ä¸€äº›ç¼–å†™ SwiftUI ä»£ç æ—¶èƒ½å¤Ÿè®©æ¸²æŸ“å¼•æ“æ›´é«˜æ•ˆçš„å»ºè®®ã€‚&lt;/li>
&lt;/ul>
&lt;p>é™¤äº†ä¸Šé¢å¼€å‘è€…åˆ†äº«çš„å†…å®¹ä¹‹å¤–ï¼Œæœ€é‡è¦çš„æ˜¯å¯ä»¥æå‡ºä¸€äº›è‡ªå·±åœ¨ä½¿ç”¨ SwiftUI æ—¶é‡åˆ°çš„é—®é¢˜ï¼Œæ„Ÿè§‰åªè¦æè¿°å¾—å¤Ÿæ¸…æ¥šå¹¶ä¸”å’Œæœ¬æ¬¡æ´»åŠ¨ä¸»é¢˜ç›¸å…³ï¼Œé‚£ä¹ˆéƒ½èƒ½å¤Ÿå¾—åˆ°è‹¹æœå¼€å‘è€…çš„è§£ç­”ï¼Œè™½ç„¶å—å½¢å¼æˆ–æ—¶é—´é™åˆ¶ï¼Œç­”æ¡ˆå¹¶ä¸ä¸€å®šå®Œæ•´ï¼Œä½†å½“ä¸€ä¸ª SwiftUI çš„ç–‘é—®æ˜¯ç”±è‹¹æœçš„å·¥ç¨‹å¸ˆè§£ç­”æ—¶ï¼Œå³ä½¿åªæ˜¯å…³é”®å­—çš„æŒ‡å¼•ä¹Ÿèƒ½èµ·åˆ°ç”»é¾™ç‚¹ç›çš„ä½œç”¨ï¼ˆæ¯”å¦‚ &lt;code>StateObject&lt;/code> ä¸ &lt;code>ObservedObject&lt;/code> çš„å·®å¼‚ï¼‰ã€‚&lt;/p>
&lt;p>ç¬¬äºŒå¤©æ›´å¤šçš„æ˜¯å¬ç¤¾åŒºå¼€å‘è€…çš„ä¸€äº›äº¤æµï¼Œæ”¶è·åˆ°äº†ä¸å°‘ä¹‹å‰å¹¶ä¸çŸ¥é“çš„èµ„æ–™ã€‚ä¸€å¹¶åˆ—åœ¨ä¸‹æ–¹ã€‚&lt;/p>
&lt;p>psï¼šæ„Ÿè§‰å‚åŠ è¿™æ¬¡æ´»åŠ¨å¯¹è‡ªå·±æ¥è¯´è¿˜æœ‰ä¸€ä¸ªå‰¯ä½œç”¨å°±æ˜¯ï¼Œç”±äºèµ„æ–™çš„æ¨èè€…æœ‰è¶³å¤Ÿçš„å¯ä¿¡åº¦ï¼Œå¹¶ä¸”æä¾›äº†ä¸€ä¸ªå¯é çš„å­¦ä¹ è·¯çº¿ï¼Œæ‰€ä»¥ä¼šç”¨æ ¼å¤–çš„è®¤çœŸæ¥å¯¹å¾…å®ƒä»¬ã€‚&lt;/p>
&lt;p>Swift UI çš„å…¥é—¨æŒ‡å¼•&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://developer.apple.com/videos/play/wwdc2020/10119/">WWDC - Introduction to SwiftUI&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developer.apple.com/videos/play/wwdc2019/216/">WWDC - SwiftUI Essentials&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developer.apple.com/tutorials/sample-apps">åä¸ªå¾ˆæœ‰ä»£è¡¨æ€§çš„ Playground&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developer.apple.com/tutorials/swiftui">äº¤äº’å¼çš„ SwiftUI å…¥é—¨æ•™ç¨‹&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developer.apple.com/tutorials/app-dev-training">ä½¿ç”¨ SwiftUI æ„å»ºå®Œæ•´ App çš„äº¤äº’å¼æ•™ç¨‹&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>SwiftUI æ•°æ®å¤„ç†è¦ç´ &lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://developer.apple.com/videos/play/wwdc2020/10040/">WWDC - Data Essentials in SwiftUI&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developer.apple.com/videos/play/wwdc2021/10022">WWDC - Demystify SwiftUI&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developer.apple.com/documentation/SwiftUI/State-and-Data-Flow">çŠ¶æ€ä¸æ•°æ®æµ&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developer.apple.com/documentation/swiftui/managing-model-data-in-your-app">å¦‚ä½•ç®¡ç† App ä¸­çš„æ¨¡å‹æ•°æ®&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developer.apple.com/documentation/swiftui/managing-user-interface-state">å¦‚ä½•ç®¡ç† UI çŠ¶æ€&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>SwiftUI å¸ƒå±€å’Œæ¸²æŸ“&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://developer.apple.com/videos/play/wwdc2021/10018/">WWDC - What&amp;rsquo;s new in SwiftUI&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developer.apple.com/videos/play/wwdc2020/10031/">WWDC - Stacks, Grids, and Outlines in SwiftUI&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developer.apple.com/videos/play/wwdc2021/10021/">WWDC - Add rich graphics to your SwiftUI app&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developer.apple.com/videos/play/wwdc2019/237/">WWDC - Building Custom Views with SwiftUI&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developer.apple.com/documentation/swiftui/layout-containers">å¸ƒå±€å®¹å™¨&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developer.apple.com/documentation/swiftui/collection-containers">é›†åˆå¸ƒå±€å®¹å™¨&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developer.apple.com/documentation/swiftui/drawing-and-graphics">å›¾åƒä¸ç»˜åˆ¶&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>ç”¨ SwiftUI æ‰“é€  watchOS app&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://developer.apple.com/videos/play/wwdc2019/219/">WWDC - SwiftUI on watchOS&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developer.apple.com/videos/play/wwdc2020/10048/">WWDC - Build complications in SwiftUI&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developer.apple.com/documentation/example-articles/building_a_watchos_app">æ‰“é€  watchOS App&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developer.apple.com/documentation/watchosapps/developing_a_user_interface_with_swiftui">å¦‚ä½•åˆ©ç”¨ SwiftUI ä»¥åŠæ‰‹è¡¨ç‰¹å®šåŠŸèƒ½æ‰“é€ å¤æ‚ app çš„ä»£ç ç¤ºä¾‹&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>ç¤¾åŒºå¼€å‘è€…æåŠ&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://developer.apple.com/documentation/docc#Overview">æ–‡æ¡£ç”Ÿæˆå·¥å…· - DocC&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://swiftui-lab.com/random-lessons/">WWDC Digital Lounges ä¸­çš„å¼€å‘è€…é—®ç­”æ•´ç†&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://swiftui-lab.com/companion/">SwiftUI Companion - äº¤äº’å¼ SwiftUI API æ–‡æ¡£å·¥å…·&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>iOS æ¶æ„ä¹‹å¦ä¸€ç§ä¾èµ–æ³¨å…¥çš„æ€è·¯</title><link>https://joeytat.github.io/posts/swift_dependency_injection/</link><pubDate>Tue, 15 Mar 2022 00:00:00 +0000</pubDate><guid>https://joeytat.github.io/posts/swift_dependency_injection/</guid><description>
&lt;p>åœ¨ iOS ä¸šåŠ¡å¼€å‘è¿‡ç¨‹ç»å¸¸é¢å¯¹ç½‘ç»œè¯·æ±‚ï¼Œæ•°æ®æŒä¹…åŒ–è¿™æ ·å¸¦æœ‰å‰¯ä½œç”¨çš„æ“ä½œã€‚ä¸ºäº†èƒ½å¤Ÿåœ¨æµ‹è¯•ä¸­ mock è¿™äº›æ“ä½œï¼Œé€šå¸¸çš„åšæ³•å°±æ˜¯æŠ½è±¡ä¸€å±‚ protocol å‡ºæ¥ï¼Œç„¶åç¼–å†™ä¸åŒçš„å®ç°ã€‚&lt;/p>
&lt;p>æ¯”å¦‚éœ€è¦å¤„ç†ä¸€ä¸ªç®€é™‹çš„æ³¨å†Œä¸šåŠ¡ï¼ˆç¤ºä¾‹çœç•¥äº†ä¸€ç‚¹ç»†èŠ‚ï¼‰ï¼Œéœ€è¦ç”¨æˆ·è¾“å…¥ä¿¡æ¯åå‘é€ç½‘ç»œè¯·æ±‚ï¼ŒæˆåŠŸåè¿”å›å¯¹åº”ç”¨æˆ·å¯¹è±¡ã€‚&lt;/p>
&lt;p>é¦–å…ˆä¸ºç½‘ç»œè¯·æ±‚å®šä¹‰ä¸€ä¸ª protocolï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">protocol&lt;/span> &lt;span style="color:#a6e22e">SignUpRepositoryProtocol&lt;/span>: RepositoryProtocol {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">handleSignUp&lt;/span>(name: String, email: String, pwd: String) -&amp;gt; AnyPublisher&amp;lt;User, Error&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¯¹å…¶è¿›è¡Œå®ç°ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">struct&lt;/span> &lt;span style="color:#a6e22e">SignUpRepository&lt;/span>: SignUpRepositoryProtocol {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">handleSignUp&lt;/span>(name: String, email: String, pwd: String) -&amp;gt; AnyPublisher&amp;lt;User, Error&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> client(.signUp(name, email, pwd))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .map
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .decode
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .eraseToAnyPublisher()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å°†å…¶æ³¨å…¥åˆ° &lt;code>ViewModel&lt;/code> æˆ–æ˜¯ &lt;code>Interactor&lt;/code> ä¸­ï¼ˆå–å†³äºä½ é‡‡å–çš„æ¶æ„æ˜¯ä»€ä¹ˆ :p ï¼‰ï¼Œå¹¶ä¸”è°ƒç”¨å¯¹åº”æ–¹æ³•ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">SignUpViewModel&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">enum&lt;/span> &lt;span style="color:#a6e22e">State&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> loading
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> success
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> failed
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> repository: SignUpRepositoryPortocol
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> state: State = .loading
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">init&lt;/span>(repository: SignUpRepositoryPortocol) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">self&lt;/span>.repository = repository
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">onSubmit&lt;/span>(name: String, email: String, pwd: String) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> repository.hanldeSignUp(name: name, email: email, pwd: pwd)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .sink {[&lt;span style="color:#66d9ef">weak&lt;/span> &lt;span style="color:#66d9ef">self&lt;/span>] completion &lt;span style="color:#66d9ef">in&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">switch&lt;/span> completion {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> .failure:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">self&lt;/span>.?state = .failed
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> .finished: &lt;span style="color:#66d9ef">break&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } receiveValue: {[&lt;span style="color:#66d9ef">weak&lt;/span> &lt;span style="color:#66d9ef">self&lt;/span>] result &lt;span style="color:#66d9ef">in&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">self&lt;/span>?.state = .success
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }.store(&lt;span style="color:#66d9ef">in&lt;/span>: &amp;amp;bag)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç”±æ­¤å¦‚æœéœ€è¦æµ‹è¯•å¯¹åº”çš„æ–¹æ³•ï¼Œåªéœ€è¦å†åˆ›å»ºä¸€ä»½ &lt;code>MockSignUpRepository&lt;/code> çš„å®ç°å³å¯ï¼Œæ¯”å¦‚æƒ³è¦æµ‹è¯•æ³¨å†ŒæˆåŠŸæˆ–å¤±è´¥åœºæ™¯ä¸‹çš„å¤„ç†ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">struct&lt;/span> &lt;span style="color:#a6e22e">MockSignUpRepository&lt;/span>: SignUpRepositoryPortocol {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> shouldSignUpSuccess: Bool
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">handleSignUp&lt;/span>(name: String, email: String, pwd: String) -&amp;gt; AnyPublisher&amp;lt;User, Error&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> shouldSignUpSuccess {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Just(User.mock)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .mapError{ &lt;span style="color:#66d9ef">_&lt;/span> &lt;span style="color:#66d9ef">in&lt;/span> SignUpError.someError }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .eraseToAnyPublisher()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">else&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Fail(error: SignUpError.someError)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .eraseToAnyPublisher()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åœ¨ç¼–å†™æµ‹è¯•çš„æ—¶å€™ï¼Œä¼ å…¥ &lt;code>SignUpViewModel&lt;/code> çš„ä¾èµ–æ›¿æ¢æˆæˆ‘ä»¬æƒ³è¦æµ‹è¯•çš„ Mock å®ç°ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">shouldSignUpSuccessWhenXXX&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// Given&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> sut = SignUpViewModel(repository: MockSignUpSuccessRepository(shouldSignUpSuccess: &lt;span style="color:#66d9ef">true&lt;/span>))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// When&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> sut.onSubmit(...) &lt;span style="color:#75715e">// åˆæ³•è¾“å…¥&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// Then&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> XCTAssertEqual(sut.state, .success)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">shouldSignUpFailWhenXXX&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// Given&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> sut = SignUpViewModel(repository: MockSignUpSuccessRepository(shouldSignUpSuccess: &lt;span style="color:#66d9ef">false&lt;/span>))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// When&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> sut.onSubmit(...) &lt;span style="color:#75715e">// éæ³•è¾“å…¥&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// Then&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> XCTAssertEqual(sut.state, .failed)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™æ—¶å€™ä¼¼ä¹ä¸€åˆ‡éƒ½å¾ˆç¾å¥½ï¼Œä½†ç°åœ¨å†è¡¥å……ä¸€äº›ä¸šåŠ¡éœ€æ±‚ï¼Œå¦‚æœéœ€è¦è¿”å›ä¸åŒçš„é”™è¯¯ç±»å‹æ€ä¹ˆåŠï¼Ÿæ¯”å¦‚ç”¨æˆ·åé”™è¯¯ï¼Œé‚£å°±éœ€è¦é¢å¤–çš„å¸ƒå°”å€¼æ¥è¡¨ç¤ºï¼›å†æ¯”å¦‚é‚®ç®±é”™è¯¯ï¼Œé‚£åˆéœ€è¦å¢åŠ æ–°çš„å¸ƒå°”å€¼ã€‚è€Œè¿™è¿˜ä»…ä»…åªæ˜¯ä¸€ä¸ªæ–¹æ³•çš„å‡ ä¸ªåˆ†æ”¯é€»è¾‘å¤„ç†ã€‚å½“å‡ºç°è¾ƒå¤šçš„é€»è¾‘åˆ†æ”¯ä¹‹åï¼Œå¦‚æœæˆ‘ä»¬å®é™…çš„ä¸šåŠ¡å†å‘ç”Ÿå˜åŠ¨éœ€è¦é‡æ„ï¼Œé‚£è¿˜å¾—å»å¯¹ Mock ç±»ä¹Ÿè¿›è¡Œé‡æ„ï¼ŒåŒæ—¶è¿˜éœ€è¦ç¡®ä¿è¿™äº›æ§åˆ¶é€»è¾‘åˆ†æ”¯çš„å¸ƒå°”å€¼ä¹Ÿå¾—åˆ°äº†æ­£ç¡®çš„æ›´æ–°ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">let&lt;/span> sut = SignUpViewModel(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> repository: MockSignUpSuccessRepository(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> shouldSignUpSuccess: &lt;span style="color:#66d9ef">false&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> shouldShowUsernameError: &lt;span style="color:#66d9ef">true&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> shouldShowEmailError: &lt;span style="color:#66d9ef">true&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> shouldUsernamePassValidation: &lt;span style="color:#66d9ef">true&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> shouldEmailPassValidation: &lt;span style="color:#66d9ef">true&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ...ğŸ˜±&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> )
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™æ—¶å€™å°±å¯ä»¥ä»‹ç»å¦ä¸€ç§ä¾èµ–æ³¨å…¥æ–¹å¼äº†ã€‚é¦–å…ˆå®šä¹‰ä¸€ä¸ª &lt;code>Repository&lt;/code> å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å°±åƒä¹‹å‰çš„ &lt;code>Repository&lt;/code> ä¸€æ ·ï¼ŒåŒºåˆ«æ˜¯ç½‘ç»œè¯·æ±‚é€šè¿‡ä¸€ä¸ªå±æ€§æ¥æŒæœ‰ï¼ŒåŒæ—¶ä¼šæä¾›ä¸€ä¸ªæ ‡è®°ä¸º private çš„é»˜è®¤å®ç°ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">struct&lt;/span> &lt;span style="color:#a6e22e">Repository&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> handleSignUp = handleSignUp(name:, email:, pwd:)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">private&lt;/span> &lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">handleSignUp&lt;/span>(name: String, email: String, pwd: String) -&amp;gt; AnyPublisher&amp;lt;User, Error&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> client(.signUp(name, email, pwd))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .map
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .decode
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .eraseToAnyPublisher()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç„¶åå°†è¿™ä¸ª &lt;code>Repository&lt;/code> å®ä¾‹æ”¾åˆ°ä¸€ä¸ª &lt;code>Environment&lt;/code> å¯¹è±¡ä¸­ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">struct&lt;/span> &lt;span style="color:#a6e22e">Environment&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> repo = Repository()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åŒæ—¶æ›¿æ¢ ViewModel ä¸­ä¹‹å‰å¯¹ &lt;code>Repository&lt;/code> çš„å¼•ç”¨ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">SignUpViewModel&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">enum&lt;/span> &lt;span style="color:#a6e22e">State&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> loading
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> success
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> failed
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// let repository: SignUpRepositoryPortocol&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> current: Environment &lt;span style="color:#75715e">// ğŸ‘ˆ&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> state: State = .loading
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">init&lt;/span>(current: Environment) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">self&lt;/span>.current = current &lt;span style="color:#75715e">// ğŸ‘ˆ&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">onSubmit&lt;/span>(name: String, email: String, pwd: String) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> current.repo.hanldeSignUp(name, email, pwd) &lt;span style="color:#75715e">// ğŸ‘ˆ&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .sink { completion &lt;span style="color:#66d9ef">in&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">switch&lt;/span> completion {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> .failure:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">self&lt;/span>.state = .failed
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> .finished: &lt;span style="color:#66d9ef">break&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } receiveValue: {[&lt;span style="color:#66d9ef">weak&lt;/span> &lt;span style="color:#66d9ef">self&lt;/span>] result &lt;span style="color:#66d9ef">in&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">self&lt;/span>?.state = .success
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }.store(&lt;span style="color:#66d9ef">in&lt;/span>: &amp;amp;bag)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ä»£ç å‡ ä¹å’Œä¹‹å‰ç›¸åŒï¼Œä½†ä¿æŒäº†æ›´é«˜çš„å¯æ›¿æ¢æ€§ï¼Œæ€ä¹ˆä½“ç°çš„å‘¢ï¼Ÿéœ€è¦ mock ç½‘ç»œè¯·æ±‚ æ—¶ï¼Œå¯ä»¥ç»™ Repository åˆ›å»ºä¸€ä¸ª extensionï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">extension&lt;/span> &lt;span style="color:#a6e22e">Repository&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">static&lt;/span> &lt;span style="color:#66d9ef">let&lt;/span> mock = Repository(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> handleSignUp: Just(User.mock)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .mapError{ &lt;span style="color:#66d9ef">_&lt;/span> &lt;span style="color:#66d9ef">in&lt;/span> SignUpError.someError }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .eraseToAnyPublisher()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> )
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç„¶ååœ¨æµ‹è¯•ä»£ç æ„å»º ViewModel çš„æ—¶å€™å°±å¯ä»¥å°† Mock ä¼ é€’è¿›å»ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">shouldSignUpSuccessWhenXXX&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// Given&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> sut = SignUpViewModel(current: Environment(repo: Repository.mock))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// When&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> sut.onSubmit(...) &lt;span style="color:#75715e">// åˆæ³•è¾“å…¥&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// Then&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> XCTAssertEqual(sut.state, .success)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¯¹äºæ–¹æ³•å¤šåˆ†æ”¯çš„é€»è¾‘ï¼Œåˆ™å¯ä»¥ç‹¬ç«‹å®ç°ä¸€ä»½ï¼Œè€Œä¸æ˜¯é‡æ–°åˆ›å»ºæ•´ä¸ª &lt;code>MockRepository&lt;/code> ç±»æˆ–è€…æ˜¯ç”¨ä¸€äº›å˜é‡æ¥æ§åˆ¶åˆ†æ”¯é€»è¾‘ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">shouldSignUpFailWhenXXX&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// Given&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> sut = SignUpViewModel(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> current: Environment(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> repo: Repository(handleSignUp:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Fail(error: SignUpError.someError).eraseToAnyPublisher()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> )
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> )
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> )
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// When&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> sut.onSubmit(...) &lt;span style="color:#75715e">// éæ³•è¾“å…¥&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// Then&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> XCTAssertEqual(sut.state, .failed)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™ç§æ–¹å¼æ¥æ³¨å…¥ä¾èµ–çš„ä¼˜åŠ¿åœ¨äºï¼š&lt;/p>
&lt;ul>
&lt;li>ä¸éœ€è¦åƒ protocol é‚£æ ·å†™å¤ªå¤šæ¨¡ç‰ˆä»£ç &lt;/li>
&lt;li>mock çš„é€»è¾‘åˆ†æ”¯å¾ˆå®¹æ˜“å¯ä»¥å®ç°ç›¸äº’ç‹¬ç«‹çš„ç‰ˆæœ¬&lt;/li>
&lt;li>ä¾èµ–çš„å‰¯ä½œç”¨ä¼šæ›´å®¹æ˜“ mockï¼Œç‰¹åˆ«æ˜¯ç³»ç»Ÿç±»&lt;/li>
&lt;/ul></description></item><item><title>Swift çŠ¶æ€ç®¡ç† â€”â€” å¦‚ä½•æ‹†åˆ†åºå¤§çš„ reducer</title><link>https://joeytat.github.io/posts/combining_reducers/</link><pubDate>Sun, 16 Jan 2022 00:00:00 +0000</pubDate><guid>https://joeytat.github.io/posts/combining_reducers/</guid><description>
&lt;p>å› ä¸ºé¡¹ç›®éœ€è¦ä½¿ç”¨ SwiftUIï¼Œæƒ³èµ·æ¥ä¹‹å‰ä¹°è¿‡å–µç¥çš„ &lt;a href="https://objccn.io/products/swift-ui">ã€ŠSwiftUI ä¸ Combine ç¼–ç¨‹ã€‹&lt;/a> ã€‚ä¹¦ä¸­ä»‹ç»äº† &lt;a href="https://redux.js.org">Redux&lt;/a> è¿™ä¸€åœ¨ Web å‰ç«¯é¢†åŸŸå¹¿æ³›è¢«éªŒè¯è¿‡çš„æ•°æ®ç®¡ç†æ¨¡å¼æ˜¯å¦‚ä½•é€šè¿‡ Swift æ¥å®ç°çš„ï¼Œéå¸¸æ¨è SwiftUI åˆè§è€…é˜…è¯»ã€‚&lt;/p>
&lt;p>åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­è¿˜äº§ç”Ÿäº†ä¸€ä¸ªç–‘é—®ï¼Œå¦‚æœ reducer è¶Šæ¥è¶Šå¤§ï¼Œæœ‰ä»€ä¹ˆæ›´ â€œswiftâ€ çš„åŠæ³•èƒ½è§£å†³è¿™ä¸€é—®é¢˜å‘¢ï¼Ÿï¼ˆåœ¨ Redux.js ä¸­çš„åŸç”Ÿè§£å†³æ–¹æ¡ˆæ˜¯ &lt;a href="https://redux.js.org/usage/structuring-reducers/beyond-combinereducers">&lt;code>combineReducers&lt;/code>&lt;/a>ï¼‰&lt;/p>
&lt;h2 id="æ‹†åˆ†-reducer">
æ‹†åˆ† Reducer
&lt;a href="#%e6%8b%86%e5%88%86-reducer" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h2>
&lt;p>é¦–å…ˆçœ‹çœ‹é—®é¢˜åœ¨ä»£ç ä¸­çš„è¡¨ç°æ˜¯ä»€ä¹ˆæ ·çš„ï¼Œå‡è®¾æˆ‘ä»¬æœ‰è¿™æ ·ä¸€ä¸ª reducerï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">appReducer&lt;/span>(appState: &lt;span style="color:#66d9ef">inout&lt;/span> AppState, action: AppAction) -&amp;gt; Void {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">switch&lt;/span> action {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> .emailValid(&lt;span style="color:#66d9ef">let&lt;/span> isValid):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> appState.settings.isEmailValid = isValid
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> .register(&lt;span style="color:#66d9ef">let&lt;/span> email, &lt;span style="color:#66d9ef">let&lt;/span> password):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> appState.settings.loginUser = User(email, password)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> .login(&lt;span style="color:#66d9ef">let&lt;/span> email, &lt;span style="color:#66d9ef">let&lt;/span> password):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> appState.settings.loginUser = User(email, password)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> .logout:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> appState.settings.loginUser = &lt;span style="color:#66d9ef">nil&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> .loadPokemon(&lt;span style="color:#66d9ef">let&lt;/span> result):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> appState.pokemonList.pokemons = result
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> .favoratePokemon(&lt;span style="color:#66d9ef">let&lt;/span> pokemon):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> appState.favoritePokemons.append(pokemon)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> .removeFavoritePokemon(&lt;span style="color:#66d9ef">let&lt;/span> pokemon):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> index = appState.favoritePokemons.indexOf(pokemon)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> appState.favoritePokemons.remove(at: index)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åº”ç”¨çš„ action ä¸»è¦åŒ…å«ä¸‰ä¸ªæ¨¡å—ï¼š&lt;/p>
&lt;ul>
&lt;li>è´¦å·ç™»å½•æ³¨å†Œæ³¨é”€&lt;/li>
&lt;li>å¯¹ç¥å¥‡å®è´æ•°æ®è¿›è¡ŒåŠ è½½&lt;/li>
&lt;li>å¤„ç†å¯¹ç¥å¥‡å®è´æ•°æ®çš„æ”¶è—å’Œå–æ¶ˆæ”¶è—&lt;/li>
&lt;/ul>
&lt;p>ä»è¿™æ®µä»£ç æˆ‘ä»¬å¾ˆå¿«å°±èƒ½å‘ç°ï¼Œå³ä½¿åªæ˜¯éå¸¸ç®€å•çš„ç¤ºä¾‹ä¹Ÿå·²ç»åŒ…å«äº†ä¸çŸ­çš„ä»£ç äº†ã€‚è¿™é‡Œè¿˜çœç•¥æ‰äº†å¤„ç†çŠ¶æ€æ—¶å¯èƒ½è¿˜éœ€è¦çš„å¼‚æ­¥ action çš„å¤„ç†ï¼ˆæ•°æ®åŠ è½½ç­‰ï¼‰ã€‚è¿™è¿˜ä»…ä»…åªæœ‰ä¸¤ä¸ªéå¸¸ç®€å•çš„ç•Œé¢çŠ¶æ€ï¼Œå½“é¢å¯¹çœŸå®çš„ app æ‰€éœ€è¦å¤„ç†çš„æ•°åä¸ªé¡µé¢çŠ¶æ€ä¼šæ›´ææ€–ã€‚&lt;/p>
&lt;p>å°† reducer æ‹†åˆ†æˆå¦‚ä¸‹ä¸‰ä¸ªç‹¬ç«‹ reducerï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">accountReducer&lt;/span>(appState: &lt;span style="color:#66d9ef">inout&lt;/span> AppState, action: AppAction) -&amp;gt; Void {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">switch&lt;/span> action {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> .emailValid(&lt;span style="color:#66d9ef">let&lt;/span> isValid):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> appState.settings.isEmailValid = isValid
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> .register(&lt;span style="color:#66d9ef">let&lt;/span> email, &lt;span style="color:#66d9ef">let&lt;/span> password):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> appState.settings.loginUser = User(email, password)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> .login(&lt;span style="color:#66d9ef">let&lt;/span> email, &lt;span style="color:#66d9ef">let&lt;/span> password):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> appState.settings.loginUser = User(email, password)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> .logout:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> appState.settings.loginUser = &lt;span style="color:#66d9ef">nil&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">default&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">break&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">pokemonListReducer&lt;/span>(appState: &lt;span style="color:#66d9ef">inout&lt;/span> AppState, action: AppAction) -&amp;gt; Void {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">switch&lt;/span> action {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> .loadPokemon(&lt;span style="color:#66d9ef">let&lt;/span> result):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> appState.pokemonList.pokemons = result
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">default&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">break&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">favoritePokemonReducer&lt;/span>(appState: &lt;span style="color:#66d9ef">inout&lt;/span> AppState, action: AppAction) -&amp;gt; Void {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">switch&lt;/span> action {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> .favoratePokemon(&lt;span style="color:#66d9ef">let&lt;/span> pokemon):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> appState.favoritePokemons.append(pokemon)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> .removeFavoritePokemon(&lt;span style="color:#66d9ef">let&lt;/span> pokemon):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> index = appState.favoritePokemons.indexOf(pokemon)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> appState.favoritePokemons.remove(at: index)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">default&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">break&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å› ä¸ºå¯¹ reducer çš„æ•°é‡å¹¶ä¸ç¡®å®šï¼Œæ‰€ä»¥è¿™é‡Œä½¿ç”¨å¯å˜å‚æ•°æ¥æ„å»º &lt;code>combine&lt;/code> æ–¹æ³•ï¼Œå¯¹ä¼ å…¥çš„ reducer è¿›è¡Œéå†è°ƒç”¨å¤„ç† appStateã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">combine&lt;/span>&amp;lt;Value, Action&amp;gt;(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">_&lt;/span> reducers: (&lt;span style="color:#66d9ef">inout&lt;/span> Value, Action) -&amp;gt; Void...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>) -&amp;gt; (&lt;span style="color:#66d9ef">inout&lt;/span> Value, Action) -&amp;gt; Void {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> { value, action &lt;span style="color:#66d9ef">in&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span> reducer &lt;span style="color:#66d9ef">in&lt;/span> reducers {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> reducer(&amp;amp;value, action)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">let&lt;/span> appReducer = combine(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> accountReducer,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> pokemonListReducer,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> favoritePokemonReducer
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å®Œæˆï¼Œæˆ‘ä»¬çš„å·¨å¤§ reducer è¢«æ‹†åˆ†æˆäº†ç‹¬ç«‹çš„ reducerï¼Œå†é€šè¿‡è‡ªå·±å®ç°çš„ combine æ–¹æ³•å®Œæˆäº†ç»„è£…ã€‚&lt;/p>
&lt;h2 id="éš”ç¦»-reducer-æ•°æ®">
éš”ç¦» reducer æ•°æ®
&lt;a href="#%e9%9a%94%e7%a6%bb-reducer-%e6%95%b0%e6%8d%ae" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h2>
&lt;p>ä½†ä»”ç»†è§‚çœ‹ä»£ç è¿˜ä¼šå‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œæ¯ä¸ª reducer éƒ½åªéœ€è¦å¤„ç† &lt;code>appState&lt;/code> ä¸Šçš„éƒ¨åˆ†æ•°æ®ï¼Œæ¯”å¦‚ &lt;code>pokemonListReducer&lt;/code> æ˜æ˜åªæ“ä½œäº† &lt;code>appState.pokemonList&lt;/code>ï¼Œæˆ‘ä»¬å´æŠŠæ•´ä¸ª state éƒ½ä¸¢ç»™äº†å®ƒï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">pokemonListReducer&lt;/span>(appState: &lt;span style="color:#66d9ef">inout&lt;/span> AppState, action: AppAction) -&amp;gt; Void {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">switch&lt;/span> action {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> .loadPokemon(&lt;span style="color:#66d9ef">let&lt;/span> result):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> appState.pokemonList.pokemons = result
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">default&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">break&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™ä¼šå¢åŠ ä»£ç ç»´æŠ¤ä¸Šçš„å›°éš¾ï¼Œä¸ç†Ÿæ‚‰ä»£ç çš„äººåœ¨ä¸æµè§ˆæ•´ä¸ª reducer ä¹‹å‰ï¼Œå¾ˆéš¾çŸ¥é“è¿™ä¸ª reducer åˆ°åº•æ“ä½œäº†å“ªäº›æ•°æ®ã€‚æ›´ç†æƒ³çš„ reducer å¯èƒ½é•¿è¿™æ ·ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">pokemonListReducer&lt;/span>(value: &lt;span style="color:#66d9ef">inout&lt;/span> PokemonList, action: AppAction) -&amp;gt; Void {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">switch&lt;/span> action {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> .loadPokemon(&lt;span style="color:#66d9ef">let&lt;/span> result):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> value.pokemons = result &lt;span style="color:#75715e">// ğŸ‘ˆ åªèƒ½æ“ä½œ pokemonList&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">default&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">break&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åªæ˜¯è¿™æ ·æ”¹åŠ¨ä¹‹åï¼Œä¹‹å‰å®šä¹‰çš„ combine å°±æ— æ³•ç¼–è¯‘é€šè¿‡ï¼ŒpokemonListReducer çš„ç­¾åå·²ç»ä¸ç¬¦åˆ combine çš„è¦æ±‚äº†ã€‚&lt;/p>
&lt;blockquote>
&lt;p>Cannot convert value of type â€˜(inout PokemonList, AppAction) -&amp;gt; ()â€™ to expected argument&lt;/p>
&lt;/blockquote>
&lt;h3 id="æ‹‰å›">
æ‹‰å›
&lt;a href="#%e6%8b%89%e5%9b%9e" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h3>
&lt;p>è§£å†³è¿™ä¸ªé—®é¢˜å¯ä»¥å¼•å…¥ä¸€ä¸ªæ•°å­¦ä¸­çš„æ¦‚å¿µ â€”â€” æ‹‰å›ã€‚&lt;/p>
&lt;blockquote>
&lt;p>å¼•ç”¨ wikipedia ä¸Šçš„è§£é‡Šï¼šâ€œç®€å•åœ°è¯´ï¼Œè®¾ &lt;em>f&lt;/em> æ˜¯ä¸€ä¸ªå˜é‡ &lt;em>y&lt;/em> çš„å‡½æ•°ï¼Œè¿™é‡Œ &lt;em>y&lt;/em> è‡ªèº«åˆæ˜¯å¦ä¸€ä¸ªå˜é‡ &lt;em>x&lt;/em> çš„å‡½æ•°ï¼Œé‚£ä¹ˆ &lt;em>f&lt;/em> å¯ä»¥å†™æˆ &lt;em>x&lt;/em> çš„å‡½æ•°ï¼Œè¿™å³ &lt;em>f&lt;/em> è¢«å‡½æ•° &lt;em>y&lt;/em>(&lt;em>x&lt;/em>) æ‹‰å›ã€‚â€&lt;/p>
&lt;/blockquote>
&lt;p>åœ¨ reducer ä¸­çš„ä¾‹å­é‡Œï¼Œä¹Ÿå¯ä»¥å¥—ç”¨ç›¸åŒçš„æ¦‚å¿µã€‚åªéœ€è¦å°†æŒæœ‰äº†éƒ¨åˆ†çŠ¶æ€æ•°æ®çš„ reducerï¼Œè½¬åŒ–æˆä¸€ä¸ªæ‹¥æœ‰ç€å…¨éƒ¨çŠ¶æ€æ•°æ®çš„ reducer ç­¾åå³å¯ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">pullback&lt;/span>&amp;lt;LocalValue, GlobalValue, Action&amp;gt;(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">_&lt;/span> reducer: @escaping (&lt;span style="color:#66d9ef">inout&lt;/span> LocalValue, Action) -&amp;gt; Void,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">get&lt;/span>: @escaping (GlobalValue) -&amp;gt; LocalValue,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">set&lt;/span>: @escaping (&lt;span style="color:#66d9ef">inout&lt;/span> GlobalValue, LocalValue) -&amp;gt; Void
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>) -&amp;gt; (&lt;span style="color:#66d9ef">inout&lt;/span> GlobalValue, Action) -&amp;gt; Void {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> { globalValue, action &lt;span style="color:#66d9ef">in&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> localValue = &lt;span style="color:#66d9ef">get&lt;/span>(globalValue)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> reducer(&amp;amp;localValue, action)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">set&lt;/span>(&amp;amp;globalValue, localValue)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¯¥å‡½æ•°åŒ…å«ä¸‰ä¸ªå…¥å‚ï¼š&lt;/p>
&lt;ol>
&lt;li>ç”¨äºå¤„ç†å±€éƒ¨çŠ¶æ€çš„ reducer&lt;/li>
&lt;li>æä¾›ä»å…¨éƒ¨çŠ¶æ€ä¸­æå–éƒ¨åˆ†çŠ¶æ€çš„å‡½æ•°&lt;/li>
&lt;li>æä¾›å°†å±€éƒ¨çŠ¶æ€è®¾ç½®åˆ°å…¨éƒ¨çŠ¶æ€ä¸­çš„å‡½æ•°&lt;/li>
&lt;/ol>
&lt;p>è¿™æ ·å°±å¾—åˆ°äº†ä¸€ä¸ªå¯ä»¥ç”¨æ¥è½¬åŒ–ç”¨äºå¤„ç†å±€éƒ¨çŠ¶æ€ reducer åˆ°å…¨éƒ¨çŠ¶æ€ reducer çš„ pullback å‡½æ•°ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>pullback(pokemonListReducer,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">get&lt;/span>: { $0.pokemonList },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">set&lt;/span>: { $0.pokemonList = $1 }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> )
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å†è¿›ä¸€æ­¥è¿˜å¯ä»¥é€šè¿‡ keyPath æ¥ä¼˜åŒ– pullback å‡½æ•°ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">pullback&lt;/span>&amp;lt;LocalValue, GlobalValue, Action&amp;gt;(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">_&lt;/span> reducer: @escaping (&lt;span style="color:#66d9ef">inout&lt;/span> LocalValue, Action) -&amp;gt; Void,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> value: WritableKeyPath&amp;lt;GlobalValue, LocalValue&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>) -&amp;gt; (&lt;span style="color:#66d9ef">inout&lt;/span> GlobalValue, Action) -&amp;gt; Void {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> { globalValue, action &lt;span style="color:#66d9ef">in&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> reducer(&amp;amp;globalValue[keyPath: value], action)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>pullback(pokemonListReducer, value: &lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>AppState.pokemonList)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™æ ·å°±å®ç°äº† reducer çš„æ‹†åˆ†ä»¥åŠå¯¹å¤„ç†çŠ¶æ€çš„éš”ç¦»&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">let&lt;/span> appReducer = combine(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> pullback(accountReducer, value: &lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>.pokemonList),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> pullback(pokemonListReducer, value: &lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>.settings),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> pullback(favoritePokemonReducer, value: &lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>.favoritePokemons)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="å‚è€ƒèµ„æ–™">
å‚è€ƒèµ„æ–™
&lt;a href="#%e5%8f%82%e8%80%83%e8%b5%84%e6%96%99" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://objccn.io/products/swift-ui">ObjC ä¸­å›½ - SwiftUI ä¸ Combine ç¼–ç¨‹&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.pointfree.co/collections/composable-architecture/reducers-and-stores/ep69-composable-state-management-state-pullbacks#downloads">Point Free - StateÂ Pullbacks&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.swiftbysundell.com/articles/the-power-of-key-paths-in-swift/">Swift by Sundell - The power of key paths in Swift&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>SwiftUI çŠ¶æ€ç®¡ç† â€”â€” Composible Binding</title><link>https://joeytat.github.io/posts/composible_binding/</link><pubDate>Mon, 03 Jan 2022 00:00:00 +0000</pubDate><guid>https://joeytat.github.io/posts/composible_binding/</guid><description>
&lt;p>åœ¨ SwiftUI ä¸­ï¼Œéœ€è¦é€šè¿‡æ•°æ®æ¥é©±åŠ¨ UI çš„å˜åŒ–ã€‚æ•°æ®ç»“æ„æŠ½è±¡æè¿°çš„è´¨é‡ä¹Ÿå½±å“ç€æˆ‘ä»¬å¯¹ SwiftUI ç•Œé¢çš„ç»´æŠ¤ã€‚&lt;/p>
&lt;p>é€šå¸¸æ•°æ®ä¸­å¯èƒ½å­˜åœ¨å¾ˆå¤šçŠ¶æ€ï¼Œå¦‚æœä½¿ç”¨å¾ˆå¤šçš„ boolean å€¼æ¥æè¿°è¿™äº›çŠ¶æ€ï¼Œé‚£ä¹ˆ App çš„å¯ç»´æŠ¤æ€§å¯èƒ½ä¼šå¤§å¤§é™ä½ã€‚&lt;/p>
&lt;h2 id="ç®¡ç†ç‹¬ç«‹çŠ¶æ€çš„é—®é¢˜">
ç®¡ç†ç‹¬ç«‹çŠ¶æ€çš„é—®é¢˜
&lt;a href="#%e7%ae%a1%e7%90%86%e7%8b%ac%e7%ab%8b%e7%8a%b6%e6%80%81%e7%9a%84%e9%97%ae%e9%a2%98" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h2>
&lt;p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª Appï¼Œç”¨æˆ·å¯ä»¥åœ¨ç™»å½•ä¸éç™»å½•çŠ¶æ€ä¸‹è¿›è¡Œæ“ä½œã€‚æ‰€ä»¥æˆ‘ä»¬çš„ç•Œé¢éœ€è¦å…¼å®¹è¿™ä¸¤ç§çŠ¶æ€ï¼Œå…¶æè¿°å¯èƒ½æ˜¯è¿™æ ·çš„ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">AppState&lt;/span>: ObservableObject {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> @Published &lt;span style="color:#66d9ef">var&lt;/span> user: User? = &lt;span style="color:#66d9ef">nil&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> @Published &lt;span style="color:#66d9ef">var&lt;/span> error: Error? = &lt;span style="color:#66d9ef">nil&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> authenticated: Bool { user &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> hasError: Bool { error &lt;span style="color:#f92672">!=&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åŸºäºè¿™æ ·çš„çŠ¶æ€æè¿°ï¼Œå¦‚æœæˆ‘ä»¬æƒ³åˆ›å»ºä¸€ä¸ªä»…å±•ç¤ºç”¨æˆ·åçš„ç»„ä»¶å¤§æ¦‚ä¼šæ˜¯è¿™æ ·ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> body: some View {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Group {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> state.hasError {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Text(&lt;span style="color:#e6db74">&amp;#34;Oops, sth went wrong: &lt;/span>&lt;span style="color:#e6db74">\(&lt;/span>state.error!.localizedDescription&lt;span style="color:#e6db74">)&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> state.authenticated {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Text(&lt;span style="color:#e6db74">&amp;#34;Hello &lt;/span>&lt;span style="color:#e6db74">\(&lt;/span>state.user?.name ?? &lt;span style="color:#e6db74">&amp;#34;Unknown&amp;#34;&lt;/span>&lt;span style="color:#e6db74">)&lt;/span>&lt;span style="color:#e6db74">!&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#66d9ef">else&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Text(&lt;span style="color:#e6db74">&amp;#34;Hello, stranger&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç²—çœ‹æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œå®é™…ä¸Šåœ¨ç»´æŠ¤è¿™æ ·çš„æ•°æ®ç»“æ„æ—¶å°±éœ€è¦æ ¼å¤–å°å¿ƒäº†ã€‚æ¯”å¦‚ç¬¬ä¸€æ¬¡æˆ‘ä»¬ç™»å½•å¤±è´¥ï¼Œä¸ºäº†å±•ç¤ºé”™è¯¯ä¿¡æ¯ç»™ &lt;code>error&lt;/code> è®¾ç½®äº†å€¼ä¹‹åã€‚å¿…é¡»åœ¨ç™»å½•æˆåŠŸä¹‹åè¦åŠæ—¶åœ°å»æ¸…ç©º errorï¼Œå¦åˆ™å³ä½¿ &lt;code>state.authenticated&lt;/code> ç­‰äº &lt;code>true&lt;/code>ï¼Œç”¨æˆ·ä¾ç„¶æ— æ³•çœ‹åˆ°æ­£ç¡®çš„ä¿¡æ¯ã€‚&lt;/p>
&lt;p>è¿™è¿˜ä»…ä»…æ˜¯æœ‰ä¸¤ä¸ªçŠ¶æ€çš„æƒ…å†µä¸‹ï¼Œåƒè¿™æ ·ç‹¬ç«‹çŠ¶æ€å±æ€§ä¼šå¸¦æ¥å¾ˆå¤§çš„ç»´æŠ¤æˆæœ¬ï¼Œå¼€å‘è€…éœ€è¦ç‰¢è®°å„ä¸ªå±æ€§ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œç”šè‡³ç¼–å†™ç•Œé¢çš„æ—¶å€™ï¼Œè¿˜éœ€è¦æ³¨æ„ä»£ç æ‰§è¡Œé¡ºåºã€‚&lt;/p>
&lt;h2 id="å¼•å…¥çŠ¶æ€æœº">
å¼•å…¥çŠ¶æ€æœº
&lt;a href="#%e5%bc%95%e5%85%a5%e7%8a%b6%e6%80%81%e6%9c%ba" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h2>
&lt;p>æŠŠçŠ¶æ€æŠ½è±¡æˆå¸¦æœ‰ associated values çš„ enum æ˜¯ä¸ªæ›´å¥½çš„é€‰æ‹©ï¼Œæ¯”å¦‚:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">class&lt;/span> &lt;span style="color:#a6e22e">AppState&lt;/span>: ObservableObject {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">enum&lt;/span> &lt;span style="color:#a6e22e">AccountState&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> authenticated(User)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> unauthenticated
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> error(Error)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> @Published &lt;span style="color:#66d9ef">var&lt;/span> accountState: AccountState = .unauthenticated
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ç•Œé¢ä¸­çš„ä½¿ç”¨&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">var&lt;/span> body: some View {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> VStack {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">switch&lt;/span> state.accountState {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> .authenticated(&lt;span style="color:#66d9ef">let&lt;/span> user):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Text(&lt;span style="color:#e6db74">&amp;#34;Hello &lt;/span>&lt;span style="color:#e6db74">\(&lt;/span>user.name&lt;span style="color:#e6db74">)&lt;/span>&lt;span style="color:#e6db74">!&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> .unauthenticated:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Text(&lt;span style="color:#e6db74">&amp;#34;unregister&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> .error(&lt;span style="color:#66d9ef">let&lt;/span> error):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Text(&lt;span style="color:#e6db74">&amp;#34;Oops, sth went wrong: &lt;/span>&lt;span style="color:#e6db74">\(&lt;/span>error.localizedDescription&lt;span style="color:#e6db74">)&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™æ ·è¢«çŠ¶æ€æœºé©±åŠ¨çš„ç•Œé¢çœ‹èµ·æ¥è¦ç›´è§‚å¤šäº†ã€‚å¹¶ä¸”åœ¨æ¯ä¸ªçŠ¶æ€ä¸­å¯¹æ•°æ®çš„æ“ä½œï¼Œä¹Ÿç”± enum èµ‹äºˆäº†éš”ç¦»èƒ½åŠ›ã€‚&lt;/p>
&lt;h2 id="åŒå‘ç»‘å®šæ€ä¹ˆåŠ">
åŒå‘ç»‘å®šæ€ä¹ˆåŠï¼Ÿ
&lt;a href="#%e5%8f%8c%e5%90%91%e7%bb%91%e5%ae%9a%e6%80%8e%e4%b9%88%e5%8a%9e" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h2>
&lt;p>ä½†è¿™æ ·åšåˆæ¥å¸¦ä¸ªæ–°çš„é—®é¢˜ï¼Œç°åœ¨æ²¡åŠæ³•ç›´æ¥é€šè¿‡ &lt;code>$&lt;/code> æ¥è·å– Binding wrapper æ¥ä¿®æ”¹çŠ¶æ€ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">switch&lt;/span> state.accountState {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> .authenticated(&lt;span style="color:#66d9ef">let&lt;/span> user):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Text(&lt;span style="color:#e6db74">&amp;#34;Hello &lt;/span>&lt;span style="color:#e6db74">\(&lt;/span>user.name&lt;span style="color:#e6db74">)&lt;/span>&lt;span style="color:#e6db74">!&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> TextField(&lt;span style="color:#e6db74">&amp;#34;Change username&amp;#34;&lt;/span>, text: &amp;lt;Binding&amp;lt;String&amp;gt;&lt;span style="color:#f92672">&amp;gt;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ä¸æ”¯æŒå¡«å…¥ self.$state.accountState.name ğŸ‘†&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ...
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;p>Xcode ä¼šæç¤º: dynamic member &amp;rsquo;name&amp;rsquo; using key path from root type &amp;lsquo;AppState.AccountState&amp;rsquo;&lt;/p>
&lt;/blockquote>
&lt;p>ä¸ºä»€ä¹ˆå½“æ“ä½œå¯¹è±¡æ˜¯ class æ—¶ï¼Œæ˜¯å¯ä»¥åšåˆ°é€šè¿‡
&lt;code>self.$state.user.name&lt;/code> æ¥è·å–åˆ° name å±æ€§çš„ Binding å°è£…çš„ï¼Ÿ&lt;/p>
&lt;h2 id="å®ç°åŠ¨æ€æˆå‘˜æŸ¥æ‰¾dynamic-member-lookup">
å®ç°åŠ¨æ€æˆå‘˜æŸ¥æ‰¾(dynamic member lookup)
&lt;a href="#%e5%ae%9e%e7%8e%b0%e5%8a%a8%e6%80%81%e6%88%90%e5%91%98%e6%9f%a5%e6%89%bedynamic-member-lookup" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h2>
&lt;p>å› ä¸º Enum è¿˜ä¸æ”¯æŒåŠ¨æ€æˆå‘˜æŸ¥æ‰¾ç‰¹æ€§ã€‚ä»€ä¹ˆæ˜¯åŠ¨æ€æˆå‘˜æŸ¥æ‰¾ï¼Ÿç®€è€Œè¨€ä¹‹å°±æ˜¯é€šè¿‡ &lt;code>\&lt;/code> æ¥è·å–åˆ°æˆå‘˜å±æ€§çš„ &lt;code>KeyPath&lt;/code> å°è£…ï¼ˆ&lt;a href="https://www.swiftbysundell.com/articles/the-power-of-key-paths-in-swift/">ä»€ä¹ˆåˆæ˜¯ KeyPath&lt;/a>ï¼Ÿï¼‰ï¼Œç„¶åå°†å…¶è½¬åŒ–ä¸ºå¯¹åº”çš„ Binding å°è£…ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">extension&lt;/span> &lt;span style="color:#a6e22e">Binding&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">transform&lt;/span>&amp;lt;LocalValue&amp;gt;(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">_&lt;/span> keyPath: WritableKeyPath&amp;lt;Value, LocalValue&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ) -&amp;gt; Binding&amp;lt;LocalValue&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Binding&amp;lt;LocalValue&amp;gt;(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">get&lt;/span>: {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">self&lt;/span>.wrappedValue[keyPath: keyPath]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">set&lt;/span>: { localValue &lt;span style="color:#66d9ef">in&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">self&lt;/span>.wrappedValue[keyPath: keyPath] = localValue
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> )
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">self&lt;/span>.&lt;span style="color:#960050;background-color:#1e0010">$&lt;/span>state.accountState.username
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ç­‰ä»·äº &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">self&lt;/span>.&lt;span style="color:#960050;background-color:#1e0010">$&lt;/span>state.transform(&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>accountState).transform(&lt;span style="color:#960050;background-color:#1e0010">\&lt;/span>username)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ‰€ä»¥æ¥ä¸‹æ¥åªéœ€è¦ä¸º enum æ·»åŠ åŠ¨æ€æˆå‘˜æŸ¥æ‰¾çš„æ”¯æŒå°±å¯ä»¥äº†&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">extension&lt;/span> &lt;span style="color:#a6e22e">Binding&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">unwrap&lt;/span>&amp;lt;Wrapped&amp;gt;() -&amp;gt; Binding&amp;lt;Wrapped&amp;gt;? &lt;span style="color:#66d9ef">where&lt;/span> Value == Wrapped? {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">guard&lt;/span> &lt;span style="color:#66d9ef">let&lt;/span> value = &lt;span style="color:#66d9ef">self&lt;/span>.wrappedValue &lt;span style="color:#66d9ef">else&lt;/span> { &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> Binding&amp;lt;Wrapped&amp;gt;(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">get&lt;/span>: { value },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">set&lt;/span>: { &lt;span style="color:#66d9ef">self&lt;/span>.wrappedValue = $0 }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> )
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç„¶åå†åˆ° enum é‡Œæ·»åŠ ä¸€ä¸ªè®¡ç®—å±æ€§æ–¹ä¾¿æˆ‘ä»¬è·å–&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">enum&lt;/span> &lt;span style="color:#a6e22e">AccountState&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> loggedIn(User)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> unregister
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">//&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">var&lt;/span> username: String? {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">get&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">guard&lt;/span> &lt;span style="color:#66d9ef">case&lt;/span> .loggedIn(&lt;span style="color:#66d9ef">let&lt;/span> user) = &lt;span style="color:#66d9ef">self&lt;/span> &lt;span style="color:#66d9ef">else&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#66d9ef">nil&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> user.username
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">set&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">guard&lt;/span> &lt;span style="color:#66d9ef">case&lt;/span> .loggedIn(&lt;span style="color:#66d9ef">let&lt;/span> user) = &lt;span style="color:#66d9ef">self&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> newValue = newValue &lt;span style="color:#66d9ef">else&lt;/span> { &lt;span style="color:#66d9ef">return&lt;/span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> user.username = newValue
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">self&lt;/span> = .loggedIn(user)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç°åœ¨å°±å¯ä»¥åœ¨ SwiftUI ä¸­å¯¹ enum ä½¿ç”¨ç»‘å®šäº†&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#66d9ef">let&lt;/span> username = &lt;span style="color:#66d9ef">self&lt;/span>.&lt;span style="color:#960050;background-color:#1e0010">$&lt;/span>state.accountState.username.unwrap() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> TextField(&lt;span style="color:#e6db74">&amp;#34;Change username&amp;#34;&lt;/span>, text: username)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>çœ‹èµ·æ¥è¿˜æ˜¯æœ‰äº›éº»çƒ¦ï¼Œå¯¹äºæ¯ä¸ªè¦ä½¿ç”¨ Binding çš„å±æ€§éƒ½éœ€è¦å»å†™ä¸€ä¸ªè®¡ç®—å±æ€§æ¥åŒ…è£…ä¸€å±‚ã€‚è¿™æ ·æ˜¾ç„¶è¿™å¹¶ä¸å¦‚ &lt;code>KeyPath&lt;/code> é‚£æ ·ï¼Œç›´æ¥é€šè¿‡ &lt;code>self.$state.accountState[\.authenticated]&lt;/code> æ¥è·å–åˆ° enum ä¸­ associated value çš„ Binding åŒ…è£…æ¥å¾—æ–¹ä¾¿ã€‚&lt;/p>
&lt;p>è™½ç„¶ Swift ç›®å‰ä¸æ”¯æŒï¼Œä½†æˆ‘ä»¬è¿˜æ˜¯å¯ä»¥é€šè¿‡å¼•å…¥ &lt;a href="https://github.com/pointfreeco/swift-case-paths">CasePaths&lt;/a> è¿™ä¸ªç¬¬ä¸‰æ–¹ä¾èµ–æ¥å®ç°ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">import&lt;/span> &lt;span style="color:#a6e22e">CasePaths&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">enum&lt;/span> &lt;span style="color:#a6e22e">AccountState&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> authenticated(User)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> unauthenticated
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">case&lt;/span> error(Error)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// è®¡ç®—å±æ€§å¯ä»¥åˆ é™¤æ‰äº†&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// var username: String? {&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// get {&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// guard case .authenticated(let user) = self else {&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// return nil&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// }&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// return user.name&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// }&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// set {&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// guard case .authenticated(let user) = self,&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// let newValue = newValue else { return }&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// user.name = newValue&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// self = .authenticated(user)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// }&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// }&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ç•Œé¢ä¸­ç›´æ¥ä½¿ç”¨ CasePath&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#66d9ef">let&lt;/span> user = &lt;span style="color:#66d9ef">self&lt;/span>.&lt;span style="color:#960050;background-color:#1e0010">$&lt;/span>state.accountState.matching(&lt;span style="color:#f92672">/&lt;/span>.authenticated) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> TextField(&lt;span style="color:#e6db74">&amp;#34;Change username&amp;#34;&lt;/span>, text: user.name)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç”±æ­¤ä¸º Enum ä¹Ÿå¢åŠ äº†ä¸ Structã€Class ç­‰æ•ˆçš„ KeyPath æ”¯æŒï¼Œä»è€Œä½¿å¾—æ–‡ç« å¼€å¤´ç”¨ Enum ä½œä¸º SwiftUI çš„çŠ¶æ€æœºç®¡ç†å·¥å…·æ›´ä¾¿æ·äº†ä¸€äº›ã€‚&lt;/p>
&lt;h2 id="å‚è€ƒèµ„æ–™">
å‚è€ƒèµ„æ–™
&lt;a href="#%e5%8f%82%e8%80%83%e8%b5%84%e6%96%99" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://kentcdodds.com/blog/stop-using-isloading-booleans">Stop using isLoading booleans&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.swiftbysundell.com/articles/the-power-of-key-paths-in-swift/">The power of key paths in Swift&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.pointfree.co/collections/swiftui/composable-bindings/ep107-composable-swiftui-bindings-the-problem">Composable SwiftUI Bindings: TheÂ Problem&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>JavaScript æ—¢ç„¶æ˜¯å•çº¿ç¨‹è¯­è¨€ï¼Œä¸ºä»€ä¹ˆ setTimeout ä¸ä¼šé˜»å¡çº¿ç¨‹ï¼Ÿ</title><link>https://joeytat.github.io/posts/asynchronous-javascript/</link><pubDate>Mon, 19 Aug 2019 00:00:00 +0000</pubDate><guid>https://joeytat.github.io/posts/asynchronous-javascript/</guid><description>
&lt;p>å…ˆçœ‹ä¸‹é¢çš„ä»£ç &lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">printHello&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Hello&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">printWorld&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;World&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">printHello&lt;/span>(); &lt;span style="color:#75715e">// è¾“å‡º Hello
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#a6e22e">printWorld&lt;/span>(); &lt;span style="color:#75715e">// è¾“å‡º World
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>åœ¨ JavaScript ä¸­ï¼Œå­˜åœ¨ä¸€ä¸ªå…¨å±€è°ƒç”¨æ ˆ(Global Call Stack)ã€‚å½“æˆ‘ä»¬è°ƒç”¨ &lt;code>printHello&lt;/code> æ—¶ï¼Œä¼šå°†è¯¥æ–¹æ³•åŠ å…¥åˆ°æ ˆä¸­ï¼Œç”±äº JavaScript æ˜¯å•çº¿ç¨‹æ‰§è¡Œæœºåˆ¶ï¼ˆåŒä¸€æ—¶é—´åªæ‰§è¡Œä¸€ä¸ªå‘½ä»¤ï¼‰ï¼Œæ‰€ä»¥ä¼šåœ¨æ‰§è¡Œå®Œæˆäº† &lt;code>printHello&lt;/code> ä¹‹åå†æ‰§è¡Œ &lt;code>printWorld&lt;/code>ã€‚&lt;/p>
&lt;p>é‚£ä¹ˆç°åœ¨å°±å¼•å…¥æ ‡é¢˜ä¸­çš„é—®é¢˜ï¼Œ&lt;strong>JavaScript æ—¢ç„¶æ˜¯å•çº¿ç¨‹è¯­è¨€ï¼Œä¸ºä»€ä¹ˆ setTimeout ä¸ä¼šé˜»å¡çº¿ç¨‹ï¼Ÿ&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">printHello&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Hello&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">printWorld&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;World&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">setTimeout&lt;/span>(&lt;span style="color:#a6e22e">printHello&lt;/span>, &lt;span style="color:#ae81ff">1000&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">printWorld&lt;/span>();
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¡¨é¢ä¸Šæ¥çœ‹ &lt;code>setTimeout&lt;/code> ä¹Ÿæ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œä»–çš„å®šä¹‰å¯èƒ½æ˜¯è¿™æ ·ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">setTimeout&lt;/span>(&lt;span style="color:#a6e22e">callbackFunc&lt;/span>, &lt;span style="color:#a6e22e">interval&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ....
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>é‚£ä¹ˆæŒ‰ç…§ JS å•çº¿ç¨‹ç†è®ºæ¥è¯´ï¼Œåº”è¯¥æ˜¯å…ˆå°† &lt;code>setTimeout&lt;/code> æ–¹æ³•å‹å…¥å…¨å±€è°ƒç”¨æ ˆï¼Œå¹¶ä¸”æ‰§è¡Œè¯¥æ–¹æ³•ï¼Œç­‰å¾… 1 ç§’é’Ÿï¼Œç„¶åå†æ‰§è¡Œ &lt;code>printWorld&lt;/code> æ‰å¯¹ã€‚ä½†å®é™…ä¸Šæˆ‘ä»¬éƒ½çŸ¥é“ï¼Œæ‰“å°çš„ç»“æœä¼šæ˜¯ &amp;ldquo;World&amp;rdquo; ç„¶å &amp;ldquo;Hello&amp;rdquo;ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿ&lt;/p>
&lt;h3 id="web-browser-api---callback-queue">
Web Browser API &amp;amp; Callback Queue
&lt;a href="#web-browser-api---callback-queue" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h3>
&lt;p>äº‹å®ä¸Š &lt;code>setTimeout&lt;/code> å¹¶ä¸æ˜¯å®Œå…¨æ˜¯ JS ä»£ç ï¼Œè€Œæ˜¯å±äº &lt;strong>Web Browser API&lt;/strong> ä¸­çš„æ–¹æ³•ã€‚å°±åƒåå­—ä¸­æ‰€æŒ‡çš„é‚£æ ·ï¼Œ JS è°ƒç”¨äº† &lt;code>setTimeout&lt;/code> ä¹‹åï¼Œæµè§ˆå™¨ï¼ˆWeb Browserï¼‰ä¼šå»åˆ›å»ºä¸€ä¸ª timerï¼ŒåŒæ—¶å°†æˆ‘ä»¬ä¼ å…¥ &lt;code>setTimeout&lt;/code> çš„æ–¹æ³• - &lt;code>printHello&lt;/code> åŠ å…¥åˆ° &lt;strong>Callback Queueï¼ˆå›è°ƒé˜Ÿåˆ—ï¼‰&lt;/strong> ä¸­ã€‚&lt;/p>
&lt;p>1000 æ¯«ç§’è¿‡å»åï¼Œæµè§ˆå™¨ä¼šé€šçŸ¥ JavaScript å¼•æ“å°†å›è°ƒé˜Ÿåˆ—ä¸­çš„ &lt;code>printHello&lt;/code> åŠ å…¥åˆ° JS çš„å…¨å±€è°ƒç”¨æ ˆä¸­æ‰§è¡Œã€‚&lt;/p>
&lt;p>æ‰€ä»¥åœ¨ JS çš„å…¨å±€è°ƒç”¨æ ˆçœ‹æ¥ï¼Œæ˜¯å…ˆæœ‰ä¸€ä¸ª &lt;code>printWorld&lt;/code> åŠ å…¥åˆ°äº†è°ƒç”¨æ ˆï¼Œè¿‡äº† 1000 æ¯«ç§’ä¹‹åï¼ŒåˆåŠ å…¥äº†ä¸€ä¸ª &lt;code>printHello&lt;/code> æ–¹æ³•ã€‚&lt;/p>
&lt;p>é‚£å¦‚æœæˆ‘ä»¬çš„ &lt;code>printWorld&lt;/code> ä¹‹åè¿˜æœ‰å…¶ä»–çš„æ–¹æ³•æ‰§è¡Œæ—¶é—´è¶…è¿‡äº† 1000 æ¯«ç§’å‘¢ï¼Ÿ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">/// çœç•¥æ‰ printHello å’Œ printWorld å®šä¹‰
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">function&lt;/span> &lt;span style="color:#a6e22e">heavyWork&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">for&lt;/span>(&lt;span style="color:#66d9ef">let&lt;/span> &lt;span style="color:#a6e22e">i&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>; &lt;span style="color:#a6e22e">i&lt;/span> &lt;span style="color:#f92672">&amp;lt;&lt;/span> &lt;span style="color:#ae81ff">1000000&lt;/span>; &lt;span style="color:#a6e22e">i&lt;/span>&lt;span style="color:#f92672">++&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;Heavy Work&amp;#34;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">setTimeout&lt;/span>(&lt;span style="color:#a6e22e">printHello&lt;/span>, &lt;span style="color:#ae81ff">1000&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">printWorld&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">heavyWork&lt;/span>(); &lt;span style="color:#75715e">// å‡è®¾ä¼šæ‰§è¡Œ 2000ms
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç°åœ¨è®©æˆ‘ä»¬å‡è®¾ &lt;code>heavyWork&lt;/code> æ–¹æ³•ä¼šæ‰§è¡Œ 2000msï¼Œå¯æ˜¯æˆ‘ä»¬çš„ &lt;code>setTimeout&lt;/code> åªä¼šæ‰§è¡Œ 1000msï¼Œé‚£ä¹ˆæŒ‰ç…§ä¸Šé¢çš„ç†è®ºï¼Œ1000ms åˆ°äº†ä¹‹åï¼Œ&lt;code>printHello&lt;/code> ä¼šè¢«åŠ å…¥åˆ° JS çš„è°ƒç”¨æ ˆä¸­æ‰§è¡Œï¼Œé‚£ç°åœ¨çš„è¾“å‡ºä¼šæ˜¯ä¸€å †â€œHeavy Workâ€ä¹‹ä¸­å¤¹å¸¦ç€ä¸€ä¸ªâ€œHelloâ€å—ï¼Ÿ&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">World&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">Heavy&lt;/span> &lt;span style="color:#a6e22e">Work&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">Hello&lt;/span> &lt;span style="color:#75715e">// ä¼šè¾“å‡ºä¸€å † Heavy Work ä¸­å¤¹å¸¦ä¸€ä¸ª Hello å—ï¼Ÿ
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">Heavy&lt;/span> &lt;span style="color:#a6e22e">Work&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å½“ç„¶ä¸ä¼šå•¦ï¼Œå› ä¸ºæˆ‘ä»¬æœ‰ Event Loopï¼ˆäº‹ä»¶å¾ªç¯æœºåˆ¶ï¼‰ã€‚&lt;/p>
&lt;h3 id="event-loop">
Event Loop
&lt;a href="#event-loop" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h3>
&lt;p>Event Loop å…¶å®ç†è§£èµ·æ¥éå¸¸ç®€å•ï¼Œå°±æ˜¯ä¸€ä¸ªå¾ªç¯ä¼šä¸åœåœ°æ£€æŸ¥ JS è°ƒç”¨æ ˆã€‚åªæœ‰åœ¨ JS è°ƒç”¨æ ˆ&lt;strong>æ²¡æœ‰ä»»åŠ¡&lt;/strong>çš„æƒ…å†µä¸‹ï¼ŒCallback Queue ä¸­çš„ä»»åŠ¡ï¼Œæ‰ä¼šè¢«æ·»åŠ åˆ° JS è°ƒç”¨æ ˆã€‚&lt;/p>
&lt;p>æ‰€ä»¥ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ&lt;code>setTimeout&lt;/code> è™½ç„¶æŒ‡å®šäº† 1000ms ä¹‹åå°±æ‰§è¡Œ &lt;code>printHello&lt;/code>ï¼Œä½†å®é™…ä¸Šä¼šè¢«éœ€è¦æ‰§è¡Œ 2000ms çš„ &lt;code>heavyWork&lt;/code>é˜»å¡ä½ï¼Œ è¾“å‡ºçš„ç»“æœä¼šæ˜¯ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">World&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">Heavy&lt;/span> &lt;span style="color:#a6e22e">Work&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>.... &lt;span style="color:#75715e">// é•¿è¾¾ 2000ms çš„ Heavy Work
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>&lt;span style="color:#a6e22e">Heavy&lt;/span> &lt;span style="color:#a6e22e">Work&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">Hello&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="æ€»ç»“">
æ€»ç»“
&lt;a href="#%e6%80%bb%e7%bb%93" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h3>
&lt;ul>
&lt;li>Web Browser API&lt;br>
æä¾›ç»™æˆ‘ä»¬ JavaScript æ‰€æ²¡æœ‰åå°è¿è¡Œä»»åŠ¡çš„èƒ½åŠ›ï¼Œé™¤äº† &lt;code>setTimeout&lt;/code> å’Œ &lt;code>setInterval&lt;/code> è¿™æ ·åˆ›å»º timer çš„ API ä¹‹å¤–ï¼Œè¿˜åŒ…æ‹¬äº† Ajaxï¼Œç”¨æˆ·äº¤äº’ï¼Œæ–‡ä»¶è¯»å†™ç­‰æ“ä½œã€‚&lt;/li>
&lt;li>Callback Queue&lt;br>
ç”¨äºæŒæœ‰æäº¤åˆ° Web Browser API ä¸­ç­‰å¾…å›è°ƒçš„ callbackã€‚&lt;/li>
&lt;li>Event Loop&lt;br>
ä¸€ä¸ªä¸åœåœ°æ£€æŸ¥ JavaScript è°ƒç”¨æ ˆä¸­æ˜¯å¦è¿˜æœ‰ä»»åŠ¡çš„å¾ªç¯ã€‚&lt;/li>
&lt;/ul></description></item><item><title>React è¿›é˜¶æ¨¡å¼ä¹‹å¤åˆç»„ä»¶ï¼ˆCompound Componentï¼‰</title><link>https://joeytat.github.io/posts/compound-component/</link><pubDate>Mon, 12 Aug 2019 00:00:00 +0000</pubDate><guid>https://joeytat.github.io/posts/compound-component/</guid><description>
&lt;h3 id="å¤åˆç»„ä»¶æ˜¯ä»€ä¹ˆ">
å¤åˆç»„ä»¶æ˜¯ä»€ä¹ˆ
&lt;a href="#%e5%a4%8d%e5%90%88%e7%bb%84%e4%bb%b6%e6%98%af%e4%bb%80%e4%b9%88" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h3>
&lt;p>ç¼–å†™é¡µé¢æ—¶ï¼Œç»å¸¸å­˜åœ¨å¤šä¸ªå­ç»„ä»¶çš„å±•ç¤ºï¼Œæ˜¯ä¾èµ–äºåŒä¸€ä¸ªæ•°æ®æºçš„æƒ…å†µã€‚
æ¯”å¦‚å•é€‰æ¡†ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-jsx" data-lang="jsx">&lt;span style="display:flex;">&lt;span>&amp;lt;&lt;span style="color:#f92672">Switcher&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#f92672">Switch&lt;/span> &lt;span style="color:#a6e22e">on&lt;/span>&lt;span style="color:#f92672">=&lt;/span>{&lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">props&lt;/span>.&lt;span style="color:#a6e22e">selecting&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#e6db74">&amp;#39;React&amp;#39;&lt;/span>}&amp;gt;&lt;span style="color:#a6e22e">React&lt;/span>&amp;lt;/&lt;span style="color:#f92672">Switch&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#f92672">Switch&lt;/span> &lt;span style="color:#a6e22e">on&lt;/span>&lt;span style="color:#f92672">=&lt;/span>{&lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">props&lt;/span>.&lt;span style="color:#a6e22e">selecting&lt;/span> &lt;span style="color:#f92672">==&lt;/span> &lt;span style="color:#e6db74">&amp;#39;Vue&amp;#39;&lt;/span>}&amp;gt;&lt;span style="color:#a6e22e">Vue&lt;/span>&amp;lt;/&lt;span style="color:#f92672">Switch&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;/&lt;span style="color:#f92672">Switcher&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ‰€æœ‰çš„ &lt;code>Switch&lt;/code> çš„æ•°æ®éƒ½éœ€è¦å¯¹ &lt;code>selecting&lt;/code> çš„å€¼è¿›è¡Œåˆ¤æ–­ï¼Œå¹¶ä¸”ä»£ç ä¸­å…¶å®åªæœ‰ &lt;code>this.props.selecting ==&lt;/code> åé¢çš„éƒ¨åˆ†ä¸åŒï¼Œå¦‚æœèƒ½æ”¹å†™æˆè¿™æ ·ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-jsx" data-lang="jsx">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">static&lt;/span> &lt;span style="color:#a6e22e">Switcher&lt;/span>.&lt;span style="color:#a6e22e">React&lt;/span> &lt;span style="color:#f92672">=&lt;/span> ({&lt;span style="color:#a6e22e">selecting&lt;/span>}) =&amp;gt; (
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#f92672">Switch&lt;/span> &lt;span style="color:#a6e22e">on&lt;/span>&lt;span style="color:#f92672">=&lt;/span>{&lt;span style="color:#a6e22e">selecting&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#e6db74">&amp;#39;React&amp;#39;&lt;/span>}&amp;gt;&lt;span style="color:#a6e22e">React&lt;/span>&amp;lt;/&lt;span style="color:#f92672">Switch&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">static&lt;/span> &lt;span style="color:#a6e22e">Switcher&lt;/span>.&lt;span style="color:#a6e22e">Vue&lt;/span> &lt;span style="color:#f92672">=&lt;/span> ({&lt;span style="color:#a6e22e">selecting&lt;/span>}) =&amp;gt; (
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#f92672">Switch&lt;/span> &lt;span style="color:#a6e22e">on&lt;/span>&lt;span style="color:#f92672">=&lt;/span>{&lt;span style="color:#a6e22e">selecting&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#e6db74">&amp;#39;Vue&amp;#39;&lt;/span>}&amp;gt;&lt;span style="color:#a6e22e">Vue&lt;/span>&amp;lt;/&lt;span style="color:#f92672">Switch&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;&lt;span style="color:#f92672">Switcher&lt;/span> &lt;span style="color:#a6e22e">selecting&lt;/span>&lt;span style="color:#f92672">=&lt;/span>{&lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">props&lt;/span>.&lt;span style="color:#a6e22e">selecting&lt;/span>}&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#f92672">Switcher.React&lt;/span>/&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#f92672">Switcher.Vue&lt;/span>/&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;/&lt;span style="color:#f92672">Switcher&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>éšå¼åœ°å°†çˆ¶ç»„ä»¶çš„æ•°æ®ä¼ é€’ç»™å­ç»„ä»¶ï¼Œå…¶æ˜¾ç¤ºé€»è¾‘äº¤ç”±ç»™å­ç»„ä»¶è‡ªè¡Œå¤„ç†ï¼Œä»£ç çš„ç»„ç»‡ç»“æ„å°†ä¼šæ¸…æ™°å¾ˆå¤šã€‚åç»­å³ä½¿éœ€æ±‚å˜åŠ¨ï¼Œæ•°æ®çš„ä¼ é€’æ”¹å˜ä¹Ÿå¹¶ä¸éœ€è¦æˆ‘ä»¬æ“å¿ƒï¼ˆä¸éœ€è¦ä¸€ä¸ªå­ç»„ä»¶ä¸€ä¸ªå­ç»„ä»¶åœ°æ·»åŠ ä¼ é€’ï¼‰ï¼Œåªéœ€è¦ä¿®æ”¹ &lt;code>Switcher&lt;/code> å­æ§ä»¶å†…éƒ¨å¤„ç†é€»è¾‘å³å¯ã€‚&lt;/p>
&lt;p>é‚£ä¹ˆè¦æ€ä¹ˆå®ç°è¿™ä¸ª&lt;strong>éšå¼æ•°æ®ä¼ é€’&lt;/strong>å‘¢ï¼Ÿ å¯ä»¥é€šè¿‡ &lt;a href="https://reactjs.org/docs/react-api.html#reactchildren">&lt;code>React.Children.map&lt;/code>&lt;/a> å’Œ &lt;a href="https://reactjs.org/docs/react-api.html#cloneelement">&lt;code>React.cloneElement&lt;/code>&lt;/a> è¿™ä¸¤ä¸ª API æ¥å®ç°ã€‚&lt;/p>
&lt;h3 id="reactchildrenmap-ä¸-reactcloneelement">
React.Children.map ä¸ React.cloneElement
&lt;a href="#reactchildrenmap-%e4%b8%8e-reactcloneelement" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h3>
&lt;p>åœ¨ &lt;code>render&lt;/code> ä¸­æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ &lt;code>React.Children.map&lt;/code> æ¥è·å–åˆ° &lt;code>Switcher&lt;/code> ä¸­çš„å­ç»„ä»¶ï¼Œç„¶åé€šè¿‡ &lt;code>React.cloneElement&lt;/code> å¯¹ç»„ä»¶è¿›è¡Œå…‹éš†åŠæ•°æ®ä¼ é€’ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-jsx" data-lang="jsx">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">render&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#a6e22e">React&lt;/span>.&lt;span style="color:#a6e22e">Children&lt;/span>.&lt;span style="color:#a6e22e">map&lt;/span>(&lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">props&lt;/span>.&lt;span style="color:#a6e22e">children&lt;/span>, &lt;span style="color:#a6e22e">child&lt;/span> =&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">React&lt;/span>.&lt;span style="color:#a6e22e">cloneElement&lt;/span>(&lt;span style="color:#a6e22e">child&lt;/span>, {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">on&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">state&lt;/span>.&lt;span style="color:#a6e22e">on&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">toggle&lt;/span>&lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">toggle&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> )
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™æ ·ï¼Œå³ä½¿æˆ‘ä»¬åœ¨ä½¿ç”¨ &lt;code>Switcher.React&lt;/code> å’Œ &lt;code>Switcher.Vue&lt;/code> æ—¶ï¼Œæ²¡æœ‰æ˜¾å¼åœ°ä¼ é€’å‚æ•°ï¼Œå­ç»„ä»¶ä¹Ÿèƒ½è·å–æ•°æ®ã€‚&lt;/p>
&lt;blockquote>
&lt;p>è¿™é‡Œ &lt;code>React.Children.map&lt;/code> ä¸ &lt;code>this.props.children.map&lt;/code> å¹¶ä¸ç­‰ä»·ï¼Œåè€…åœ¨åªæœ‰ä¸€ä¸ªå­ç»„ä»¶çš„æ—¶å€™ï¼Œè¿”å›çš„ä¸æ˜¯æ•°ç»„ï¼Œè€Œæ˜¯å”¯ä¸€çš„é‚£ä¸ªç»„ä»¶ã€‚&lt;/p>
&lt;/blockquote>
&lt;h3 id="reactchildrenmap-çš„å±€é™æ€§">
React.Children.map çš„å±€é™æ€§
&lt;a href="#reactchildrenmap-%e7%9a%84%e5%b1%80%e9%99%90%e6%80%a7" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h3>
&lt;p>ä¸Šé¢ä»£ç æœ‰ä¸ªé—®é¢˜æ˜¯ï¼Œå¦‚æœå‡ºç°äº†æ›´å¤šå±‚çº§çš„å­ç»„ä»¶ï¼Œé‚£ä¹ˆå‚æ•°ä¼ é€’åªä¼šåˆ°ç¬¬ä¸€å±‚ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-jsx" data-lang="jsx">&lt;span style="display:flex;">&lt;span>&amp;lt;&lt;span style="color:#f92672">Switcher&lt;/span> &lt;span style="color:#a6e22e">selecting&lt;/span>&lt;span style="color:#f92672">=&lt;/span>{&lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">props&lt;/span>.&lt;span style="color:#a6e22e">selecting&lt;/span>}&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#f92672">Switcher.React&lt;/span>/&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#f92672">div&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#f92672">Switcher.Vue&lt;/span>/&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;/&lt;span style="color:#f92672">div&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;/&lt;span style="color:#f92672">Switcher&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™æ ·å†™ä¼šæç¤ºä¼ é€’äº†é”™è¯¯çš„å‚æ•°ç»™ &lt;code>div&lt;/code>ï¼Œå› ä¸ºæˆ‘ä»¬ &lt;code>React.Children.map&lt;/code> åªèƒ½è·å–åˆ°ç¬¬ä¸€å±‚å­ç»„ä»¶ï¼ˆ&lt;code>[Switcher.React, div]&lt;/code>ï¼‰ã€‚&lt;/p>
&lt;p>é‚£æ€ä¹ˆåŠï¼Œéš¾é“è¦ç”¨é€’å½’ï¼ŸReact 16.x æä¾›äº†æ–°çš„ &lt;a href="https://reactjs.org/docs/context.html#when-to-use-context">Context&lt;/a> å¯ä»¥å¾ˆå¥½åœ°è§£å†³è¿™ä¸ªé—®é¢˜ã€‚&lt;/p>
&lt;p>Context çš„ä½¿ç”¨æ–¹æ³•å¾ˆç®€å•ï¼Œé¦–å…ˆåˆ›å»ºä¸€ä¸ª Contextï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-jsx" data-lang="jsx">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">selecting&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">SwitcherContext&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#a6e22e">React&lt;/span>.&lt;span style="color:#a6e22e">createContext&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>æ¥ç€æ˜¯ &lt;code>render&lt;/code>ï¼Œæ—¢ç„¶æˆ‘ä»¬ä¸ç¡®å®šä¼šæœ‰å¤šå°‘å±‚çš„å­ç»„ä»¶ï¼Œé‚£ä¹ˆå°±ç›´æ¥å°† &lt;code>this.props.children&lt;/code> åŒ…è£¹åœ¨ &lt;code>Context.Provider&lt;/code> ä¸­ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-jsx" data-lang="jsx">&lt;span style="display:flex;">&lt;span>&amp;lt;&lt;span style="color:#f92672">SwitcherContext.Provider&lt;/span> &lt;span style="color:#a6e22e">value&lt;/span>&lt;span style="color:#f92672">=&lt;/span>{&lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">props&lt;/span>.&lt;span style="color:#a6e22e">selecting&lt;/span>}&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {&lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">props&lt;/span>.&lt;span style="color:#a6e22e">children&lt;/span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;/&lt;span style="color:#f92672">SwitcherContext.Provider&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ç„¶åæ”¹å†™æˆ‘ä»¬çš„å­ç»„ä»¶æ•°æ®è·å–æ–¹å¼ï¼Œä¹‹å‰æ˜¯é€šè¿‡ &lt;code>React.cloneElement&lt;/code> æ¥å°†æ•°æ®é€šè¿‡ &lt;code>props&lt;/code> ä¼ é€’åˆ°ç»„ä»¶ä¸­ï¼Œç°åœ¨å¯ä»¥ç›´æ¥ä» &lt;code>Context.Consumer&lt;/code> ä¸­è·å–ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-jsx" data-lang="jsx">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">static&lt;/span> &lt;span style="color:#a6e22e">Switcher&lt;/span>.&lt;span style="color:#a6e22e">React&lt;/span> &lt;span style="color:#f92672">=&lt;/span>() =&amp;gt; (
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#f92672">SwitcherContext.Consumer&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> { &lt;span style="color:#a6e22e">selecting&lt;/span> =&amp;gt; (
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#f92672">Switch&lt;/span> &lt;span style="color:#a6e22e">on&lt;/span>&lt;span style="color:#f92672">=&lt;/span>{&lt;span style="color:#a6e22e">selecting&lt;/span> &lt;span style="color:#f92672">===&lt;/span> &lt;span style="color:#e6db74">&amp;#39;React&amp;#39;&lt;/span>}&amp;gt;&lt;span style="color:#a6e22e">React&lt;/span>&amp;lt;/&lt;span style="color:#f92672">Switch&lt;/span>&amp;gt;)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;/&lt;span style="color:#f92672">SwitcherContext.Consumer&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å¦‚æ­¤ä¸€æ¥å°±å®Œæˆäº†æˆ‘ä»¬çš„æ”¹é€ ã€‚å¤–éƒ¨ä½¿ç”¨åˆ° &lt;code>Switcher&lt;/code> çš„åœ°æ–¹æ²¡æœ‰ä»»ä½•å˜åŠ¨ï¼Œä¾ç„¶æ˜¯ï¼š&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-jsx" data-lang="jsx">&lt;span style="display:flex;">&lt;span>&amp;lt;&lt;span style="color:#f92672">Switcher&lt;/span> &lt;span style="color:#a6e22e">selecting&lt;/span>&lt;span style="color:#f92672">=&lt;/span>{&lt;span style="color:#66d9ef">this&lt;/span>.&lt;span style="color:#a6e22e">props&lt;/span>.&lt;span style="color:#a6e22e">selecting&lt;/span>}&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#f92672">Switcher.React&lt;/span>/&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#f92672">div&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#f92672">Switcher.Vue&lt;/span>/&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;/&lt;span style="color:#f92672">div&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;/&lt;span style="color:#f92672">Switcher&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="ç›¸å…³èµ„æ–™">
ç›¸å…³èµ„æ–™
&lt;a href="#%e7%9b%b8%e5%85%b3%e8%b5%84%e6%96%99" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h4>
&lt;ul>
&lt;li>&lt;a href="https://frontendmasters.com/courses/advanced-react-patterns/">Frontend Masters - Advanced React Patterns&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://reactjs.org/docs/context.html#when-to-use-context">React Context&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>ç¿»è¯‘ - å›¾åƒä¼˜åŒ–</title><link>https://joeytat.github.io/posts/optimizing_images/</link><pubDate>Wed, 19 Jun 2019 00:00:00 +0000</pubDate><guid>https://joeytat.github.io/posts/optimizing_images/</guid><description>
&lt;p>ç¿»è¯‘è‡ª &lt;a href="https://www.swiftjectivec.com/optimizing-images/">Optimizing Images&lt;/a> by &lt;a href="https://twitter.com/jordanmorgan10">Jordan Morgan&lt;/a>&lt;/p>
&lt;p>æœ‰å¥è¯è¯´ï¼šæœ€å¥½çš„ç…§ç›¸æœºå°±æ˜¯åœ¨ä½ èº«è¾¹çš„é‚£å°ã€‚ å¦‚æœè¿™å¥ä¿—è¯­æ˜¯å¯¹çš„ï¼Œé‚£ä¹ˆæ¯«æ— ç–‘é—®åœ°â€” iPhone æ˜¯è¿™ä¸ªæ˜Ÿçƒä¸Šæœ€é‡è¦çš„ç›¸æœºï¼Œ å¹¶ä¸”æˆ‘ä»¬çš„ä¸šç•Œä¹Ÿè¯æ˜äº†è¿™ä¸€ç‚¹ã€‚&lt;/p>
&lt;p>åœ¨åº¦å‡ä¸­? å¦‚æœæ²¡æœ‰åœ¨ä½ çš„ Instagram Story ä¸­ç•™ä¸‹å‡ å¼ ç…§ç‰‡ï¼Œé‚£å°±ä¸ç®—å‘ç”Ÿè¿‡ã€‚&lt;/p>
&lt;p>çˆ†ç‚¸æ–°é—»? ç«‹åˆ»æ‰“å¼€ Twitter æ¥æŸ¥çœ‹å“ªäº›åª’ä½“åœ¨é€šè¿‡ç…§ç‰‡å®æ—¶æŠ¥é“äº‹ä»¶ã€‚&lt;/p>
&lt;p>ç­‰ç­‰ã€‚&lt;/p>
&lt;p>ç”±äºå›¾åƒåœ¨å„ä¸ªå¹³å°æ— å¤„ä¸åœ¨çš„å‡ºç°ï¼Œåœ¨ä½æ€§èƒ½ä¸”å†…å­˜ç´§å¼ çš„æƒ…å†µä¸‹å±•ç¤ºå®ƒä»¬ï¼Œä¼šå¾ˆå®¹æ˜“åœ°é€ æˆå¤±æ§ã€‚ å¦‚æœæˆ‘ä»¬çŸ¥é“ UIKit åº•å±‚åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆä»¥åŠå¦‚ä½•å¤„ç†å›¾åƒï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥èŠ‚çœå¤§é‡çš„èµ„æºå¼€é”€ï¼Œå¹¶ä¸”é€ƒè„±æ— æƒ…çš„ç³»ç»Ÿæ¸…é™¤åˆ¶è£ã€‚&lt;/p>
&lt;h2 id="ç†è®ºä¸Šæ¥è¯´">
ç†è®ºä¸Šæ¥è¯´
&lt;a href="#%e7%90%86%e8%ae%ba%e4%b8%8a%e6%9d%a5%e8%af%b4" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h2>
&lt;p>çªå‡»æµ‹éªŒ - è¿™å¼ æˆ‘å¥³å„¿çš„ 266 KB å­—èŠ‚å¤§å°ï¼ˆå¹¶ä¸”è¿˜è›®æ—¶å°šçš„ï¼‰çš„ç…§ç‰‡ï¼Œåœ¨ä¸€ä¸ª iOS App ä¸­ä¼šå±•ç¤ºéœ€è¦ç”¨åˆ°å¤šå°‘å†…å­˜?&lt;/p>
&lt;p>&lt;img src="https://www.swiftjectivec.com/assets/images/baylor.jpg" alt="Baylor">&lt;/p>
&lt;p>å‰§é€ä¸€ä¸‹ - ä¸æ˜¯ 266 KBï¼Œä¹Ÿä¸æ˜¯ 2.66 MBï¼Œè€Œæ˜¯å¤§æ¦‚ 14 MBã€‚&lt;/p>
&lt;p>ä¸ºä»€ä¹ˆ?&lt;/p>
&lt;p>æœ¬è´¨ä¸Šæ¥è¯´ iOS ç”³è¯·å†…å­˜æ˜¯æ ¹æ®å›¾åƒçš„å°ºå¯¸ - è€Œå›¾åƒçš„æ–‡ä»¶å¤§å°åè€Œå½±å“ä¸å¤§ã€‚ è¿™å¼ å›¾ç‰‡çš„å°ºå¯¸æ˜¯ 1718 x 2048 åƒç´ ã€‚ å‡è®¾æ¯ä¸ªåƒç´ ä¼šå ç”¨ 4 ä¸ªå­—èŠ‚:&lt;/p>
&lt;blockquote>
&lt;p>1718 * 2048 * 4 / 1024 / 1024 = 13.42 MB å¤§çº¦&lt;/p>
&lt;/blockquote>
&lt;p>æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœä½ éœ€è¦å±•ç¤ºä¸€ä¸ªåˆ—è¡¨çš„ç”¨æˆ·ä¿¡æ¯ï¼Œå…¶ä¸­æ¯ä¸€è¡Œéƒ½æ˜¾ç¤ºä¸€ä¸ªå¸¸è§çš„åœ†å½¢å¤´åƒåœ¨å·¦ä¾§ã€‚ å¦‚æœä½ è§‰å¾—æ¯ä¸€å¼ å›¾ç‰‡éƒ½é€šè¿‡ ImageOptim æˆ–è€…å…¶ä»–æ–¹å¼å¤„ç†è¿‡å°±æ²¡é—®é¢˜ï¼Œé‚£å°±é”™äº†ã€‚ ä¿å®ˆä¼°è®¡æ¯ä¸€å¼ å¤´åƒæ˜¯ 256 x 256 å¤§å°ï¼Œé‚£ä¾ç„¶ä¼šè€—è´¹å¤§é‡å†…å­˜ã€‚&lt;/p>
&lt;h2 id="æ¸²æŸ“è·¯å¾„">
æ¸²æŸ“è·¯å¾„
&lt;a href="#%e6%b8%b2%e6%9f%93%e8%b7%af%e5%be%84" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h2>
&lt;p>è¿™å°±æ˜¯è¯´ - æ˜ç™½åº•å±‚æ˜¯æ€ä¹ˆå›äº‹æ˜¯å¾ˆåˆ’ç®—çš„ã€‚ å½“ä½ åŠ è½½ä¸€å¼ å›¾ç‰‡çš„æ—¶å€™ï¼Œä¼šç»ç”±è¿™ä¸‰æ­¥å¤„ç†:&lt;/p>
&lt;p>1ï¼‰ åŠ è½½ - iOS ä¼šè·å–åˆ°å°šæœªè§£å‹çš„å›¾ç‰‡ï¼Œç„¶åå¼€è¾Ÿï¼ˆæˆ‘ä»¬çš„å›¾ç‰‡ä¸¾ä¾‹ï¼‰ 266 kb çš„å†…å­˜ï¼Œç›®å‰ä¸ºæ­¢æ²¡ä»€ä¹ˆå¥½æ‹…å¿ƒçš„ã€‚&lt;/p>
&lt;p>2ï¼‰ è§£ç  - ç°åœ¨ iOS ä¼šå°†å›¾ç‰‡è½¬åŒ–ä¸º GPU å¯ä»¥è¯»å–å¹¶ä¸”å¤„ç†çš„æ•°æ®ã€‚ ç°åœ¨æ˜¯è§£å‹ï¼Œåœ¨è¿™ä¸€æ­¥å°±ä¼šäº§ç”Ÿæˆ‘ä»¬ä¸Šé¢æåˆ°çš„ 14 MB çš„å†…å­˜å¼€é”€ã€‚&lt;/p>
&lt;p>3ï¼‰ æ¸²æŸ“ - æŒ‰ç…§å­—é¢æ„æ€ç†è§£ï¼Œç°åœ¨å›¾ç‰‡æ•°æ®å‡†å¤‡å¥½äº†ä»¥ä»»ä½•æ–¹å¼è¿›è¡Œæ¸²æŸ“ã€‚ å³ä½¿æ˜¯æ”¾åœ¨ 60 x 60 point çš„ image view ä¸­ã€‚&lt;/p>
&lt;p>è§£ç é˜¶æ®µæ˜¯å¤§å¤´ã€‚ åœ¨è¿™é‡Œ iOS ä¼šåˆ›å»ºä¸€ä¸ªç¼“å†²åŒº - å‡†ç¡®çš„è¯´æ˜¯å›¾ç‰‡ç¼“å†²åŒºã€‚ è¿™é‡Œä¼šå°†å›¾åƒæ”¾åœ¨å†…å­˜ä¸­ã€‚ è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆï¼Œå…¶å†…å­˜å ç”¨ä¼šå’Œå›¾ç‰‡å°ºå¯¸æŒ‚é’©è€Œä¸æ˜¯å›¾ç‰‡æ–‡ä»¶å¤§å°ã€‚ è¿™å°±æ¸…æ™°åœ°è§£é‡Šäº†ï¼Œå½“å¤„ç†å›¾ç‰‡æ—¶ï¼Œä¸ºä»€ä¹ˆå°ºå¯¸å¯¹äºå†…å­˜æ¶ˆè€—å¦‚æ­¤é‡è¦ã€‚&lt;/p>
&lt;p>é’ˆå¯¹ &lt;code>UIImage&lt;/code>ï¼Œ å½“æˆ‘ä»¬æŠŠä»ç½‘ç»œè¯·æ±‚æˆ–è€…å…¶ä»–é€”å¾„è·å–çš„å›¾ç‰‡æ•°æ®ä¼ é€’ç»™å®ƒæ—¶ï¼Œå®ƒä¼šå°†ç¼“å†²åŒºçš„æ•°æ®è§£ç æˆæ•°æ®å£°ç§°çš„æ ¼å¼ï¼ˆæ¯”å¦‚ PNG æˆ–è€… JPEGï¼‰ã€‚ ç„¶è€Œå®ƒå°±ä¼šåœ¨è¿™åœé¡¿äº†ã€‚ ç”±äºæ¸²æŸ“å¹¶éåªæ˜¯ä¸€æ¬¡æ€§æ“ä½œï¼Œ&lt;code>UIImage&lt;/code> ä¼šä¿ç•™è¿™ä¸ªæ•°æ®ç¼“å†²ï¼Œè¿™æ ·å®ƒåªéœ€è¦è§£ç ä¸€æ¬¡ã€‚&lt;/p>
&lt;p>æˆ‘ä»¬æ¥æ‰©å±•ä¸€ä¸‹è¿™ä¸ªæ¦‚å¿µ - å¯¹äºä»»ä½• iOS App æ¥è¯´ä¸€ä¸ªå®Œæ•´çš„ç¼“å†²åŒºå°±æ˜¯å…¶å¸§ç¼“å†²åŒºã€‚ è¿™å°±æ˜¯å½“ app å±•ç¤ºåœ¨å±å¹•ä¸Šæ—¶ï¼Œè´Ÿè´£æŒæœ‰è¾“å‡ºæ¸²æŸ“å†…å®¹çš„ä¸œè¥¿ã€‚ ä»»ä½• iOS è®¾å¤‡ä¸Šçš„æ˜¾ç¤ºç¡¬ä»¶ï¼Œéƒ½ä¼šä½¿ç”¨å…¶ä¸­çš„åƒç´ ä¿¡æ¯æ¥ç‚¹äº®å¯¹åº”çš„ç‰©ç†å±å¹•åƒç´ ã€‚&lt;/p>
&lt;p>æ­¤å¤„æ—¶é—´å¾ˆé‡è¦ã€‚ ä¸ºäº†è¾¾åˆ°æ¯ç§’ 60 å¸§å¦‚é»„æ²¹èˆ¬é¡ºæ»‘çš„æ»šåŠ¨æ•ˆæœï¼Œåœ¨ app çš„ window åŠå…¶ subviews æ”¹å˜çš„æ—¶å€™ï¼ˆæ¯”å¦‚åˆ†é…äº†ä¸€ä¸ª image ç»™ image viewï¼‰ï¼Œå¸§ç¼“å†²åŒºéœ€è¦ UIKit æ¥æ¸²æŸ“ã€‚ å¦‚æœæ¸²æŸ“æ…¢äº†ï¼Œå°±ä¼šæ‰å¸§ã€‚&lt;/p>
&lt;blockquote>
&lt;p>è§‰å¾—åªæœ‰ 1/60 ç§’å¤„ç†æ—¶é—´å¤ªçŸ­äº†? å…·å¤‡ Pro Motion çš„è®¾å¤‡åªä¼šç»™ 1/120 ç§’çš„æ—¶é—´ã€‚&lt;/p>
&lt;/blockquote>
&lt;h2 id="å¤§å°çœŸçš„å¾ˆé‡è¦">
å¤§å°çœŸçš„å¾ˆé‡è¦
&lt;a href="#%e5%a4%a7%e5%b0%8f%e7%9c%9f%e7%9a%84%e5%be%88%e9%87%8d%e8%a6%81" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h2>
&lt;p>æˆ‘ä»¬å…¶å®å¯ä»¥å¾ˆè½»æ¾åœ°è§‚å¯Ÿåˆ°è¿™æ­¥å¤„ç†ä»¥åŠå†…å­˜æ—¶å¦‚ä½•è¢«æ¶ˆè€—æ‰çš„ã€‚ æˆ‘åˆ›å»ºäº†ä¸€ä¸ªå®éªŒ appï¼Œç”¨ image view æ¥å±•ç¤ºäº†æˆ‘å¥³å„¿çš„ç…§ç‰‡ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">let&lt;/span> filePath = Bundle.main.path(forResource:&lt;span style="color:#e6db74">&amp;#34;baylor&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">ï¼Œ&lt;/span>ofType: &lt;span style="color:#e6db74">&amp;#34;jpg&amp;#34;&lt;/span>)&lt;span style="color:#f92672">!&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">let&lt;/span> url = NSURL(fileURLWithPath: filePath)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">let&lt;/span> fileImage = UIImage(contentsOfFile: filePath)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// Image view&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">let&lt;/span> imageView = UIImageView(image: fileImage)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>imageView.translatesAutoresizingMaskIntoConstraints = &lt;span style="color:#66d9ef">false&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>imageView.contentMode = .scaleAspectFit
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>imageView.widthAnchor.constraint(equalToConstant: &lt;span style="color:#ae81ff">300&lt;/span>).isActive = &lt;span style="color:#66d9ef">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>imageView.heightAnchor.constraint(equalToConstant: &lt;span style="color:#ae81ff">400&lt;/span>).isActive = &lt;span style="color:#66d9ef">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>view.addSubview(imageView)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>imageView.centerXAnchor.constraint(equalTo: view.centerXAnchor).isActive = &lt;span style="color:#66d9ef">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>imageView.centerYAnchor.constraint(equalTo: view.centerYAnchor).isActive = &lt;span style="color:#66d9ef">true&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;p>è¿™é‡Œæˆ‘ä»¬åªæ˜¯ä¸ºäº†æ¼”ç¤ºåœºæ™¯ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¯·è°¨æ…ä½¿ç”¨å¼ºåˆ¶è§£åŒ…ã€‚&lt;/p>
&lt;/blockquote>
&lt;p>ä¸Šé¢çš„ä»£ç è¿è¡Œèµ·æ¥æ—¶è¿™æ ·:&lt;/p>
&lt;p>&lt;img src="https://www.swiftjectivec.com/assets/images/baylorPhone.jpg" alt="Baylor">&lt;/p>
&lt;p>è™½ç„¶æˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªå°å¾—å¤šçš„ Image View æ¥å±•ç¤ºå›¾ç‰‡ï¼Œä½†é€šè¿‡ LLDB æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹åˆ°å›¾ç‰‡å®é™…çš„å°ºå¯¸ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&amp;lt;UIImage: &lt;span style="color:#ae81ff">0x600003d41a40&lt;/span>&amp;gt;&lt;span style="color:#960050;background-color:#1e0010">ï¼Œ&lt;/span>{&lt;span style="color:#ae81ff">1718&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">ï¼Œ&lt;/span>&lt;span style="color:#ae81ff">2048&lt;/span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è®°ä½ï¼Œè¿™æ˜¯ç‚¹è¡¨ç¤ºã€‚ æ‰€ä»¥å¦‚æœæˆ‘ä½¿ç”¨çš„æ˜¯ 3x æˆ–è€… 2x è®¾å¤‡ï¼Œè¿™ä¸ªæ•°å­—éœ€è¦æ›´å¤§ä¸€äº›ã€‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ vmmap æ¥ç¡®å®šè¿™å¼ å›¾ç‰‡æ˜¯å¦çœŸçš„å ç”¨äº† 14 MBã€‚&lt;/p>
&lt;pre tabindex="0">&lt;code>vmmap --summary baylor.memgraph
&lt;/code>&lt;/pre>&lt;p>æœ‰å‡ ä¸ªä¸œè¥¿å¼•èµ·äº†æ³¨æ„ï¼ˆä¸ºäº†ç®€æ´åªæˆªå‡ºäº†éƒ¨åˆ†è¾“å‡ºï¼‰:&lt;/p>
&lt;pre tabindex="0">&lt;code>Physical footprint: 69.5M
Physical footprint (peak): 69.7M
&lt;/code>&lt;/pre>&lt;p>æ¥è¿‘ 70 MB ç»™äº†æˆ‘ä»¬ä¸€ä¸ªå¾ˆå¥½çš„å‚è€ƒæ¥ç¡®å®šæˆ‘ä»¬çš„é‡æ„æ˜¯å¦æœ‰æ•ˆã€‚ å¦‚æœæˆ‘ä»¬é€šè¿‡ grep å‘½ä»¤æ¥ç­›é€‰ Image IOï¼Œæˆ‘ä»¬ä¹Ÿèƒ½å¤Ÿçœ‹åˆ°å›¾ç‰‡çš„å¼€é”€ã€‚&lt;/p>
&lt;pre tabindex="0">&lt;code>vmmap --summary baylor.memgraph | grep &amp;#34;Image IO&amp;#34;
Image IO 13.4M 13.4M 13.4M 0K 0K 0K 0K 2
&lt;/code>&lt;/pre>&lt;p>å•Šå“ˆ - è¿™é‡Œå°±æœ‰æ¥è¿‘ 14 MB çš„è„å†…å­˜ã€‚ å¦‚åŒæˆ‘ä»¬åœ¨é¤å·¾çº¸èƒŒé¢å†™ä¸‹çš„å…¬å¼è®¡ç®—çš„é‚£æ ·ã€‚ èƒŒæ™¯è¡¥å……ä¸€ä¸‹ï¼Œè¿™æ˜¯ä¸€ä¸ªç»ˆç«¯çš„å±å¹•æˆªå›¾ï¼Œæ¸…æ¥šåœ°æ˜¾ç¤ºäº†æ¯ä¸€åˆ—çš„å«ä¹‰ã€‚ ï¼ˆç”±äºä»–ä»¬è¢« grep å‘½ä»¤ç»™çœç•¥æ‰äº†ï¼‰&lt;/p>
&lt;p>&lt;img src="https://www.swiftjectivec.com/assets/images/vmmap.jpg" alt="">&lt;/p>
&lt;p>æ‰€ä»¥å¾ˆæ˜ç¡®äº†ï¼Œæ­¤åˆ»æˆ‘ä»¬åœ¨ 300 x 400 çš„ image view ä¸­ä¹Ÿä¾ç„¶ä»˜å‡ºäº†å›¾åƒçš„å®Œæ•´å¼€é”€ã€‚ å›¾åƒçš„å¤§å°æ˜¯å¾ˆå…³é”®ï¼Œä½†è¿™å¹¶ä¸æ˜¯å”¯ä¸€é‡è¦çš„ç‚¹ã€‚&lt;/p>
&lt;h2 id="è‰²åŸŸ">
è‰²åŸŸ
&lt;a href="#%e8%89%b2%e5%9f%9f" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h2>
&lt;p>ä½ æ‰€è¯·æ±‚çš„å†…å­˜æ¶ˆè€—æœ‰ä¸€éƒ¨åˆ†æºäºå¦ä¸€ä¸ªé‡è¦å› ç´  - è‰²åŸŸã€‚ åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­æˆ‘ä»¬åšäº†ä¸€ä¸ªå‡è®¾ï¼Œè€Œè¿™ä¸ªå‡è®¾å¹¶ä¸é€‚ç”¨äºå¤§å¤šæ•° iPhone - ä¹Ÿå°±æ˜¯å›¾åƒé‡‡ç”¨çš„æ˜¯ sRGB æ ¼å¼ã€‚ æ¯ä¸ªåƒç´  4 ä¸ªå­—èŠ‚å¯¹åº”çš„æ˜¯çº¢ï¼Œè“ï¼Œç»¿ä»¥åŠé€æ˜ã€‚&lt;/p>
&lt;p>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯æ”¯æŒå¹¿è‰²åŸŸæ ¼å¼çš„è®¾å¤‡ï¼ˆiPhone 8+ æˆ– iPhone Xï¼‰è¿›è¡Œæ‹æ‘„ï¼Œé‚£å°±å¯ä»¥è‚¯å®šæ•°å­—ä¼šåŠ å€äº†ã€‚ å½“ç„¶äº†ï¼Œåè¿‡æ¥ä¹Ÿä¸€æ ·ï¼ŒMetal æ”¯æŒä½¿ç”¨ Alpha 8 æ ¼å¼ï¼Œå°±åƒå…¶åå­—æè¿°çš„é‚£æ ·åªæœ‰å•ä¸€é€šé“ã€‚&lt;/p>
&lt;p>è¿™é‡Œæœ‰éå¸¸å¤šéœ€è¦è€ƒè™‘çš„ä¸œè¥¿ã€‚ è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä½ åº”è¯¥ä½¿ç”¨ &lt;a href="https://swiftjectivec.com/UIGraphicsImageRenderer">UIGraphicsImageRenderer&lt;/a> è€Œä¸æ˜¯ &lt;code>UIGraphicsBeginImageContextWithOptions&lt;/code>ã€‚ åè€…ä¼š&lt;strong>ä¸€ç›´&lt;/strong>ä½¿ç”¨ sRGBï¼Œè¿™ä¹Ÿæ„å‘³ç€ä½ ä¼šä¸¢å¤±å¹¿è‰²åŸŸæ ¼å¼ï¼Œå¦‚æœä½  &lt;a href="https://instagram-engineering.com/bringing-wide-color-to-instagram-5a5481802d7d">æƒ³è¦çš„è¯&lt;/a>ï¼Œæˆ–æ˜¯é”™å¤±èŠ‚çœå¼€é”€çš„æœºä¼šã€‚ åœ¨ iOS 12 ä¹‹åï¼Œ&lt;code>UIGraphicsImageRenderer&lt;/code> ä¼šè‡ªåŠ¨å¸®ä½ é€‰æ‹©æ­£ç¡®çš„æ–¹æ¡ˆã€‚&lt;/p>
&lt;p>æœ€ååˆ«å¿˜è®°äº†ï¼Œå¾ˆå¤šå›¾ç‰‡å¹¶ä¸æ˜¯æ‹æ‘„å‡ºæ¥çš„ï¼Œè€Œæ˜¯é€šè¿‡ç»˜å›¾ç»˜åˆ¶çš„ã€‚ è¿™é‡Œå¹¶ä¸æ˜¯åˆ»æ„é‡å¤æˆ‘å†™è¿‡çš„ä¸œè¥¿ï¼Œåªæ˜¯æ€•ä½ ä¹‹å‰é”™è¿‡äº†:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">let&lt;/span> circleSize = CGSize(width: &lt;span style="color:#ae81ff">60&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">ï¼Œ&lt;/span>height: &lt;span style="color:#ae81ff">60&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>UIGraphicsBeginImageContextWithOptions(circleSize&lt;span style="color:#960050;background-color:#1e0010">ï¼Œ&lt;/span>&lt;span style="color:#66d9ef">true&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">ï¼Œ&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// Draw a circle&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">let&lt;/span> ctx = UIGraphicsGetCurrentContext()&lt;span style="color:#f92672">!&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>UIColor.red.setFill()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ctx.setFillColor(UIColor.red.cgColor)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ctx.addEllipse(&lt;span style="color:#66d9ef">in&lt;/span>: CGRect(x: &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">ï¼Œ&lt;/span>y: &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">ï¼Œ&lt;/span>width: circleSize.width&lt;span style="color:#960050;background-color:#1e0010">ï¼Œ&lt;/span>height: circleSize.height))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>ctx.drawPath(using: .fill)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">let&lt;/span> circleImage = UIGraphicsGetImageFromCurrentImageContext()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>UIGraphicsEndImageContext()
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™ä¸ªåœ†å½¢å›¾ç‰‡ä½¿ç”¨çš„æ˜¯æ¯ä¸ªåƒç´  4 å­—èŠ‚æ ¼å¼ã€‚ å¦‚æœä½ ä½¿ç”¨ &lt;code>UIGraphicsImageRenderer&lt;/code> é‚£ä¹ˆæ¸²æŸ“å™¨ä¼šè‡ªåŠ¨é€‰æ‹©åˆé€‚çš„æ ¼å¼ï¼Œä¸ºæ¯ä¸ªåƒç´ èŠ‚çœ 75% çš„å†…å­˜æ¶ˆè€—ã€‚&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">let&lt;/span> circleSize = CGSize(width: &lt;span style="color:#ae81ff">60&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">ï¼Œ&lt;/span>height: &lt;span style="color:#ae81ff">60&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">let&lt;/span> renderer = UIGraphicsImageRenderer(bounds: CGRect(x: &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">ï¼Œ&lt;/span>y: &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">ï¼Œ&lt;/span>width: circleSize.width&lt;span style="color:#960050;background-color:#1e0010">ï¼Œ&lt;/span>height: circleSize.height))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">let&lt;/span> circleImage = renderer.image{ ctx &lt;span style="color:#66d9ef">in&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> UIColor.red.setFill()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ctx.cgContext.setFillColor(UIColor.red.cgColor)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ctx.cgContext.addEllipse(&lt;span style="color:#66d9ef">in&lt;/span>: CGRect(x: &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">ï¼Œ&lt;/span>y: &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">ï¼Œ&lt;/span>width: circleSize.width&lt;span style="color:#960050;background-color:#1e0010">ï¼Œ&lt;/span>height: circleSize.height))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ctx.cgContext.drawPath(using: .fill)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="ç¼©å°åˆ†è¾¨ç‡-vs-ç¼©å°é‡‡æ ·">
ç¼©å°åˆ†è¾¨ç‡ vs ç¼©å°é‡‡æ ·
&lt;a href="#%e7%bc%a9%e5%b0%8f%e5%88%86%e8%be%a8%e7%8e%87-vs-%e7%bc%a9%e5%b0%8f%e9%87%87%e6%a0%b7" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h2>
&lt;p>è®©æˆ‘ä»¬è·³è¿‡ç®€å•ç»˜å›¾çš„åœºæ™¯ - è¿˜æœ‰éå¸¸å¤šä¸å›¾åƒç›¸å…³çš„å†…å­˜é—®é¢˜ï¼Œæºè‡ªçœŸå®çš„æ‘„å½±å›¾ç‰‡ã€‚ æ¯”å¦‚äººåƒï¼Œé£æ™¯ç…§ã€‚&lt;/p>
&lt;p>å¯¹äºä¸€äº›å·¥ç¨‹å¸ˆæ¥è¯´ï¼Œä»–ä»¬æœ‰ç†ç”±ï¼ˆé€»è¾‘ä¸Šä¹Ÿè¯´å¾—è¿‡å»ï¼‰ç›¸ä¿¡ï¼Œé€šè¿‡ &lt;code>UIImage&lt;/code> ç®€å•åœ°ç¼©å°å›¾åƒå°ºå¯¸å°±è¶³å¤Ÿäº†ã€‚ ä½†ç”±äºä¸Šé¢æåŠçš„åŸå› ï¼Œè¿™é€šå¸¸æ¥è¯´ä¸å¤Ÿï¼Œè€Œä¸”æ® Apple å‘˜å·¥ Kyle Howarth æè¿°è¿™ä¹Ÿæ²¡æœ‰é‚£ä¹ˆé«˜æ•ˆã€‚&lt;/p>
&lt;p>å¦‚æˆ‘ä»¬ä¹‹å‰è®¨è®ºæ¸²æŸ“è·¯å¾„æ—¶æåˆ°çš„ï¼Œ&lt;code>UIImage&lt;/code> ä¼šäº§ç”Ÿå†…å­˜é—®é¢˜çš„ä¸»è¦åŸå› æ˜¯å®ƒä¼šå°†åŸå§‹å›¾åƒåŠ è½½åˆ°å†…å­˜ä¸­è¿›è¡Œè§£å‹ã€‚ ç†æƒ³çŠ¶æ€ä¸‹ï¼Œæˆ‘ä»¬åº”è¯¥å‡å°‘å›¾åƒç¼“å­˜åŒºçš„å¤§å°ã€‚&lt;/p>
&lt;p>å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å…¶å®å¯ä»¥åªä»¥è°ƒæ•´å›¾åƒæ–‡ä»¶çš„å¤§å°ä¸ºä»£ä»·ï¼Œæ¥å½±å“å›¾åƒå†…å­˜å¤§å°ã€‚ é€šå¸¸äººä»¬ä¼šå‡è®¾è¿™å°±æ˜¯ç³»ç»Ÿå¦‚ä½•å®ç°çš„ï¼Œä½†å…¶å®ä¸æ˜¯ã€‚&lt;/p>
&lt;p>è®©æˆ‘ä»¬ç”¨ç‚¹åº•å±‚ API æ¥ç¼©å°é‡‡æ ·è¯•è¯•:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">let&lt;/span> imageSource = CGImageSourceCreateWithURL(url&lt;span style="color:#960050;background-color:#1e0010">ï¼Œ&lt;/span>&lt;span style="color:#66d9ef">nil&lt;/span>)&lt;span style="color:#f92672">!&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">let&lt;/span> options: [NSString:Any] = [kCGImageSourceThumbnailMaxPixelSize:&lt;span style="color:#ae81ff">400&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">ï¼Œ&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> kCGImageSourceCreateThumbnailFromImageAlways:&lt;span style="color:#66d9ef">true&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">if&lt;/span> &lt;span style="color:#66d9ef">let&lt;/span> scaledImage = CGImageSourceCreateThumbnailAtIndex(imageSource&lt;span style="color:#960050;background-color:#1e0010">ï¼Œ&lt;/span>&lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">ï¼Œ&lt;/span>options &lt;span style="color:#66d9ef">as&lt;/span> CFDictionary) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> imageView = UIImageView(image: UIImage(cgImage: scaledImage))
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> imageView.translatesAutoresizingMaskIntoConstraints = &lt;span style="color:#66d9ef">false&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> imageView.contentMode = .scaleAspectFit
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> imageView.widthAnchor.constraint(equalToConstant: &lt;span style="color:#ae81ff">300&lt;/span>).isActive = &lt;span style="color:#66d9ef">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> imageView.heightAnchor.constraint(equalToConstant: &lt;span style="color:#ae81ff">400&lt;/span>).isActive = &lt;span style="color:#66d9ef">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> view.addSubview(imageView)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> imageView.centerXAnchor.constraint(equalTo: view.centerXAnchor).isActive = &lt;span style="color:#66d9ef">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> imageView.centerYAnchor.constraint(equalTo: view.centerYAnchor).isActive = &lt;span style="color:#66d9ef">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>å†æ¬¡è¿è¡Œï¼Œæˆ‘ä»¬å¾—åˆ°çš„æ˜¾ç¤ºæ•ˆæœå’Œä¹‹å‰ä¸€æ ·ã€‚ ä½†åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨äº† &lt;code>CGImageSourceCreateThumbnailAtIndex()&lt;/code> è€Œä¸æ˜¯ç›´æ¥å°†åŸå§‹å›¾åƒæ”¾åœ¨ image view ä¸­ã€‚ çœŸç›¸å¤§ç™½çš„æ—¶åˆ»åˆ°äº†ï¼Œè®©æˆ‘ä»¬é€šè¿‡ &lt;code>vmmap&lt;/code> æ¥çœ‹çœ‹æˆ‘ä»¬çš„ä¼˜åŒ–æ˜¯å¦å¥æ•ˆï¼ˆå†ä¸€æ¬¡ï¼Œä¸ºäº†ç®€æ´åªæˆªå–äº†éƒ¨åˆ†ï¼‰:&lt;/p>
&lt;pre tabindex="0">&lt;code>vmmap -summary baylorOptimized.memgraph
Physical footprint: 56.3M
Physical footprint (peak): 56.7M
&lt;/code>&lt;/pre>&lt;p>èŠ‚çœçš„å¼€é”€éƒ½ç»Ÿè®¡åœ¨äº†ä¸€èµ·ã€‚ å¦‚æœæˆ‘ä»¬å°†ä¹‹å‰çš„ 69.5M å’Œç°åœ¨çš„ 56.3M è¿›è¡Œå¯¹æ¯”ï¼Œæˆ‘ä»¬èŠ‚çº¦äº† 13.2Mã€‚ è¿™æ˜¯ä¸ªå¾ˆå¤§çš„èŠ‚çœï¼Œå‡ ä¹æ˜¯æ•´ä¸ªå›¾ç‰‡çš„å¤§å°ã€‚&lt;/p>
&lt;p>å†è¿›ä¸€æ­¥ï¼Œä½ å¯ä»¥æ ¹æ®ä½ çš„éœ€è¦é€šè¿‡å„ç§é€‰é¡¹æ¥æ‰“ç£¨ã€‚ åœ¨ WWDC 2018 Session 219 &amp;ldquo;Images and Graphics Best Practices&amp;rdquo; ä¸­ï¼ŒApple å·¥ç¨‹å¸ˆ Kyle Sluder é€šè¿‡ä½¿ç”¨ &lt;code>kCGImageSourceShouldCacheImmediately&lt;/code> æ ‡è®°æ¥å±•ç¤ºäº†ä¸€ä¸ªå¾ˆæœ‰è¶£çš„æŠ€å·§æ§åˆ¶è§£ç :&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">func&lt;/span> &lt;span style="color:#a6e22e">downsampleImage&lt;/span>(at URL:NSURL&lt;span style="color:#960050;background-color:#1e0010">ï¼Œ&lt;/span>maxSize:Float) -&amp;gt; UIImage
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> sourceOptions = [kCGImageSourceShouldCache:&lt;span style="color:#66d9ef">false&lt;/span>] &lt;span style="color:#66d9ef">as&lt;/span> CFDictionary
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> source = CGImageSourceCreateWithURL(URL &lt;span style="color:#66d9ef">as&lt;/span> CFURL&lt;span style="color:#960050;background-color:#1e0010">ï¼Œ&lt;/span>sourceOptions)&lt;span style="color:#f92672">!&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> downsampleOptions = [kCGImageSourceCreateThumbnailFromImageAlways:&lt;span style="color:#66d9ef">true&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">ï¼Œ&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> kCGImageSourceThumbnailMaxPixelSize:maxSize
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> kCGImageSourceShouldCacheImmediately:&lt;span style="color:#66d9ef">true&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">ï¼Œ&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> kCGImageSourceCreateThumbnailWithTransform:&lt;span style="color:#66d9ef">true&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">ï¼Œ&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ] &lt;span style="color:#66d9ef">as&lt;/span> CFDictionary
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">let&lt;/span> downsampledImage = CGImageSourceCreateThumbnailAtIndex(source, &lt;span style="color:#ae81ff">0&lt;/span>, downsampleOptions)&lt;span style="color:#f92672">!&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">return&lt;/span> UIImage(cgImage: downsampledImage)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Core Graphics å¹¶ä¸ä¼šå‚ä¸è§£ç å›¾ç‰‡ï¼Œç›´åˆ°ä½ æ˜ç¡®éœ€è¦ä½¿ç”¨ç¼©ç•¥å›¾çš„æ—¶å€™ã€‚ å¹¶ä¸”éœ€è¦æ³¨æ„ä¼ å…¥ &lt;code>kCGImageSourceCreateThumbnailMaxPixelSize&lt;/code>ï¼Œå°±åƒæˆ‘ä»¬åšçš„ä¸Šé¢ä¸¤ä¸ªä¾‹å­é‚£æ ·ã€‚ å¦‚æœä½ ä¸ä¼ ï¼Œé‚£ä¹ˆä½ ä¼šå¾—åˆ°ä¸€ä¸ªå’ŒåŸå§‹å›¾åƒä¸€æ ·å¤§å°çš„ç¼©ç•¥å›¾ã€‚ æ®æ–‡æ¡£æè¿°:&lt;/p>
&lt;blockquote>
&lt;p>â€œâ€¦å¦‚æœæ²¡æœ‰æŒ‡å®šæœ€å¤§åƒç´ å¤§å°ï¼Œé‚£ä¹ˆç¼©ç•¥å›¾å°±ä¼šæ˜¯å®Œæ•´çš„å›¾ç‰‡å¤§å°ï¼Œè¿™å¯èƒ½ä¸æ˜¯ä½ æƒ³è¦çš„ã€‚â€
â€œâ€¦if a maximum pixel size isnâ€™t specified, then the thumbnail will be the size of the full image, which probably isnâ€™t what you want.â€&lt;/p>
&lt;/blockquote>
&lt;p>é‚£ä¹ˆè¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆ? ç®€å•æ¥è¯´ï¼Œæˆ‘ä»¬é€šè¿‡åœ¨ç¼©ç•¥å›¾ä¸Šä½¿ç”¨äº†ç¼©å°éƒ¨åˆ†å›¾ç‰‡çš„ç­‰å¼ï¼Œåˆ›å»ºäº†ä¸€ä¸ªå°å¾—å¤šçš„è§£ç å›¾åƒç¼“å†²åŒºã€‚ å›å¿†ä¸€ä¸‹ä¹‹å‰æåˆ°çš„æ¸²æŸ“è·¯å¾„ï¼Œç¬¬ä¸€æ­¥ï¼ˆåŠ è½½ï¼‰ç°åœ¨æˆ‘ä»¬æ²¡æœ‰åˆ›å»ºä¸€ä¸ªåŸå§‹å›¾åƒå¤§å°çš„ç¼“å†²åŒºï¼Œè€Œæ˜¯ä¸€ä¸ª image view æ˜¾ç¤ºå¤§å°çš„ç¼“å†²åŒºã€‚&lt;/p>
&lt;p>æƒ³è¦ä¸€ä¸ªè¿™ç¯‡æ–‡ç« çš„å¤ªé•¿ä¸è¯»ç‰ˆæœ¬? æ‰¾æœºä¼šé™ä½å›¾åƒé‡‡æ ·ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ &lt;code>UIImage&lt;/code> ç¼©å°å›¾ç‰‡ã€‚&lt;/p>
&lt;h2 id="é™„åŠ éƒ¨åˆ†">
é™„åŠ éƒ¨åˆ†
&lt;a href="#%e9%99%84%e5%8a%a0%e9%83%a8%e5%88%86" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h2>
&lt;p>æˆ‘ä¸ªäººåœ¨ Tandem ä¸­é…åˆç€ &lt;a href="https://developer.apple.com/documentation/uikit/uitableviewdatasourceprefetching?language=swift">prefetch API&lt;/a> ï¼ˆiOS 11ï¼‰ ä½¿ç”¨äº†è¿™ç§æŠ€æœ¯ã€‚ ä½†è¦è®°ä½å³ä½¿æˆ‘ä»¬åœ¨çœŸæ­£ä½¿ç”¨ table view æˆ–è€… collection view ä¹‹å‰è¿™æ ·åšï¼Œæˆ‘ä»¬åœ¨è§£ç å›¾ç‰‡çš„æ—¶å€™ï¼Œå†…éƒ¨ä¾ç„¶ä¼šå¸¦æ¥çš„ä¸€ä¸ª CPU ä½¿ç”¨é‡çš„é«˜å³°ã€‚&lt;/p>
&lt;p>å°½ç®¡ iOS åœ¨é¢å¯¹æŒç»­æ€§èƒ½æ¶ˆè€—æ—¶æœ‰å¾ˆé«˜æ•ˆçš„å¤„ç†æ–¹æ¡ˆï¼Œä½†åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå¯èƒ½æ˜¯æ—¶ä¸æ—¶æ‰ä¼šäº§ç”Ÿè¿™æ ·çš„é«˜å³°ã€‚ æ‰€ä»¥åœ¨å¤„ç†è¿™ç§é—®é¢˜çš„æ—¶å€™ï¼Œæœ€å¥½æŠŠå¸Œæœ›å¯„äºˆä½ è‡ªå·±åˆ›å»ºçš„é˜Ÿåˆ—ã€‚ å¦ä¸€ä¸ªä¼˜åŠ¿æ˜¯ï¼Œè¿™æ ·è¿˜èƒ½å°†è§£ç ç§»åŠ¨åˆ°åå°å¤„ç†ã€‚&lt;/p>
&lt;p>å¿«é®ä½çœ¼ç›ï¼Œæˆ‘ä¸šä½™é¡¹ç›®ä¸­çš„ Objective-C ä»£ç è¦å‡ºæ¥äº†:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-objc" data-lang="objc">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">// ç”¨ä½ è‡ªå·±çš„é˜Ÿåˆ—è€Œä¸æ˜¯ global é˜Ÿåˆ—å¯ä»¥é¿å…æ½œåœ¨çš„çº¿ç¨‹çˆ†ç‚¸
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- (&lt;span style="color:#66d9ef">void&lt;/span>)&lt;span style="color:#a6e22e">tableView:&lt;/span>(UITableView &lt;span style="color:#f92672">*&lt;/span>)tableView &lt;span style="color:#a6e22e">prefetchRowsAtIndexPaths:&lt;/span>(NSArray&lt;span style="color:#f92672">&amp;lt;&lt;/span>NSIndexPath &lt;span style="color:#f92672">*&amp;gt;&lt;/span> &lt;span style="color:#f92672">*&lt;/span>)indexPaths
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> (self.downsampledImage &lt;span style="color:#f92672">!=&lt;/span> nil &lt;span style="color:#f92672">||&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> self.listItem.mediaAssetData &lt;span style="color:#f92672">==&lt;/span> nil) &lt;span style="color:#66d9ef">return&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> NSIndexPath &lt;span style="color:#f92672">*&lt;/span>mediaIndexPath &lt;span style="color:#f92672">=&lt;/span> [NSIndexPath indexPathForRow:&lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> inSection:SECTION_MEDIA];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">if&lt;/span> ([indexPaths containsObject:mediaIndexPath])
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> CGFloat scale &lt;span style="color:#f92672">=&lt;/span> tableView.traitCollection.displayScale;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> CGFloat maxPixelSize &lt;span style="color:#f92672">=&lt;/span> (tableView.width &lt;span style="color:#f92672">-&lt;/span> SSSpacingJumboMargin) &lt;span style="color:#f92672">*&lt;/span> scale;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> dispatch_async(self.downsampleQueue&lt;span style="color:#960050;background-color:#1e0010">ï¼Œ&lt;/span>&lt;span style="color:#f92672">^&lt;/span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#75715e">// ç¼©å‡é‡‡æ ·
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span> self.downsampledImage &lt;span style="color:#f92672">=&lt;/span> [UIImage downsampledImageFromData:self.listItem.mediaAssetData
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> scale:scale
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> maxPixelSize:maxPixelSize];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> dispatch_async(dispatch_get_main_queue()&lt;span style="color:#960050;background-color:#1e0010">ï¼Œ&lt;/span>&lt;span style="color:#f92672">^&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> self.listItem.downsampledMediaImage &lt;span style="color:#f92672">=&lt;/span> self.downsampledImage;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;p>æ³¨æ„åœ¨ä½ æœ‰å¤§é‡çš„åŸå§‹å›¾åƒï¼ˆraw imageï¼‰èµ„æºæ—¶ä½¿ç”¨èµ„æºç®¡ç†ï¼ˆasset catalogsï¼‰ã€‚
å› ä¸ºå®ƒä¼šå¸®ä½ ç®¡ç†ç¼“å­˜å¤§å°ï¼ˆè¿˜æœ‰å…¶ä»–å¾ˆå¤šçš„ä¼˜åŠ¿ï¼‰&lt;/p>
&lt;/blockquote>
&lt;p>æƒ³è¦äº†è§£æ›´å¤šå…³äºå›¾åƒå’Œå†…å­˜ç®¡ç†çš„ä¿¡æ¯ï¼Œå¯ä»¥å…³æ³¨è¿™äº›ä¿¡æ¯é‡å·¨å¤§çš„ WWDC 18 session:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://developer.apple.com/videos/play/wwdc2018/416/?time=1074">iOS Memory Deep Dive&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developer.apple.com/videos/play/wwdc2018/219/">Images and Graphics Best Practices&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="æ€»ç»“ä¸€ä¸‹">
æ€»ç»“ä¸€ä¸‹
&lt;a href="#%e6%80%bb%e7%bb%93%e4%b8%80%e4%b8%8b" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h2>
&lt;p>ä½ æ— æ³•å¯Ÿè§‰ä½ ä¸çŸ¥é“çš„ä¸œè¥¿ã€‚ å°±ç¼–ç¨‹æ¥è¯´ï¼Œä½ åŸºæœ¬ä¸Šç›¸å½“äºæŠ¥åå‚åŠ äº†ä¸€ä¸ªéœ€è¦æŒç»­è·‘æ¯å°æ—¶ 10ï¼Œ000 ç±³ä»¥è·Ÿä¸Šåˆ›æ–°å’Œå˜é©çš„èŒä¸šç”Ÿæ¶¯ã€‚ è¿™æ„å‘³ç€&amp;hellip;æœ‰å¤§é‡çš„ APIï¼Œæ¡†æ¶ï¼Œè®¾è®¡æ¨¡å¼æˆ–è€…ä¼˜åŒ–æ–¹æ¡ˆä½ å¹¶ä¸çŸ¥æ™“ã€‚&lt;/p>
&lt;p>åœ¨å›¾åƒé¢†åŸŸå°¤å…¶æ˜¯è¿™æ ·ã€‚ å¤§å¤šæ•°æ—¶é—´ï¼Œä½ å¯èƒ½åªæ˜¯åˆå§‹åŒ–äº†ä¸€ä¸ª &lt;code>UIImageView&lt;/code> ç„¶åæ”¾è¿›äº†ä¸€äº›å¥½çœ‹çš„åƒç´ ï¼Œå°±è¿‡äº†ã€‚ æˆ‘çŸ¥é“å•¦ï¼Œæ‘©å°”å®šç†ä»€ä¹ˆçš„ã€‚ ç°åœ¨è¿™äº›ç”µè¯è¿è¡Œé€Ÿåº¦å¾ˆå¿«ï¼Œè€Œä¸”æœ‰æ•° G çš„å†…å­˜ï¼Œå¹¶ä¸”æˆ‘ä»¬æŠŠäººç±»è¿é€åˆ°äº†æœˆçƒä¸Šï¼Œéƒ½åªç”¨äº†ä¸€å°ä¸åˆ° 100K å†…å­˜çš„ç”µè„‘ã€‚&lt;/p>
&lt;p>ä½†æ˜¯å’Œé­”é¬¼å…±èˆä¸ä¼šé•¿ä¹…ï¼Œä»–å¿…ç„¶éœ€è¦æ»‹å…»ä»–çš„è§’ã€‚ åˆ«è®©ç³»ç»Ÿæ€æ‰ä½ çš„åº”ç”¨ï¼Œåªæ˜¯å› ä¸ºä½ ç”¨äº† 1G å†…å­˜æ¥å±•ç¤ºä¸€å¼ è‡ªæ‹ç…§ã€‚ ä½†æ„¿è¿™äº›çŸ¥è¯†å’ŒæŠ€å·§å¯ä»¥å°†ä½ æ‹¯æ•‘äºå´©æºƒæ—¥å¿—ã€‚&lt;/p>
&lt;p>ä¸‹æ¬¡è§ âœŒï¸ã€‚&lt;/p></description></item><item><title>Platforms State of the Union(WWDC 2019)</title><link>https://joeytat.github.io/posts/wwdc2019_platforms_state_of_the_union/</link><pubDate>Wed, 05 Jun 2019 00:00:00 +0000</pubDate><guid>https://joeytat.github.io/posts/wwdc2019_platforms_state_of_the_union/</guid><description>
&lt;h2 id="swiftui">
SwiftUI
&lt;a href="#swiftui" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h2>
&lt;p>åœ¨ View å±‚çº§æä¾›äº†å››ç§ç‰¹æ€§:&lt;/p>
&lt;ul>
&lt;li>
&lt;p>Declarative
é€šè¿‡å£°æ˜å¼çš„è¯­å¥æ¥æè¿° UI å¸ƒå±€, æ ·å¼, åŠ¨ç”»ç­‰.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Automatic
å¯äº¤äº’å½¢åŠ¨ç”», åŠ¨æ€å­—å·, å¤œé—´æ¨¡å¼éƒ½å¯ä»¥é€šè¿‡é…ç½®æ¥è½»æ¾å®ç°.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Compositional
ç»„åˆæ€§. å„ç§æ§ä»¶éƒ½èƒ½æå…¶æ–¹ä¾¿åœ°ç»„åˆåœ¨ä¸€èµ·, è¿œæ¯” &lt;code>UIStackView&lt;/code> æ–¹ä¾¿.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-swift" data-lang="swift">&lt;span style="display:flex;">&lt;span>VStack(alignment: .leading) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Text(item.title)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Text(item.subtitle)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>Consistent
è‡ªå¸¦ Reactive ç‰¹æ€§. å°† Model å¯¹è±¡ç»§æ‰¿è‡ª &lt;code>BindableObject&lt;/code>, å¹¶ä¸”å£°æ˜å±æ€§ä¸º &lt;code>@State&lt;/code> å³å¯è·å¾—å½“å±æ€§æ”¹å˜æ—¶, UI æ§ä»¶è‡ªåŠ¨æ›´æ–°çš„æ•ˆæœ.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>çœŸçš„å¦‚æœå¦‚æ­¤ç¾å¥½, è¶…çº§åƒæ€§èƒ½çš„ xib å’Œ storyboard æ˜¯ä¸æ˜¯å¯ä»¥é€€å‡ºèˆå°äº†.&lt;/p>
&lt;h2 id="xcode-11">
Xcode 11
&lt;a href="#xcode-11" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>Live Development
ç›´æ¥åœ¨ Xcode Preview ä¸­æ‹–åŠ¨æ§ä»¶å³å¯ç”Ÿæˆå¯¹åº”çš„ SwiftUI ä»£ç . å¯¹åº”çš„ä¿®æ”¹ SwiftUI ä»£ç ä¹Ÿèƒ½å®æ—¶åœ¨ Preview ä¸­å“åº”.&lt;/p>
&lt;p>Preview è¿˜èƒ½é€šè¿‡æä¾›ä¸€ä¸ª &lt;code>PreviewProvider&lt;/code> æ¥ä¸ºå…¶æä¾›æ•°æ®å¡«å……å±•ç¤º, æ ·å¼æ›´æ”¹ç”šè‡³å¾ªç¯è¯­å¥æ¥ç”Ÿæˆå¤šä¸ª Preview åŒæ—¶æŸ¥çœ‹æ§ä»¶åœ¨å¤œé—´æ¨¡å¼å’Œç™½æ—¥æ¨¡å¼ä¸‹ä¸åŒçš„æ•ˆæœ.&lt;/p>
&lt;p>Preview éƒ¨ç½²åœ¨è®¾å¤‡ä¸Šä¹Ÿèƒ½çƒ­åŠ è½½.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Package Management
Swift ç»ˆäºæœ‰è‡ªå·±çš„ Package manage äº†. å¹¶ä¸”å’Œ Xcode è¿›è¡Œäº†æ·±åº¦æ•´åˆ.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Minimap
ä»£ç åœ¨å³ä¾§ä¼šå‘ˆç°ç±»ä¼¼ ctrl+6 çš„ç¼©ç•¥å›¾.
å¦‚æœä»£ç ä¸­å†™äº† &lt;code>// MARK: -&lt;/code> &lt;code>// TODO: -&lt;/code> ç­‰æ ‡è®°, ä¼šæ›´æ¸…æ™°åœ°æ˜¾ç¤ºå‡ºæ¥. æŒ‰ä½ cmd ä¼šæ˜¾ç¤ºæ‰€æœ‰çš„æ ‡è®°.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç‰ˆæœ¬ç®¡ç†
å¯ä»¥ç›´æ¥åœ¨ä¿®æ”¹ä»£ç çš„ä½ç½®æŸ¥çœ‹åˆ°åŸæ¥çš„ç‰ˆæœ¬.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Test Plan
åŒæ—¶æµ‹è¯•å„ç§å¹³å°å„ç§è®¾å¤‡.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="è·¨å¹³å°æ–¹æ¡ˆ">
è·¨å¹³å°æ–¹æ¡ˆ
&lt;a href="#%e8%b7%a8%e5%b9%b3%e5%8f%b0%e6%96%b9%e6%a1%88" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h2>
&lt;p>SwiftUI æ”¯æŒè·¨å¹³å°, åŒæ—¶æ”¯æŒ iOS, macOS, iPadOS. é‚£å¦‚ä½•åœ¨ iOS App çš„åŸºç¡€ä¸Šåˆ›å»ºä¸€ä¸ª macOS App å‘¢? åªéœ€è¦ä¸‰ä¸ªæ­¥éª¤:&lt;/p>
&lt;ol>
&lt;li>å‹¾é€‰ä¸Š deployment ä¸­çš„ âœ… mac&lt;/li>
&lt;li>åŒæ—¶å‹¾é€‰ä¸Š âœ… iPad, ä¸€ä¸ªå¥½çš„ iPad app, å°±æ˜¯ä¸€ä¸ªå¥½çš„ macOS app&lt;/li>
&lt;li>é’ˆå¯¹ macOS çš„èœå•, å¿«æ·é”®ç­‰å…·æœ‰å¹³å°ç‰¹æ®Šæ€§è´¨çš„æ“ä½œè¿›è¡Œä¸€äº›å•ç‹¬é€‚é….&lt;/li>
&lt;/ol>
&lt;p>è¿˜å¯¹ catalina çš„ä¸€äº›ç³»ç»Ÿä¿®æ”¹è¿›è¡Œäº†ä»‹ç», æ¯”å¦‚å„ç§èµ„æºæƒé™çš„æ”¶ç´§, å¹¶ä¸”æ–‡ä»¶èµ„æºæƒé™åˆ†æˆäº†ä¸¤éƒ¨åˆ†, ç³»ç»Ÿæ–‡ä»¶å¯¹äºä¸‰æ–¹ app å˜æˆäº†åªè¯».&lt;/p>
&lt;blockquote>
&lt;p>åé¢éƒ½æ˜¯å„å¹³å°ç³»ç»Ÿæˆ–æ–°åŠŸèƒ½çš„ä»‹ç», è¿˜æ˜¯ä¸ç»§ç»­æ–½å·¥äº†.&lt;/p>
&lt;/blockquote></description></item><item><title>å¦‚ä½•å®ç° JavaScript å‡½æ•°å‚æ•°å¿…å¡«çš„æ”¯æŒ?</title><link>https://joeytat.github.io/posts/js_required_property/</link><pubDate>Mon, 03 Jun 2019 00:00:00 +0000</pubDate><guid>https://joeytat.github.io/posts/js_required_property/</guid><description>
&lt;p>JS åœ¨ ES6 çš„ä¸­æ–°å¢äº†å‡½æ•°å‚æ•°æŒ‡å®šé»˜è®¤å€¼çš„æ”¯æŒ:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">Greeting&lt;/span> &lt;span style="color:#f92672">=&lt;/span> (&lt;span style="color:#a6e22e">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;Joeytat&amp;#34;&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#e6db74">`Hello &lt;/span>&lt;span style="color:#e6db74">${&lt;/span>&lt;span style="color:#a6e22e">name&lt;/span>&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">`&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">Greeting&lt;/span>() &lt;span style="color:#75715e">// Hello Joeytat
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>é‚£æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‰¹æ€§, å°†ä¸€ä¸ªä¼šæŠ›å‡ºå¼‚å¸¸çš„æ–¹æ³•ä½œä¸ºé»˜è®¤å‚æ•°ä¼ é€’.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-js" data-lang="js">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">Greeting&lt;/span> &lt;span style="color:#f92672">=&lt;/span> (&lt;span style="color:#a6e22e">name&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#a6e22e">EmptyPropertyException&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;name&amp;#34;&lt;/span>)) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">console&lt;/span>.&lt;span style="color:#a6e22e">log&lt;/span>(&lt;span style="color:#e6db74">`Hello &lt;/span>&lt;span style="color:#e6db74">${&lt;/span>&lt;span style="color:#a6e22e">name&lt;/span>&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">`&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">const&lt;/span> &lt;span style="color:#a6e22e">EmptyPropertyException&lt;/span> &lt;span style="color:#f92672">=&lt;/span> (&lt;span style="color:#a6e22e">propertyName&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">throw&lt;/span> Error(&lt;span style="color:#e6db74">`&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>&lt;span style="color:#a6e22e">propertyName&lt;/span>&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74"> ä¸ºå¿…å¡«å‚æ•°`&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">Greeting&lt;/span>() &lt;span style="color:#75715e">// æŠ›å‡ºå¼‚å¸¸: &amp;#34;Error: name ä¸ºå¿…å¡«å‚æ•°&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>è¿™æ ·å¦‚æœæ²¡æœ‰ä¼ é€’å‚æ•°å°±ä¼šæŠ›å‡ºå¼‚å¸¸, å¹¶ä¸”å¸¦æœ‰å‹å¥½çš„æç¤ºäº†.&lt;/p></description></item><item><title>2018</title><link>https://joeytat.github.io/posts/2018_overview/</link><pubDate>Fri, 28 Dec 2018 00:00:00 +0000</pubDate><guid>https://joeytat.github.io/posts/2018_overview/</guid><description>
&lt;p>åˆšæ¯•ä¸šé‚£é˜µå„¿è¿˜æ¯å¹´éƒ½å†™å¥½é•¿çš„æ€»ç»“, ç„¶åè¿™ä¸¤å¹´å˜æ‡’äº†. ä»Šå¹´åˆæƒ³å†è®°å½•ä¸€ä¸‹äº†å˜¿ | á•)â¾â¾&lt;/p>
&lt;ul>
&lt;li>
&lt;p>å¹´åº¦ App: &lt;a href="https://www.duolingo.com">å¤šé‚»å›½&lt;/a>&lt;/p>
&lt;p>é›¶åŸºç¡€å­¦è¯­è¨€çš„æ„Ÿè§‰å¾ˆä¸é”™.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¹´åº¦ç”µå½±: &lt;a href="https://movie.douban.com/subject/26611804/">ã€Šä¸‰å—å¹¿å‘Šç‰Œã€‹&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¹´åº¦æ¼«ç”»: &lt;a href="https://zh.wikipedia.org/wiki/%E5%8F%AA%E6%9C%89%E6%88%91%E4%B8%8D%E5%AD%98%E5%9C%A8%E7%9A%84%E5%9F%8E%E5%B8%82">ã€Šåªæœ‰æˆ‘ä¸å­˜åœ¨çš„åŸå¸‚ã€‹&lt;/a>&lt;/p>
&lt;p>å¿˜äº†åœ¨å“ªè¢«äººæ¨èçš„äº†, è¢«å®‰åˆ©åˆ°çš„è¯å¤§æ¦‚æ˜¯è¿™ä¹ˆè¯´çš„ã€Œéå¸¸åº†å¹¸åœ¨æ²¡æœ‰è¢«å‰§é€çš„æƒ…å†µä¸‹ä¸€å£æ°”çœ‹å®Œäº†ã€. çœ‹å®Œäº†ä¹‹åæ„Ÿè§‰æœç„¶å¦‚æ­¤. è€Œä¸”æ¼«ç”»çœŸæ˜¯å­˜åœ¨ç€åŠ¨ç”»æ— æ³•è¡¨ç°å‡ºçš„èŠ‚å¥æ„Ÿå•Š.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¹´åº¦æ¸¸æˆ: &lt;a href="https://zh.wikipedia.org/wiki/%E7%A5%9E%E7%95%8C%EF%BC%9A%E5%8E%9F%E7%BD%AA2">ã€Šç¥ç•ŒåŸç½ª 2ã€‹&lt;/a>&lt;/p>
&lt;p>æ¥è§¦çš„ç¬¬ä¸€æ¬¾ CRPG, æœ‰è¶£åˆ°ä»€ä¹ˆç¨‹åº¦å‘¢? ä»æ¸¸æˆä½“éªŒæ—¶å‘å‡ºã€Œwow, å±…ç„¶è¿˜èƒ½è¿™æ ·?ã€çš„é¢‘ç‡æ¥çœ‹, å’Œã€Šå¡å°”è¾¾: æ—·é‡ä¹‹æ¯ã€‹å·®ä¸å¤šå§.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¹´åº¦è™šæ„ç±»å›¾ä¹¦: ã€Šå‰‘æ¥ã€‹&lt;/p>
&lt;p>ä¸çŸ¥é“ä¸ºå•¥ç°åœ¨æèµ·ç½‘ç»œæ–‡å­¦, å¤šæ•°æ—¶å€™å¯¹æ–¹éƒ½è¿˜æ˜¯è§‰å¾—ã€Œæ ¼ã€ä¸å¤Ÿ. å¯ç°åœ¨çš„ç½‘ç»œå°è¯´ä¸ã€Šæ˜æŠ¥ã€‹è¿è½½çš„æ­¦ä¾ å°è¯´, æœ‰å¤šå¤§çš„åŒºåˆ«?&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¹´åº¦éè™šæ„ç±»å›¾ä¹¦: &lt;a href="https://book.douban.com/subject/27091742/">ã€Šé‚»äººä¹‹å¦»ã€‹&lt;/a>&lt;/p>
&lt;p>æˆ‘å§“ç‹å’Œæˆ‘çœ‹è¿™æœ¬ä¹¦æ²¡æœ‰ä»»ä½•è”ç³»(è®¤çœŸè„¸), çœŸçš„æ˜¯å¥½å¥‡æ€§ç¾å›½è§£æ”¾è¿åŠ¨åˆ°åº•æ˜¯æ€ä¹ˆäº§ç”Ÿçš„è€Œçœ‹çš„.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¹´åº¦ç”µå™¨: Sony 9000E ç”µè§†&lt;/p>
&lt;p>å¤§å±å¹• 4k HDR çš„å…¨æ–°ä½“éªŒè®©æˆ‘æƒ³æŠŠä¹‹å‰åœ¨æ˜¾ç¤ºå™¨ä¸Šç©çš„å¥½æ¸¸æˆçœ‹çš„å¥½ç”µå½±éƒ½é‡æ–°æ¥ä¸€æ¬¡.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¹´åº¦éŸ³ä¹: &lt;a href="http://music.163.com/song/443875380/?userid=564654" title="@ç½‘æ˜“äº‘éŸ³ä¹">ã€Šç”Ÿãã¦ã„ãŸã‚“ã ã‚ˆãª(å¥¹æ›¾æ´»è¿‡å•Š)ã€‹&lt;/a>&lt;/p>
&lt;p>æ­Œè¯å¾ˆæ£’? çœ‹åˆ°å¹´åº¦éŸ³ä¹å››ä¸ªå­—, è„‘å­é‡Œç¬¬ä¸€é¦–å‡ºç°çš„æ­Œ.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¹´åº¦è§†é¢‘: äº•è¶Šçš„ vlogâ€”â€”&lt;a href="https://www.bilibili.com/video/av17898771/">ã€Šåˆ«å†é—®æˆ‘ä»€ä¹ˆæ˜¯ 2017ã€‹&lt;/a>&lt;/p>
&lt;p>çœ‹äº†å‡ åä¸ª Casey Neistat çš„ vlog ä¹Ÿæ²¡èƒ½è®©è‡ªå·±è¡ŒåŠ¨èµ·æ¥ç”¨è§†é¢‘è®°å½•ç”Ÿæ´». ä½†çœ‹å®Œè¿™ä¸ªè§†é¢‘çš„ç¬¬äºŒå¤©, å°±å¼€å§‹å°è¯•ç€åœ¨å¤§è¡—ä¸Šå¯¹ç€æ‰‹æœºé•œå¤´è¯´è¯å•¦.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å¹´åº¦ç”µå­äº§å“: iPhoneX&lt;/p>
&lt;p>ç”¨æ¥æ‹äº†ä¸å°‘è§†é¢‘, ç…§ç‰‡. äººåƒæ¨¡å¼æ‹å‡ºçš„ç…§ç‰‡, ä¼šè®©æˆ‘è¿™ä¸ªæ‘„å½±é—¨å¤–æ±‰äº§ç”Ÿä¸€ç§ã€Œè‡ªå·±æ‹çš„è¿˜ä¸é”™å˜›ã€çš„é”™è§‰, ä»è€Œè¾¾åˆ°äº†è¦ç»å¸¸æå‡ºæ‰‹æœºè®°å½•ç”Ÿæ´»çš„ç›®æ ‡.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>å¸Œæœ›æ˜å¹´ä¹Ÿèƒ½å¤šåˆ›é€ ä¸€äº›ä¸œè¥¿, èƒ½å¤Ÿåœ¨ 19 å¹´çš„å¹´ç»ˆæ€»ç»“ä¸­, é€‰å‡ºè‡ªå·±æ»¡æ„çš„å¹´åº¦ XXX å§&lt;/p></description></item><item><title>ä¸ºä»€ä¹ˆ Cocoapods 1.5 æ”¯æŒç¼–è¯‘é™æ€åº“ä¹‹åå¤§å®¶è¿™ä¹ˆé«˜å…´?</title><link>https://joeytat.github.io/posts/cocoapods-1.5-static-library/</link><pubDate>Thu, 27 Dec 2018 00:00:00 +0000</pubDate><guid>https://joeytat.github.io/posts/cocoapods-1.5-static-library/</guid><description>
&lt;p>æ˜¨å¤©åœ¨ Twitter ä¸Šçœ‹åˆ° TualatriX è¯´&lt;a href="https://twitter.com/tualatrix/status/1077166131956264960">æŠŠç§æœ‰åº“éƒ½é€šè¿‡ Cocoapods ç¼–è¯‘æˆé™æ€åº“ä¹‹åå¾ˆçˆ½&lt;/a>, å°±æœ‰ç‚¹å¥½å¥‡åˆ°åº•æ˜¯çˆ½åœ¨å“ªé‡Œ.&lt;/p>
&lt;p>äºæ˜¯å»æœäº†ä¸€ä¸‹, åŸæ¥æ˜¯å‰æ®µæ—¶é—´(å¤§åŠå¹´å‰å§&amp;hellip;), Cocoapods å‘å¸ƒäº† 1.5 çš„ &lt;a href="http://blog.cocoapods.org/CocoaPods-1.5.0/">release note&lt;/a>, å®£å¸ƒæ”¯æŒ Swift é™æ€åº“ç¼–è¯‘. å¹¶ä¸”æ–‡ä¸­æåˆ°äº†å¯¹äºæ‹…å¿ƒåŠ¨æ€äºŒè¿›åˆ¶æ–‡ä»¶å½±å“åº”ç”¨å¯åŠ¨é€Ÿåº¦çš„äººæ¥è¯´, è¿™æ˜¯ä¸ªäº†ä¸èµ·çš„æ›´æ–°.
jh
é‚£åˆæ˜¯ä¸ºä»€ä¹ˆ App ä½¿ç”¨é™æ€åº“ä¼šæ¯”åŠ¨æ€åº“æœ‰æ›´å¿«çš„å¯åŠ¨é€Ÿåº¦å‘¢? åˆè·‘å»æœäº†ä¸€ä¸‹å®˜æ–¹æ–‡æ¡£. æ‰“å¼€ &lt;a href="https://developer.apple.com/library/archive/documentation/DeveloperTools/Conceptual/DynamicLibraries/100-Articles/OverviewOfDynamicLibraries.html">Dynamic Library Programming Topics&lt;/a> å¼€å¤´å°±çœ‹åˆ°:&lt;/p>
&lt;blockquote>
&lt;p>This article introduces dynamic libraries and shows how using dynamic libraries instead of static libraries reduces both the file size and initial memory footprint of the apps that use them.&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>è¿™ç¯‡æ–‡ç« ä¸»è¦ä»‹ç»äº†åŠ¨æ€åº“, å¹¶ä¸”å±•ç¤ºäº†é€šè¿‡&lt;strong>ä½¿ç”¨åŠ¨æ€åº“&lt;/strong>è€Œä¸æ˜¯é™æ€åº“, æ˜¯å¦‚ä½•&lt;strong>ç¼©å‡&lt;/strong>äº†åº”ç”¨çš„å¤§å°å’Œåˆå§‹å†…å­˜ç©ºé—´çš„.&lt;/p>
&lt;/blockquote>
&lt;p>&lt;img src="http://ww1.rs.fanjian.net/c/ab/c8/25/53abf0c06ec808c1fe250d3565ff0d32.jpg" alt="é»‘äººé—®å·">&lt;/p>
&lt;p>â”»â”â”» (ãƒ½(`Ğ” Ì)ãƒ( â”»â”â”» è¿™å’Œè¯´å¥½çš„ä¸ä¸€æ ·å•Š?&lt;/p>
&lt;p>å¸¦ç€ç–‘é—®æˆ‘åˆè·‘å»çœ‹äº†ä¸€ä¸‹è‹¹æœçš„ &lt;a href="https://developer.apple.com/videos/play/wwdc2016/406">WWDC 2016 - Optimizing App Startup Time&lt;/a> çš„è§†é¢‘, è¿™æ¬¡é—®é¢˜ç»ˆäºå¾—åˆ°äº†è§£å†³.&lt;/p>
&lt;p>è¿™é‡Œçš„åº“æ˜¯ä»€ä¹ˆ? æ˜¯å¯æ‰§è¡Œæ–‡ä»¶çš„é›†åˆ. é™æ€åº“ä¸åŠ¨æ€åº“è°ƒç”¨æ—¶æœºçš„åŒºåˆ«åœ¨äº, é™æ€åº“åœ¨åº”ç”¨å¯åŠ¨çš„æ—¶å€™, ä¼šå’Œç¨‹åºçš„å¯æ‰§è¡Œä»£ç ä¸€èµ·, è¢«åŠ è½½åˆ°åº”ç”¨çš„å†…å­˜ç©ºé—´ä¸­. è¿™å°±ä¼šå¯¼è‡´åº”ç”¨å¯åŠ¨æ…¢, å¹¶ä¸”å†…å­˜å ç”¨å¤§. è€ŒåŠ¨æ€åº“åˆ™æ˜¯åœ¨ä»£ç çœŸæ­£è¢«éœ€è¦è°ƒç”¨çš„æ—¶å€™, æ‰åŠ è½½åˆ°å†…å­˜ä¸­.&lt;/p>
&lt;p>æ‰€ä»¥æ‰ä¼šæœ‰è‹¹æœæ–‡æ¡£ä¸­æåˆ°çš„ã€Œé€šè¿‡&lt;strong>ä½¿ç”¨åŠ¨æ€åº“&lt;/strong>è€Œä¸æ˜¯é™æ€åº“, æ˜¯å¦‚ä½•&lt;strong>ç¼©å‡&lt;/strong>äº†åº”ç”¨çš„å¤§å°å’Œåˆå§‹å†…å­˜ç©ºé—´çš„ã€è¿™å¥è¯.&lt;/p>
&lt;p>å¯è¿™æ˜¯ç«™åœ¨ç³»ç»Ÿè§’åº¦æ¥è¯´çš„. åœ¨ iOS ä¸­, å¹³å‡æ¯ä¸ª App åŒ…å«äº† &lt;a href="https://developer.apple.com/videos/play/wwdc2016-406/?time=1684">1 åˆ° 400&lt;/a> ä¸ªåŠ¨æ€åº“. å…¶ä¸­æœ‰å¾ˆå¤§ä¸€éƒ¨åˆ†æ˜¯ç³»ç»Ÿçº§åŠ¨æ€åº“. è‹¹æœä¸ºå…¶åšäº†è®¸å¤šçš„ä¼˜åŒ–, æ¯”å¦‚æå‰è®¡ç®—, æå‰ç¼“å­˜ç­‰. è¿™å¯¹äºç³»ç»Ÿæä¾›çš„åŠ¨æ€åº“æ¥è¯´, å½“ç„¶æ¯”é™æ€åº“æ›´å¿«.&lt;/p>
&lt;p>ä½† App ä¸­è¿˜åŒ…å«äº†å¾ˆå¤šè‡ªæœ‰çš„åŠ¨æ€åº“, è¿™éƒ¨åˆ†åŠ¨æ€åº“è‹¹æœæ²¡æœ‰åŠæ³•ä¸ºæœŸæä¾›ä¼˜åŒ–. è€Œå¯¹äº dylib çš„åŠ è½½åˆæ˜¯éå¸¸è€—è´¹èµ„æºçš„. æ‰€ä»¥è‹¹æœå¯¹å…¶çš„å»ºè®®æ˜¯æœ€å¥½åœ¨ &lt;a href="https://developer.apple.com/videos/play/wwdc2016-406/?time=1794">6&lt;/a> ä¸ªå·¦å³.&lt;/p>
&lt;p>ç„¶åæˆ‘ä¹ŸæŠŠé¡¹ç›®ä¸­çš„ Swift pods ç¼–è¯‘ä¸ºé™æ€åº“äº†, æ•ˆæœå¦‚ä¸‹.&lt;/p>
&lt;pre tabindex="0">&lt;code>// ä¼˜åŒ–å‰
[DYMTLInitPlatform] platform initialization successful
Total pre-main time: 1.5 seconds (100.0%)
dylib loading time: 968.07 milliseconds (61.1%)
......
......
&lt;/code>&lt;/pre>&lt;pre tabindex="0">&lt;code>// Pods ä½¿ç”¨é™æ€åº“å
[DYMTLInitPlatform] platform initialization successful
Total pre-main time: 1.1 seconds (100.0%)
dylib loading time: 520.52 milliseconds (47.2%)
......
......
&lt;/code>&lt;/pre>&lt;p>æœ€åå†æ€»ç»“ä¸€ä¸‹.&lt;/p>
&lt;ul>
&lt;li>å¯¹äºç³»ç»Ÿæä¾›äº†ä¼˜åŒ–çš„åŠ¨æ€åº“æ¥è¯´, ä¸€å®šæ˜¯æ¯”é™æ€åº“å¯åŠ¨åŠ è½½å¿«ä¸”å ç”¨å†…å­˜æ›´å°çš„. 14er&lt;/li>
&lt;li>è€Œå¯¹äº App è‡ªæœ‰çš„åŠ¨æ€åº“æ¥è¯´, ç³»ç»Ÿåœ¨åŠ è½½åŠ¨æ€åº“æ‰€æ¶ˆè€—çš„èµ„æºè¦æ¯”åŠ è½½é™æ€åº“æ¥å¾—å¤š, æ‰€ä»¥æœ€å¥½é™åˆ¶åœ¨ 6 ä¸ªå·¦å³.&lt;/li>
&lt;/ul>
&lt;h2 id="å‚è€ƒé“¾æ¥">
å‚è€ƒé“¾æ¥
&lt;a href="#%e5%8f%82%e8%80%83%e9%93%be%e6%8e%a5" class="h-anchor" aria-hidden="true">#&lt;/a>
&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://www.jianshu.com/p/3d0ae289dee0">Cocoapods çš„é™æ€åº“å’ŒåŠ¨æ€åº“&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developer.apple.com/videos/play/wwdc2016/406/?time=203">WWDC 2016 - Optimizing App Startup Time&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developer.apple.com/library/archive/documentation/DeveloperTools/Conceptual/DynamicLibraries/100-Articles/OverviewOfDynamicLibraries.html">Dynamic Library Programming Topics&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://tech.meituan.com/waimai_ios_optimizing_startup.html">ç¾å›¢å¤–å– iOS Appå†·å¯åŠ¨æ²»ç†&lt;/a>&lt;/li>
&lt;/ul></description></item></channel></rss>