<!doctype html><html lang=en>
<head>
<title>
SwiftUI çŠ¶æ€ç®¡ç† â€”â€” Composible Binding ::
Dev Log
</title>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="SwiftUI ä¸­çš„çŠ¶æ€ç®¡ç† â€”â€” Composible Binding åœ¨ SwiftUI ä¸­ï¼Œéœ€è¦é€šè¿‡æ•°æ®æ¥é©±åŠ¨ UI çš„å˜åŒ–ã€‚æ•°æ®ç»“æ„æŠ½è±¡æè¿°çš„è´¨é‡ä¹Ÿå½±å“ç€æˆ‘ä»¬å¯¹ SwiftUI ç•Œé¢çš„ç»´æŠ¤ã€‚
é€šå¸¸æ•°æ®ä¸­å¯èƒ½å­˜åœ¨å¾ˆå¤šçŠ¶æ€ï¼Œå¦‚æœä½¿ç”¨å¾ˆå¤šçš„ boolean å€¼æ¥æè¿°è¿™äº›çŠ¶æ€ï¼Œé‚£ä¹ˆ App çš„å¯ç»´æŠ¤æ€§å¯èƒ½ä¼šå¤§å¤§é™ä½ã€‚
ç®¡ç†ç‹¬ç«‹çŠ¶æ€çš„é—®é¢˜ å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª Appï¼Œç”¨æˆ·å¯ä»¥åœ¨ç™»å½•ä¸éç™»å½•çŠ¶æ€ä¸‹è¿›è¡Œæ“ä½œã€‚æ‰€ä»¥æˆ‘ä»¬çš„ç•Œé¢éœ€è¦å…¼å®¹è¿™ä¸¤ç§çŠ¶æ€ï¼Œå…¶æè¿°å¯èƒ½æ˜¯è¿™æ ·çš„ï¼š
class AppState: ObservableObject { @Published var user: User? = nil @Published var error: Error? = nil var authenticated: Bool { user != nil } var hasError: Bool { error != nil } } åŸºäºè¿™æ ·çš„çŠ¶æ€æè¿°ï¼Œå¦‚æœæˆ‘ä»¬æƒ³åˆ›å»ºä¸€ä¸ªä»…å±•ç¤ºç”¨æˆ·åçš„ç»„ä»¶å¤§æ¦‚ä¼šæ˜¯è¿™æ ·ï¼š
var body: some View { Group { if state.hasError { Text(&amp;#34;Oops, sth went wrong: \(state.error!.localizedDescription)&amp;#34;) } if state.">
<meta name=keywords content>
<meta name=robots content="noodp">
<link rel=canonical href=https://joeytat.github.io/posts/20220103_notes_composible_binding/>
<link rel=stylesheet href=https://joeytat.github.io/assets/style.css>
<link rel=stylesheet href=https://joeytat.github.io/style.css>
<link rel=apple-touch-icon-precomposed sizes=144x144 href=https://joeytat.github.io/img/apple-touch-icon-144-precomposed.png>
<link rel="shortcut icon" href=https://joeytat.github.io/img/favicon.png>
<link href=https://joeytat.github.io/assets/fonts/Inter-Italic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://joeytat.github.io/assets/fonts/Inter-Regular.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://joeytat.github.io/assets/fonts/Inter-Medium.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://joeytat.github.io/assets/fonts/Inter-MediumItalic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://joeytat.github.io/assets/fonts/Inter-Bold.woff2 rel=preload type=font/woff2 as=font crossorigin>
<link href=https://joeytat.github.io/assets/fonts/Inter-BoldItalic.woff2 rel=preload type=font/woff2 as=font crossorigin>
<meta name=twitter:card content="summary">
<meta name=twitter:title content="SwiftUI çŠ¶æ€ç®¡ç† â€”â€” Composible Binding">
<meta name=twitter:description content="å¦‚ä½•åˆ©ç”¨ Enum ä»¥åŠè‡ªå®šä¹‰ KeyPath æ¥æ›´å¥½åœ°ç®¡ç† SwiftUI çš„çŠ¶æ€">
<meta property="og:title" content="SwiftUI çŠ¶æ€ç®¡ç† â€”â€” Composible Binding">
<meta property="og:description" content="å¦‚ä½•åˆ©ç”¨ Enum ä»¥åŠè‡ªå®šä¹‰ KeyPath æ¥æ›´å¥½åœ°ç®¡ç† SwiftUI çš„çŠ¶æ€">
<meta property="og:type" content="article">
<meta property="og:url" content="https://joeytat.github.io/posts/20220103_notes_composible_binding/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2022-01-03T00:00:00+00:00">
<meta property="article:modified_time" content="2022-01-03T00:00:00+00:00">
</head>
<body>
<div class=container>
<header class=header>
<span class=header__inner>
<a href=https://joeytat.github.io/ class=logo style=text-decoration:none>
<span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg>
</span>
<span class=logo__text>Joeytat's Devlog</span>
<span class=logo__cursor></span>
</a>
<span class=header__right>
<span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg>
</span>
</span>
</span>
</header>
<div class=content>
<div class=post>
<h1 class=post-title>SwiftUI çŠ¶æ€ç®¡ç† â€”â€” Composible Binding</h1>
<div class=post-meta>
<span class=post-date>
2022-01-03
</span>
<span class=post-author>â€” Written by Joeytat</span>
</div>
<span class=post-tags>
<a href=https://joeytat.github.io/tags/swiftui/>#SwiftUI</a>&nbsp;
</span>
<div class=post-content>
<h1 id=swiftui-ä¸­çš„çŠ¶æ€ç®¡ç†--composible-binding>SwiftUI ä¸­çš„çŠ¶æ€ç®¡ç† â€”â€” Composible Binding</h1>
<p>åœ¨ SwiftUI ä¸­ï¼Œéœ€è¦é€šè¿‡æ•°æ®æ¥é©±åŠ¨ UI çš„å˜åŒ–ã€‚æ•°æ®ç»“æ„æŠ½è±¡æè¿°çš„è´¨é‡ä¹Ÿå½±å“ç€æˆ‘ä»¬å¯¹ SwiftUI ç•Œé¢çš„ç»´æŠ¤ã€‚</p>
<p>é€šå¸¸æ•°æ®ä¸­å¯èƒ½å­˜åœ¨å¾ˆå¤šçŠ¶æ€ï¼Œå¦‚æœä½¿ç”¨å¾ˆå¤šçš„ boolean å€¼æ¥æè¿°è¿™äº›çŠ¶æ€ï¼Œé‚£ä¹ˆ App çš„å¯ç»´æŠ¤æ€§å¯èƒ½ä¼šå¤§å¤§é™ä½ã€‚</p>
<h2 id=ç®¡ç†ç‹¬ç«‹çŠ¶æ€çš„é—®é¢˜>ç®¡ç†ç‹¬ç«‹çŠ¶æ€çš„é—®é¢˜</h2>
<p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª Appï¼Œç”¨æˆ·å¯ä»¥åœ¨ç™»å½•ä¸éç™»å½•çŠ¶æ€ä¸‹è¿›è¡Œæ“ä½œã€‚æ‰€ä»¥æˆ‘ä»¬çš„ç•Œé¢éœ€è¦å…¼å®¹è¿™ä¸¤ç§çŠ¶æ€ï¼Œå…¶æè¿°å¯èƒ½æ˜¯è¿™æ ·çš„ï¼š</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AppState</span>: ObservableObject {
  @Published <span style=color:#66d9ef>var</span> user: User? = <span style=color:#66d9ef>nil</span>
  @Published <span style=color:#66d9ef>var</span> error: Error? = <span style=color:#66d9ef>nil</span>
  
  <span style=color:#66d9ef>var</span> authenticated: Bool { user <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> }
  <span style=color:#66d9ef>var</span> hasError: Bool { error <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> }
}
</code></pre></div><p>åŸºäºè¿™æ ·çš„çŠ¶æ€æè¿°ï¼Œå¦‚æœæˆ‘ä»¬æƒ³åˆ›å»ºä¸€ä¸ªä»…å±•ç¤ºç”¨æˆ·åçš„ç»„ä»¶å¤§æ¦‚ä¼šæ˜¯è¿™æ ·ï¼š</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift>  <span style=color:#66d9ef>var</span> body: some View {
    Group {
      <span style=color:#66d9ef>if</span> state.hasError {
        Text(<span style=color:#e6db74>&#34;Oops, sth went wrong: </span><span style=color:#e6db74>\(</span>state.error!.localizedDescription<span style=color:#e6db74>)</span><span style=color:#e6db74>&#34;</span>)
      }
      <span style=color:#66d9ef>if</span> state.authenticated {
        Text(<span style=color:#e6db74>&#34;Hello </span><span style=color:#e6db74>\(</span>state.user?.name ?? <span style=color:#e6db74>&#34;Unknown&#34;</span><span style=color:#e6db74>)</span><span style=color:#e6db74>!&#34;</span>)
      } <span style=color:#66d9ef>else</span> {
        Text(<span style=color:#e6db74>&#34;Hello, stranger&#34;</span>)
      }
    }
  }
</code></pre></div><p>ç²—çœ‹æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œå®é™…ä¸Šåœ¨ç»´æŠ¤è¿™æ ·çš„æ•°æ®ç»“æ„æ—¶å°±éœ€è¦æ ¼å¤–å°å¿ƒäº†ã€‚æ¯”å¦‚ç¬¬ä¸€æ¬¡æˆ‘ä»¬ç™»å½•å¤±è´¥ï¼Œä¸ºäº†å±•ç¤ºé”™è¯¯ä¿¡æ¯ç»™ <code>error</code> è®¾ç½®äº†å€¼ä¹‹åã€‚å¿…é¡»åœ¨ç™»å½•æˆåŠŸä¹‹åè¦åŠæ—¶åœ°å»æ¸…ç©º errorï¼Œå¦åˆ™å³ä½¿ <code>state.authenticated</code> ç­‰äº <code>true</code>ï¼Œç”¨æˆ·ä¾ç„¶æ— æ³•çœ‹åˆ°æ­£ç¡®çš„ä¿¡æ¯ã€‚</p>
<p>è¿™è¿˜ä»…ä»…æ˜¯æœ‰ä¸¤ä¸ªçŠ¶æ€çš„æƒ…å†µä¸‹ï¼Œåƒè¿™æ ·ç‹¬ç«‹çŠ¶æ€å±æ€§ä¼šå¸¦æ¥å¾ˆå¤§çš„ç»´æŠ¤æˆæœ¬ï¼Œå¼€å‘è€…éœ€è¦ç‰¢è®°å„ä¸ªå±æ€§ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œç”šè‡³ç¼–å†™ç•Œé¢çš„æ—¶å€™ï¼Œè¿˜éœ€è¦æ³¨æ„ä»£ç æ‰§è¡Œé¡ºåºã€‚</p>
<h2 id=å¼•å…¥çŠ¶æ€æœº>å¼•å…¥çŠ¶æ€æœº</h2>
<p>æŠŠçŠ¶æ€æŠ½è±¡æˆå¸¦æœ‰ associated values çš„ enum æ˜¯ä¸ªæ›´å¥½çš„é€‰æ‹©ï¼Œæ¯”å¦‚:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>AppState</span>: ObservableObject  {
  <span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>AccountState</span> {
    <span style=color:#66d9ef>case</span> authenticated(User)
    <span style=color:#66d9ef>case</span> unauthenticated
    <span style=color:#66d9ef>case</span> error(Error)
  }
  @Published <span style=color:#66d9ef>var</span> accountState: AccountState = .unauthenticated
}

<span style=color:#75715e>// ç•Œé¢ä¸­çš„ä½¿ç”¨</span>
<span style=color:#66d9ef>var</span> body: some View {
  VStack {
    <span style=color:#66d9ef>switch</span> state.accountState {
    <span style=color:#66d9ef>case</span> .authenticated(<span style=color:#66d9ef>let</span> user):
      Text(<span style=color:#e6db74>&#34;Hello </span><span style=color:#e6db74>\(</span>user.name<span style=color:#e6db74>)</span><span style=color:#e6db74>!&#34;</span>)
    <span style=color:#66d9ef>case</span> .unauthenticated:
      Text(<span style=color:#e6db74>&#34;unregister&#34;</span>)
    <span style=color:#66d9ef>case</span> .error(<span style=color:#66d9ef>let</span> error):
      Text(<span style=color:#e6db74>&#34;Oops, sth went wrong: </span><span style=color:#e6db74>\(</span>error.localizedDescription<span style=color:#e6db74>)</span><span style=color:#e6db74>&#34;</span>)
    }
}
</code></pre></div><p>è¿™æ ·è¢«çŠ¶æ€æœºé©±åŠ¨çš„ç•Œé¢çœ‹èµ·æ¥è¦ç›´è§‚å¤šäº†ã€‚å¹¶ä¸”åœ¨æ¯ä¸ªçŠ¶æ€ä¸­å¯¹æ•°æ®çš„æ“ä½œï¼Œä¹Ÿç”± enum èµ‹äºˆäº†éš”ç¦»èƒ½åŠ›ã€‚</p>
<h2 id=åŒå‘ç»‘å®šæ€ä¹ˆåŠ>åŒå‘ç»‘å®šæ€ä¹ˆåŠï¼Ÿ</h2>
<p>ä½†è¿™æ ·åšåˆæ¥å¸¦ä¸ªæ–°çš„é—®é¢˜ï¼Œç°åœ¨æ²¡åŠæ³•ç›´æ¥é€šè¿‡ <code>$</code> æ¥è·å– Binding wrapper æ¥ä¿®æ”¹çŠ¶æ€ï¼š</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#66d9ef>switch</span> state.accountState {
    <span style=color:#66d9ef>case</span> .authenticated(<span style=color:#66d9ef>let</span> user):
      Text(<span style=color:#e6db74>&#34;Hello </span><span style=color:#e6db74>\(</span>user.name<span style=color:#e6db74>)</span><span style=color:#e6db74>!&#34;</span>)
	  TextField(<span style=color:#e6db74>&#34;Change username&#34;</span>, text: &lt;Binding&lt;String&gt;<span style=color:#f92672>&gt;</span>) 
      <span style=color:#75715e>// ä¸æ”¯æŒå¡«å…¥ self.$state.accountState.name ğŸ‘†</span>
	...
</code></pre></div><blockquote>
<p>Xcode ä¼šæç¤º: dynamic member &lsquo;name&rsquo; using key path from root type &lsquo;AppState.AccountState&rsquo;</p>
</blockquote>
<p>ä¸ºä»€ä¹ˆå½“æ“ä½œå¯¹è±¡æ˜¯ class æ—¶ï¼Œæ˜¯å¯ä»¥åšåˆ°é€šè¿‡
<code>self.$state.user.name</code> æ¥è·å–åˆ° name å±æ€§çš„ Binding å°è£…çš„ï¼Ÿ</p>
<h2 id=å®ç°åŠ¨æ€æˆå‘˜æŸ¥æ‰¾dynamic-member-lookup>å®ç°åŠ¨æ€æˆå‘˜æŸ¥æ‰¾(dynamic member lookup)</h2>
<p>å› ä¸º Enum è¿˜ä¸æ”¯æŒåŠ¨æ€æˆå‘˜æŸ¥æ‰¾ç‰¹æ€§ã€‚ä»€ä¹ˆæ˜¯åŠ¨æ€æˆå‘˜æŸ¥æ‰¾ï¼Ÿç®€è€Œè¨€ä¹‹å°±æ˜¯é€šè¿‡ <code>\</code> æ¥è·å–åˆ°æˆå‘˜å±æ€§çš„ <code>KeyPath</code> å°è£…ï¼ˆ<a href=https://www.swiftbysundell.com/articles/the-power-of-key-paths-in-swift/>ä»€ä¹ˆåˆæ˜¯ KeyPath</a>ï¼Ÿï¼‰ï¼Œç„¶åå°†å…¶è½¬åŒ–ä¸ºå¯¹åº”çš„ Binding å°è£…ã€‚</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#66d9ef>extension</span> <span style=color:#a6e22e>Binding</span> {
  <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>transform</span>&lt;LocalValue&gt;(
    <span style=color:#66d9ef>_</span> keyPath: WritableKeyPath&lt;Value, LocalValue&gt;
  ) -&gt; Binding&lt;LocalValue&gt; {
    Binding&lt;LocalValue&gt;(
      <span style=color:#66d9ef>get</span>: { 
        <span style=color:#66d9ef>self</span>.wrappedValue[keyPath: keyPath]
      },
      <span style=color:#66d9ef>set</span>: { localValue <span style=color:#66d9ef>in</span>
        <span style=color:#66d9ef>self</span>.wrappedValue[keyPath: keyPath] = localValue 
      }
    )
  }
}

<span style=color:#66d9ef>self</span>.<span style=color:#960050;background-color:#1e0010>$</span>state.accountState.username
<span style=color:#75715e>// ç­‰ä»·äº </span>
<span style=color:#66d9ef>self</span>.<span style=color:#960050;background-color:#1e0010>$</span>state.transform(<span style=color:#960050;background-color:#1e0010>\</span>accountState).transform(<span style=color:#960050;background-color:#1e0010>\</span>username)
</code></pre></div><p>æ‰€ä»¥æ¥ä¸‹æ¥åªéœ€è¦ä¸º enum æ·»åŠ åŠ¨æ€æˆå‘˜æŸ¥æ‰¾çš„æ”¯æŒå°±å¯ä»¥äº†</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#66d9ef>extension</span> <span style=color:#a6e22e>Binding</span> {
  <span style=color:#66d9ef>func</span> <span style=color:#a6e22e>unwrap</span>&lt;Wrapped&gt;() -&gt; Binding&lt;Wrapped&gt;? <span style=color:#66d9ef>where</span> Value == Wrapped? {
    <span style=color:#66d9ef>guard</span> <span style=color:#66d9ef>let</span> value = <span style=color:#66d9ef>self</span>.wrappedValue <span style=color:#66d9ef>else</span> { <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span> }
    <span style=color:#66d9ef>return</span> Binding&lt;Wrapped&gt;(
      <span style=color:#66d9ef>get</span>: { value },
      <span style=color:#66d9ef>set</span>: { <span style=color:#66d9ef>self</span>.wrappedValue = $0 }
    )
  }
}
</code></pre></div><p>ç„¶åå†åˆ° enum é‡Œæ·»åŠ ä¸€ä¸ªè®¡ç®—å±æ€§æ–¹ä¾¿æˆ‘ä»¬è·å–</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>AccountState</span> {
  <span style=color:#66d9ef>case</span> loggedIn(User)
  <span style=color:#66d9ef>case</span> unregister
  <span style=color:#75715e>//</span>
  <span style=color:#66d9ef>var</span> username: String? {
    <span style=color:#66d9ef>get</span> {
      <span style=color:#66d9ef>guard</span> <span style=color:#66d9ef>case</span> .loggedIn(<span style=color:#66d9ef>let</span> user) = <span style=color:#66d9ef>self</span> <span style=color:#66d9ef>else</span> {
        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>
      }
      <span style=color:#66d9ef>return</span> user.username
    }
    <span style=color:#66d9ef>set</span> {
      <span style=color:#66d9ef>guard</span> <span style=color:#66d9ef>case</span> .loggedIn(<span style=color:#66d9ef>let</span> user) = <span style=color:#66d9ef>self</span>,
            <span style=color:#66d9ef>let</span> newValue = newValue <span style=color:#66d9ef>else</span> { <span style=color:#66d9ef>return</span> }
      user.username = newValue
      <span style=color:#66d9ef>self</span> = .loggedIn(user)
    }
  }
}
</code></pre></div><p>ç°åœ¨å°±å¯ä»¥åœ¨ SwiftUI ä¸­å¯¹ enum ä½¿ç”¨ç»‘å®šäº†</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#66d9ef>if</span> <span style=color:#66d9ef>let</span> username = <span style=color:#66d9ef>self</span>.<span style=color:#960050;background-color:#1e0010>$</span>state.accountState.username.unwrap() {
  TextField(<span style=color:#e6db74>&#34;Change username&#34;</span>, text: username)
}
</code></pre></div><p>çœ‹èµ·æ¥è¿˜æ˜¯æœ‰äº›éº»çƒ¦ï¼Œå¯¹äºæ¯ä¸ªè¦ä½¿ç”¨ Binding çš„å±æ€§éƒ½éœ€è¦å»å†™ä¸€ä¸ªè®¡ç®—å±æ€§æ¥åŒ…è£…ä¸€å±‚ã€‚è¿™æ ·æ˜¾ç„¶è¿™å¹¶ä¸å¦‚ <code>KeyPath</code> é‚£æ ·ï¼Œç›´æ¥é€šè¿‡ <code>self.$state.accountState[\.authenticated]</code> æ¥è·å–åˆ° enum ä¸­ associated value çš„ Binding åŒ…è£…æ¥å¾—æ–¹ä¾¿ã€‚</p>
<p>è™½ç„¶ Swift ç›®å‰ä¸æ”¯æŒï¼Œä½†æˆ‘ä»¬è¿˜æ˜¯å¯ä»¥é€šè¿‡å¼•å…¥ <a href=https://github.com/pointfreeco/swift-case-paths>CasePaths</a> è¿™ä¸ªç¬¬ä¸‰æ–¹ä¾èµ–æ¥å®ç°ã€‚</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>CasePaths</span>

<span style=color:#66d9ef>enum</span> <span style=color:#a6e22e>AccountState</span> {
  <span style=color:#66d9ef>case</span> authenticated(User)
  <span style=color:#66d9ef>case</span> unauthenticated
  <span style=color:#66d9ef>case</span> error(Error)
<span style=color:#75715e>// è®¡ç®—å±æ€§å¯ä»¥åˆ é™¤æ‰äº†</span>
<span style=color:#75715e>//    var username: String? {</span>
<span style=color:#75715e>//      get {</span>
<span style=color:#75715e>//        guard case .authenticated(let user) = self else {</span>
<span style=color:#75715e>//          return nil</span>
<span style=color:#75715e>//        }</span>
<span style=color:#75715e>//        return user.name</span>
<span style=color:#75715e>//      }</span>
<span style=color:#75715e>//      set {</span>
<span style=color:#75715e>//        guard case .authenticated(let user) = self,</span>
<span style=color:#75715e>//              let newValue = newValue else { return }</span>
<span style=color:#75715e>//        user.name = newValue</span>
<span style=color:#75715e>//        self = .authenticated(user)</span>
<span style=color:#75715e>//      }</span>
<span style=color:#75715e>//    }</span>
}

<span style=color:#75715e>// ç•Œé¢ä¸­ç›´æ¥ä½¿ç”¨ CasePath</span>
<span style=color:#66d9ef>if</span> <span style=color:#66d9ef>let</span> user = <span style=color:#66d9ef>self</span>.<span style=color:#960050;background-color:#1e0010>$</span>state.accountState.matching(<span style=color:#f92672>/</span>.authenticated) {
  TextField(<span style=color:#e6db74>&#34;Change username&#34;</span>, text: user.name)
}

</code></pre></div><p>ç”±æ­¤ä¸º Enum ä¹Ÿå¢åŠ äº†ä¸ Structã€Class ç­‰æ•ˆçš„ KeyPath æ”¯æŒï¼Œä»è€Œä½¿å¾—æ–‡ç« å¼€å¤´ç”¨ Enum ä½œä¸º SwiftUI çš„çŠ¶æ€æœºç®¡ç†å·¥å…·æ›´ä¾¿æ·äº†ä¸€äº›ã€‚</p>
<h2 id=å‚è€ƒèµ„æ–™>å‚è€ƒèµ„æ–™</h2>
<ul>
<li><a href=https://kentcdodds.com/blog/stop-using-isloading-booleans>Stop using isLoading booleans</a></li>
<li><a href=https://www.swiftbysundell.com/articles/the-power-of-key-paths-in-swift/>The power of key paths in Swift</a></li>
<li><a href=https://www.pointfree.co/collections/swiftui/composable-bindings/ep107-composable-swiftui-bindings-the-problem>Composable SwiftUI Bindings: TheÂ Problem</a></li>
</ul>
</div>
<div class=pagination>
<div class=pagination__title>
<span class=pagination__title-h>Read other posts</span>
<hr>
</div>
<div class=pagination__buttons>
<span class="button next">
<a href=https://joeytat.github.io/posts/190819_asynchronous-javascript/>
<span class=button__text>TIL - JavaScript æ—¢ç„¶æ˜¯å•çº¿ç¨‹è¯­è¨€ï¼Œä¸ºä»€ä¹ˆ setTimeout ä¸ä¼šé˜»å¡çº¿ç¨‹ï¼Ÿ</span>
<span class=button__icon>â†’</span>
</a>
</span>
</div>
</div>
</div>
</div>
<footer class=footer>
<div class=footer__inner>
<a href=https://joeytat.github.io/ class=logo style=text-decoration:none>
<span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg>
</span>
<span class=logo__text>Joeytat's Devlog</span>
<span class=logo__cursor></span>
</a>
<div class=copyright>
<span>Â© 2022 Powered by
<a href=https://gohugo.io target=_blank rel=noopener>Hugo</a></span>
<span>Theme created by
<a href=https://twitter.com/panr target=_blank rel=noopener>panr</a></span>
</div>
</div>
</footer>
<script src=https://joeytat.github.io/assets/main.js></script>
<script src=https://joeytat.github.io/assets/prism.js></script>
</div>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-131363452-1','auto'),ga('send','pageview'))</script>
</body>
</html>