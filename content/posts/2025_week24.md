+++
title = "2025 week 24: Kimi K2 来拯救!”
date = "2025-07-21"
tags = ["周记"]
+++

在 twitter 上发现 Wildcard 平台跑路了，开始找办法充值 Claude Code，调查之后发现靠谱不怕跑路的支付方案有两个：

1. App Store 美区账号订阅
2. 虚拟币平台发行的信用卡

有了保底方案就不慌了。恰巧 Kimi K2 发布，就研究了一下是否能搭配使用，一方面节约点钱，另一方面为可能的被平台封号做二手准备。

如果是 Claude Code + Kimi K2 设置一下环境变量即可：

```zsh
kimi() {
export ANTHROPIC_AUTH_TOKEN=${KEY}
export ANTHROPIC_BASE_URL=https://api.moonshot.cn/anthropic/
export ANTHROPIC_SMALL_FAST_MODEL="kimi-k2-turbo-preview"
export ANTHROPIC_MODEL="kimi-k2-turbo-preview"
claude --dangerously-skip-permissions $1
}
```

如果是使用 OpenCode + Kimi K2 则稍微多一点：

1. 在 `~/.local/share/opencode/auth.json` 中放置自己的 moonshot 平台生成的 key（要注意自己 key 是从 https://platform.moonshot.ai 还是 https://platform.moonshot.cn 生成的）

```json
{
   "moonshot": {
   "type": "api",
   "key": ${KEY}
   }
}
```

2. 在 `~/.config/opencode/opencode.json` 中配置一下模型和 URL

```json
{
  "$schema": "https://opencode.ai/config.json",
  "theme": "opencode",
  "provider": {
    "moonshot": {
      "npm": "@ai-sdk/openai-compatible",
      "options": {
        "baseURL": "https://api.moonshot.cn/v1" // 如果是从 https://platform.moonshot.ai 生成的 key 记得改这里的 URL
      },
      "models": {
        "kimi-k2-turbo-preview": {}
      }
    }
  },
  "autoshare": false,
  "autoupdate": true
}
```

配置好了之后就按照平常用 Claude Code Max 5x 的方式使用了一下 Open Code + Kimi K2，大概一上午用掉 30 块钱，代码生成和分析在我的 codebase 上体验上没有那么大的差别，或许因为按量计费，自己提供上下文给 AI 的时候还会二次检查一下，所以输出效果也比较好吧。

这个费用，虽然看起来不便宜，但根据自己这个月使用习惯，预测如果不是灵感大爆发，应该是不会用超到 $100 的。
